/* empty css                  */import{v as di}from"./el-loading-DLKkykXM.js";import{_ as fi}from"./MyTab-CvPPF7IE.js";import{o as pi,a as gi,b as mi}from"./data-DOzr8Xtg.js";import{_ as Qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{al as _i,z as yi,_ as bi,C as Ar,c as Yt,R as xi,r as mt,h as V,U as Ci,b as $,g as wi,w as te,B as ur,i as Wt,d as j,t as H,q as Ut,k as Nt,Q as Si,a0 as Ii,am as Ei,J as Pe,o as kr,O as Dr,a3 as Ti,e as W,F as Me,l as Ae,f as Qt,s as Pi,u as Mi,j as Ai,an as ki,X as Di,a1 as Ri}from"./index-sRNqgdFD.js";import{m as Vt,n as hr,d as Fi}from"./index-CB-azdtK.js";import{a as cr,f as rt}from"./utils-BFyP1kS5.js";import{d as Xe}from"./dropdown-BVS1iGXQ.js";const Bi=yi({trigger:hr.trigger,placement:Xe.placement,disabled:hr.disabled,visible:Vt.visible,transition:Vt.transition,popperOptions:Xe.popperOptions,tabindex:Xe.tabindex,content:Vt.content,popperStyle:Vt.popperStyle,popperClass:Vt.popperClass,enterable:{...Vt.enterable,default:!0},effect:{...Vt.effect,default:"light"},teleported:Vt.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),Oi={"update:visible":i=>_i(i),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},Li="onUpdate:visible",Vi=Ar({name:"ElPopover"}),Ni=Ar({...Vi,props:Bi,emits:Oi,setup(i,{expose:e,emit:t}){const r=i,a=Yt(()=>r[Li]),n=xi("popover"),o=mt(),s=Yt(()=>{var p;return(p=V(o))==null?void 0:p.popperRef}),l=Yt(()=>[{width:Ci(r.width)},r.popperStyle]),u=Yt(()=>[n.b(),r.popperClass,{[n.m("plain")]:!!r.content}]),h=Yt(()=>r.transition===`${n.namespace.value}-fade-in-linear`),c=()=>{var p;(p=o.value)==null||p.hide()},v=()=>{t("before-enter")},d=()=>{t("before-leave")},f=()=>{t("after-enter")},g=()=>{t("update:visible",!1),t("after-leave")};return e({popperRef:s,hide:c}),(p,m)=>($(),wi(V(Fi),Si({ref_key:"tooltipRef",ref:o},p.$attrs,{trigger:p.trigger,placement:p.placement,disabled:p.disabled,visible:p.visible,transition:p.transition,"popper-options":p.popperOptions,tabindex:p.tabindex,content:p.content,offset:p.offset,"show-after":p.showAfter,"hide-after":p.hideAfter,"auto-close":p.autoClose,"show-arrow":p.showArrow,"aria-label":p.title,effect:p.effect,enterable:p.enterable,"popper-class":V(u),"popper-style":V(l),teleported:p.teleported,persistent:p.persistent,"gpu-acceleration":V(h),"onUpdate:visible":V(a),onBeforeShow:v,onBeforeHide:d,onShow:f,onHide:g}),{content:te(()=>[p.title?($(),j("div",{key:0,class:Ut(V(n).e("title")),role:"title"},H(p.title),3)):Wt("v-if",!0),ur(p.$slots,"default",{},()=>[Nt(H(p.content),1)])]),default:te(()=>[p.$slots.reference?ur(p.$slots,"reference",{key:0}):Wt("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Wi=bi(Ni,[["__file","popover.vue"]]);const vr=(i,e)=>{const t=e.arg||e.value,r=t==null?void 0:t.popperRef;r&&(r.triggerRef=i)};var zi={mounted(i,e){vr(i,e)},updated(i,e){vr(i,e)}};const Xi="popover",Hi=Ei(zi,Xi),Yi=Ii(Wi,{directive:Hi});/**
     * @license
     * KLineChart v10.0.0-alpha1
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */var Ze=function(i,e){return Ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])},Ze(i,e)};function L(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ze(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var k=function(){return k=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},k.apply(this,arguments)};function ke(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(i);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(i,r[a])&&(t[r[a]]=i[r[a]]);return t}function Rr(i,e,t,r){function a(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function s(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?n(h.value):a(h.value).then(s,l)}u((r=r.apply(i,[])).next())})}function Fr(i,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},r,a,n,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(h){return l([u,h])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(t=0)),t;)try{if(r=1,a&&(n=u[0]&2?a.return:u[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,u[1])).done)return n;switch(a=0,n&&(u=[u[0]&2,n.value]),u[0]){case 0:case 1:n=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,a=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!n||u[1]>n[0]&&u[1]<n[3])){t.label=u[1];break}if(u[0]===6&&t.label<n[1]){t.label=n[1],n=u;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(u);break}n[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(i,t)}catch(h){u=[6,h],a=0}finally{r=n=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function lt(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],r=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bt(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),a,n=[],o;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)n.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return n}function fe(i,e,t){if(arguments.length===2)for(var r=0,a=e.length,n;r<a;r++)(n||!(r in e))&&(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return i.concat(n||Array.prototype.slice.call(e))}var Y;(function(i){i.Dashed="dashed",i.Solid="solid"})(Y||(Y={}));var X;(function(i){i.Stroke="stroke",i.Fill="fill",i.StrokeFill="stroke_fill"})(X||(X={}));var ae;(function(i){i.Always="always",i.FollowCross="follow_cross",i.None="none"})(ae||(ae={}));var Et;(function(i){i.Standard="standard",i.Rect="rect"})(Et||(Et={}));var he;(function(i){i.Left="left",i.Middle="middle",i.Right="right"})(he||(he={}));var De;(function(i){i.Fixed="fixed",i.Pointer="pointer"})(De||(De={}));var gt;(function(i){i.CandleSolid="candle_solid",i.CandleStroke="candle_stroke",i.CandleUpStroke="candle_up_stroke",i.CandleDownStroke="candle_down_stroke",i.Ohlc="ohlc",i.Area="area"})(gt||(gt={}));var Ce="#F92855",He="rgba(249, 40, 85, .7)",we="#2DC08E",Ye="rgba(45, 192, 142, .7)",Zt="#888888",Ve="#FFFFFF",ct="#1677FF",$t="#76808F",$e="#DDDDDD";function ee(i){return"rgba(22, 119, 255, ".concat(i,")")}function Gi(){function i(){return{show:!0,size:1,color:"#EDEDED",style:Y.Dashed,dashedValue:[2,2]}}return{show:!0,horizontal:i(),vertical:i()}}function Ui(){var i={show:!0,color:$t,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:gt.CandleSolid,bar:{upColor:we,downColor:Ce,noChangeColor:Zt,upBorderColor:we,downBorderColor:Ce,noChangeBorderColor:Zt,upWickColor:we,downWickColor:Ce,noChangeWickColor:Zt},area:{lineSize:2,lineColor:ct,smooth:!1,value:"close",backgroundColor:[{offset:0,color:ee(.01)},{offset:1,color:ee(.2)}],point:{show:!0,color:ct,radius:4,rippleColor:ee(.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:k({},i),low:k({},i),last:{show:!0,upColor:we,downColor:Ce,noChangeColor:Zt,line:{show:!0,style:Y.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:X.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:Y.Solid,borderSize:0,borderDashedValue:[2,2],color:Ve,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:ae.Always,showType:Et.Standard,custom:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}],defaultValue:"n/a",rect:{position:De.Fixed,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:$t,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function Zi(){var i=["#FF9600","#935EBD",ct,"#E11D74","#01C5C4"].map(function(e){return{style:Y.Solid,smooth:!1,size:1,dashedValue:[2,2],color:e}});return{ohlc:{upColor:Ye,downColor:He,noChangeColor:Zt},bars:[{style:X.Fill,borderStyle:Y.Solid,borderSize:1,borderDashedValue:[2,2],upColor:Ye,downColor:He,noChangeColor:Zt}],lines:i,circles:[{style:X.Fill,borderStyle:Y.Solid,borderSize:1,borderDashedValue:[2,2],upColor:Ye,downColor:He,noChangeColor:Zt}],lastValueMark:{show:!1,text:{show:!1,style:X.Fill,color:Ve,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:Y.Solid,borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:ae.Always,showType:Et.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:$t,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function dr(){return{show:!0,size:"auto",axisLine:{show:!0,color:$e,size:1},tickText:{show:!0,color:$t,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:$e}}}function $i(){function i(){return{show:!0,line:{show:!0,style:Y.Dashed,dashedValue:[4,2],size:1,color:$t},text:{show:!0,style:X.Fill,color:Ve,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:Y.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:$t,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:$t}}}return{show:!0,horizontal:i(),vertical:i()}}function ji(){var i=ee(.35),e=ee(.25);function t(){return{style:X.Fill,color:Ve,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:Y.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:ct,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:ct}}return{point:{color:ct,borderColor:i,borderSize:1,radius:5,activeColor:ct,activeBorderColor:i,activeBorderSize:3,activeRadius:5},line:{style:Y.Solid,smooth:!1,color:ct,size:1,dashedValue:[2,2]},rect:{style:X.Fill,color:e,borderColor:ct,borderSize:1,borderRadius:0,borderStyle:Y.Solid,borderDashedValue:[2,2]},polygon:{style:X.Fill,color:ct,borderColor:ct,borderSize:1,borderStyle:Y.Solid,borderDashedValue:[2,2]},circle:{style:X.Fill,color:e,borderColor:ct,borderSize:1,borderStyle:Y.Solid,borderDashedValue:[2,2]},arc:{style:Y.Solid,color:ct,size:1,dashedValue:[2,2]},text:t()}}function qi(){return{size:1,color:$e,fill:!0,activeBackgroundColor:ee(.08)}}function Ki(){return{grid:Gi(),candle:Ui(),indicator:Zi(),xAxis:dr(),yAxis:dr(),separator:qi(),crosshair:$i(),overlay:ji()}}function Z(i,e){if(!(!Pt(i)&&!Pt(e))){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=i[t],a=e[t];Pt(a)&&Pt(r)?Z(r,a):S(e[t])&&(i[t]=de(e[t]))}}}function de(i){if(!Pt(i))return i;var e=null;Rt(i)?e=[]:e={};for(var t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var r=i[t];Pt(r)?e[t]=de(r):e[t]=r}return e}function Rt(i){return Object.prototype.toString.call(i)==="[object Array]"}function at(i){return typeof i=="function"}function Pt(i){return typeof i=="object"&&S(i)}function F(i){return typeof i=="number"&&Number.isFinite(i)}function S(i){return i!=null}function Ne(i){return typeof i=="boolean"}function G(i){return typeof i=="string"}var Ji=/\\(\\)?/g,Qi=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function J(i,e,t){if(S(i)){var r=[];e.replace(Qi,function(s){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];var h=s;return S(l[1])?h=l[2].replace(Ji,"$1"):S(l[0])&&(h=l[0].trim()),r.push(h),""});for(var a=i,n=0,o=r.length;S(a)&&n<o;)a=a==null?void 0:a[r[n++]];return S(a)?a:t??"--"}return t??"--"}function je(i,e){var t={};return i.formatToParts(new Date(e)).forEach(function(r){var a=r.type,n=r.value;switch(a){case"year":{t.YYYY=n;break}case"month":{t.MM=n;break}case"day":{t.DD=n;break}case"hour":{t.HH=n==="24"?"00":n;break}case"minute":{t.mm=n;break}case"second":{t.ss=n;break}}}),t}function ta(i,e,t){var r=je(i,e);return t.replace(/YYYY|MM|DD|HH|mm|ss/g,function(a){return r[a]})}function it(i,e){var t=+i;return F(t)?t.toFixed(e??2):"".concat(i)}function ea(i){var e=+i;if(F(e)){if(e>1e9)return"".concat(+(e/1e9).toFixed(3),"B");if(e>1e6)return"".concat(+(e/1e6).toFixed(3),"M");if(e>1e3)return"".concat(+(e/1e3).toFixed(3),"K")}return"".concat(i)}function ra(i,e){var t="".concat(i);if(e.length===0)return t;if(t.includes(".")){var r=t.split(".");return"".concat(r[0].replace(/(\d)(?=(\d{3})+$)/g,function(a){return"".concat(a).concat(e)}),".").concat(r[1])}return t.replace(/(\d)(?=(\d{3})+$)/g,function(a){return"".concat(a).concat(e)})}function ia(i,e){var t="".concat(i),r=new RegExp("\\.0{"+e+",}[1-9][0-9]*$");if(r.test(t)){var a=t.split("."),n=a.length-1,o=a[n],s=/0*/.exec(o);if(S(s)){var l=s[0].length;return a[n]=o.replace(/0*/,"0{".concat(l,"}")),a.join(".")}}return t}var se=null;function zt(i){var e,t;return(t=(e=i.ownerDocument.defaultView)===null||e===void 0?void 0:e.devicePixelRatio)!==null&&t!==void 0?t:1}function jt(i,e,t){return"".concat(e??"normal"," ").concat(i??12,"px ").concat(t??"Helvetica Neue")}function Re(i,e,t,r){if(!S(se)){var a=document.createElement("canvas"),n=zt(a);se=a.getContext("2d"),se.scale(n,n)}return se.font=jt(e,t,r),Math.round(se.measureText(i).width)}var bt;(function(i){i.OnZoom="onZoom",i.OnScroll="onScroll",i.OnVisibleRangeChange="onVisibleRangeChange",i.OnTooltipIconClick="onTooltipIconClick",i.OnCrosshairChange="onCrosshairChange",i.OnCandleBarClick="onCandleBarClick",i.OnPaneDrag="onPaneDrag"})(bt||(bt={}));var aa=function(){function i(){this._callbacks=[]}return i.prototype.subscribe=function(e){var t=this._callbacks.indexOf(e);t<0&&this._callbacks.push(e)},i.prototype.unsubscribe=function(e){if(at(e)){var t=this._callbacks.indexOf(e);t>-1&&this._callbacks.splice(t,1)}else this._callbacks=[]},i.prototype.execute=function(e){this._callbacks.forEach(function(t){t(e)})},i.prototype.isEmpty=function(){return this._callbacks.length===0},i}(),vt;(function(i){i.Normal="normal",i.Price="price",i.Volume="volume"})(vt||(vt={}));var ce;(function(i){i.Loading="loading",i.Error="error",i.Ready="ready"})(ce||(ce={}));function tr(i,e,t,r){var a=i.result,n=i.figures,o=i.styles,s=J(o,"circles",t.circles),l=s.length,u=J(o,"bars",t.bars),h=u.length,c=J(o,"lines",t.lines),v=c.length,d=0,f=0,g=0,p,m=0;n.forEach(function(_){var y;switch(_.type){case"circle":{m=d;var b=s[d%l];p=k(k({},b),{color:b.noChangeColor}),d++;break}case"bar":{m=f;var x=u[f%h];p=k(k({},x),{color:x.noChangeColor}),f++;break}case"line":{m=g,p=c[g%v],g++;break}}if(S(_.type)){var C=(y=_.styles)===null||y===void 0?void 0:y.call(_,{data:{prev:a[e-1],current:a[e],next:a[e+1]},indicator:i,defaultStyles:t});r(_,k(k({},p),C),m)}})}var na=function(){function i(e){this.precision=4,this.calcParams=[],this.shouldOhlc=!1,this.shouldFormatBigNumber=!1,this.visible=!0,this.zLevel=0,this.series=vt.Normal,this.figures=[],this.minValue=null,this.maxValue=null,this.styles=null,this.shouldUpdate=function(t,r){var a=JSON.stringify(t.calcParams)!==JSON.stringify(r.calcParams)||t.figures!==r.figures||t.calc!==r.calc,n=a||t.shortName!==r.shortName||t.series!==r.series||t.minValue!==r.minValue||t.maxValue!==r.maxValue||t.precision!==r.precision||t.shouldOhlc!==r.shouldOhlc||t.shouldFormatBigNumber!==r.shouldFormatBigNumber||t.visible!==r.visible||t.zLevel!==r.zLevel||t.extendData!==r.extendData||t.regenerateFigures!==r.regenerateFigures||t.createTooltipDataSource!==r.createTooltipDataSource||t.draw!==r.draw;return{calc:a,draw:n}},this.calc=function(){return[]},this.regenerateFigures=null,this.createTooltipDataSource=null,this.draw=null,this.onDataStateChange=null,this.result=[],this._lockSeriesPrecision=!1,this.override(e),this._lockSeriesPrecision=!1}return i.prototype.override=function(e){var t,r,a=this,n=a.result,o=ke(a,["result"]);this._prevIndicator=k(k({},de(o)),{result:n});var s=e.name,l=e.shortName,u=e.precision,h=e.styles,c=e.figures,v=e.calcParams,d=ke(e,["name","shortName","precision","styles","figures","calcParams"]);G(this.name)||(this.name=s??""),this.shortName=(t=l??this.shortName)!==null&&t!==void 0?t:this.name,F(u)&&(this.precision=u,this._lockSeriesPrecision=!0),S(h)&&((r=this.styles)!==null&&r!==void 0||(this.styles={}),Z(this.styles,h)),Z(this,d),S(v)&&(this.calcParams=v,at(this.regenerateFigures)&&(this.figures=this.regenerateFigures(this.calcParams))),this.figures=c??this.figures},i.prototype.setSeriesPrecision=function(e){this._lockSeriesPrecision||(this.precision=e)},i.prototype.shouldUpdateImp=function(){var e=this._prevIndicator.zLevel!==this.zLevel,t=this.shouldUpdate(this._prevIndicator,this);return Ne(t)?{calc:t,draw:t,sort:e}:k(k({},t),{sort:e})},i.prototype.calcImp=function(e){return Rr(this,void 0,void 0,function(){var t;return Fr(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.calc(e,this)];case 1:return t=r.sent(),this.result=t,[2,!0];case 2:return r.sent(),[2,!1];case 3:return[2]}})})},i.extend=function(e){var t=function(r){L(a,r);function a(){return r.call(this,e)||this}return a}(i);return t},i}(),re;(function(i){i.Normal="normal",i.WeakMagnet="weak_magnet",i.StrongMagnet="strong_magnet"})(re||(re={}));function oa(){return["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]}var fr=1,le=-1,sa="overlay_",Kt="overlay_figure_",la=function(){function i(e){this.groupId="",this.totalStep=1,this.currentStep=fr,this.lock=!1,this.visible=!0,this.zLevel=0,this.needDefaultPointFigure=!1,this.needDefaultXAxisFigure=!1,this.needDefaultYAxisFigure=!1,this.mode=re.Normal,this.modeSensitivity=8,this.points=[],this.extendData=null,this.styles=null,this.createPointFigures=null,this.createXAxisFigures=null,this.createYAxisFigures=null,this.performEventPressedMove=null,this.performEventMoveForDrawing=null,this.onDrawStart=null,this.onDrawing=null,this.onDrawEnd=null,this.onClick=null,this.onDoubleClick=null,this.onRightClick=null,this.onPressedMoveStart=null,this.onPressedMoving=null,this.onPressedMoveEnd=null,this.onMouseEnter=null,this.onMouseLeave=null,this.onRemoved=null,this.onSelected=null,this.onDeselected=null,this._prevPressedPoint=null,this._prevPressedPoints=[],this.override(e)}return i.prototype.override=function(e){var t,r;this._prevOverlay=de(this);var a=e.id,n=e.name;e.currentStep;var o=e.points,s=e.styles,l=ke(e,["id","name","currentStep","points","styles"]);if(Z(this,l),G(this.name)||(this.name=n??""),!G(this.id)&&G(a)&&(this.id=a),S(s)&&((t=this.styles)!==null&&t!==void 0||(this.styles={}),Z(this.styles,s)),Rt(o)&&o.length>0){var u=0;if(this.points=fe([],Bt(o),!1),o.length>=this.totalStep-1?(this.currentStep=le,u=this.totalStep-1):(this.currentStep=o.length+1,u=o.length),at(this.performEventMoveForDrawing))for(var h=0;h<u;h++)this.performEventMoveForDrawing({currentStep:h+2,mode:this.mode,points:this.points,performPointIndex:h,performPoint:this.points[h]});this.currentStep===le&&((r=this.performEventPressedMove)===null||r===void 0||r.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}))}},i.prototype.shouldUpdate=function(){var e=this._prevOverlay.zLevel!==this.zLevel,t=e||JSON.stringify(this._prevOverlay)!==JSON.stringify(this.points)||this._prevOverlay.visible!==this.visible||this._prevOverlay.extendData!==this.extendData||this._prevOverlay.styles!==this.styles;return{sort:e,draw:t}},i.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=le:this.currentStep++},i.prototype.forceComplete=function(){this.currentStep=le},i.prototype.isDrawing=function(){return this.currentStep!==le},i.prototype.isStart=function(){return this.currentStep===fr},i.prototype.eventMoveForDrawing=function(e){var t,r=this.currentStep-1,a={};F(e.timestamp)&&(a.timestamp=e.timestamp),F(e.dataIndex)&&(a.dataIndex=e.dataIndex),F(e.value)&&(a.value=e.value),this.points[r]=a,(t=this.performEventMoveForDrawing)===null||t===void 0||t.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:r,performPoint:a})},i.prototype.eventPressedPointMove=function(e,t){var r;F(e.dataIndex)&&(this.points[t].dataIndex=e.dataIndex,this.points[t].timestamp=e.timestamp),F(e.value)&&(this.points[t].value=e.value),(r=this.performEventPressedMove)===null||r===void 0||r.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:t,performPoint:this.points[t]})},i.prototype.startPressedMove=function(e){this._prevPressedPoint=k({},e),this._prevPressedPoints=de(this.points)},i.prototype.eventPressedOtherMove=function(e,t){if(this._prevPressedPoint!==null){var r=null;F(e.dataIndex)&&F(this._prevPressedPoint.dataIndex)&&(r=e.dataIndex-this._prevPressedPoint.dataIndex);var a=null;F(e.value)&&F(this._prevPressedPoint.value)&&(a=e.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(n){var o;F(n.timestamp)&&(n.dataIndex=t.timestampToDataIndex(n.timestamp));var s=k({},n);return F(r)&&F(n.dataIndex)&&(s.dataIndex=n.dataIndex+r,s.timestamp=(o=t.dataIndexToTimestamp(s.dataIndex))!==null&&o!==void 0?o:void 0),F(a)&&F(n.value)&&(s.value=n.value+a),s})}},i.extend=function(e){var t=function(r){L(a,r);function a(){return r.call(this,e)||this}return a}(i);return t},i}(),Tt;(function(i){i[i.Tooltip=0]="Tooltip",i[i.Crosshair=1]="Crosshair",i[i.XAxis=2]="XAxis"})(Tt||(Tt={}));function Fe(i){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return S(i)&&Z(e,i),e}var ie=-1;function Be(i){return at(window.requestAnimationFrame)?window.requestAnimationFrame(i):window.setTimeout(i,20)}function pr(i){at(window.cancelAnimationFrame)?window.cancelAnimationFrame(i):window.clearTimeout(i)}function gr(i){if(at(window.requestIdleCallback))return window.requestIdleCallback(i);var e=performance.now();return window.setTimeout(function(){i({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(performance.now()-e))}})},1)}function ua(i){at(window.cancelIdleCallback)?window.cancelIdleCallback(i):window.clearTimeout(i)}var qe=function(){function i(e){this._options={duration:500,iterationCount:1},this._currentIterationCount=0,this._running=!1,this._time=0,Z(this._options,e)}return i.prototype._loop=function(){var e=this;this._running=!0;var t=function(){var r;if(e._running){var a=new Date().getTime()-e._time;a<e._options.duration?((r=e._doFrameCallback)===null||r===void 0||r.call(e,a),Be(t)):(e.stop(),e._currentIterationCount++,e._currentIterationCount<e._options.iterationCount&&e.start())}};Be(t)},i.prototype.doFrame=function(e){return this._doFrameCallback=e,this},i.prototype.setDuration=function(e){return this._options.duration=e,this},i.prototype.setIterationCount=function(e){return this._options.iterationCount=e,this},i.prototype.start=function(){this._running||(this._time=new Date().getTime(),this._loop())},i.prototype.stop=function(){var e;this._running&&((e=this._doFrameCallback)===null||e===void 0||e.call(this,this._options.duration)),this._running=!1},i}(),Ge=1,mr=new Date().getTime();function Br(i){var e=new Date().getTime();return e===mr?++Ge:Ge=1,mr=e,"".concat(i??"").concat(e,"_").concat(Ge)}function Ot(i,e){var t,r=document.createElement(i),a=e??{};for(var n in a)r.style[n]=(t=a[n])!==null&&t!==void 0?t:"";return r}function Ke(i,e,t){var r=0,a=0;for(a=i.length-1;r!==a;){var n=Math.floor((a+r)/2),o=a-r,s=i[n][e];if(t===i[r][e])return r;if(t===i[a][e])return a;if(t===s)return n;if(t>s?r=n:a=n,o<=2)break}return r}function ha(i){var e=Math.floor(Dt(i)),t=Gt(e),r=i/t,a=0;return r<1.5?a=1:r<2.5?a=2:r<3.5?a=3:r<4.5?a=4:r<5.5?a=5:r<6.5?a=6:a=8,i=a*t,+i.toFixed(Math.abs(e))}function _r(i,e){e=Math.max(0,e??0);var t=Math.pow(10,e);return Math.round(i*t)/t}function ca(i){var e=i.toString(),t=e.indexOf("e");if(t>0){var r=+e.slice(t+1);return r<0?-r:0}var a=e.indexOf(".");return a<0?0:e.length-1-a}function Or(i,e,t){for(var r,a,n=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],o=i.length,s=0;s<o;){var l=i[s];n[0]=Math.max((r=l[e])!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER,n[0]),n[1]=Math.min((a=l[t])!==null&&a!==void 0?a:Number.MAX_SAFE_INTEGER,n[1]),++s}return n}function Dt(i){return i===0?0:Math.log10(i)}function Gt(i){return Math.pow(10,i)}var st;(function(i){i.Init="init",i.Forward="forward",i.Backward="backward",i.Update="update"})(st||(st={}));function Se(){return{from:0,to:0,realFrom:0,realTo:0}}function yr(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return i.join("_")}var va=function(){function i(e){this._requestIdleCallbackId=ie,this._tasks=e??[],this._operateTasks()}return i.prototype._operateTasks=function(e){var t=this;this._requestIdleCallbackId!==ie&&(ua(this._requestIdleCallbackId),this._requestIdleCallbackId=ie),e==null||e(),this._requestIdleCallbackId=gr(function(r){t._runTasks(r)})},i.prototype._runTasks=function(e){for(var t=this;e.timeRemaining()>0&&this._tasks.length>0;){var r=this._tasks.shift();r==null||r.handler()}this._tasks.length>0&&(this._requestIdleCallbackId=gr(function(a){t._runTasks(a)}))},i.prototype.addTask=function(e){var t=this;return this._operateTasks(function(){var r=t._tasks.findIndex(function(a){return a.id===e.id});r>-1?t._tasks[r]=e:t._tasks.push(e)}),this},i.prototype.removeTask=function(e){var t=this;return this._operateTasks(function(){var r=t._tasks.findIndex(function(a){return a.id===e});r>-1&&t._tasks.splice(r,1)}),this},i}(),da={name:"AVP",shortName:"AVP",series:vt.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(i){var e=0,t=0;return i.map(function(r){var a,n,o={},s=(a=r.turnover)!==null&&a!==void 0?a:0,l=(n=r.volume)!==null&&n!==void 0?n:0;return e+=s,t+=l,t!==0&&(o.avp=e/t),o})}},fa={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(i){var e,t,r=i.data,a=i.indicator,n=i.defaultStyles,o=r.prev,s=r.current,l=(e=o==null?void 0:o.ao)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER,u=(t=s==null?void 0:s.ao)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER,h="";u>l?h=J(a.styles,"bars[0].upColor",n.bars[0].upColor):h=J(a.styles,"bars[0].downColor",n.bars[0].downColor);var c=u>l?X.Stroke:X.Fill;return{color:h,style:c,borderColor:h}}}],calc:function(i,e){var t=e.calcParams,r=Math.max(t[0],t[1]),a=0,n=0,o=0,s=0;return i.map(function(l,u){var h={},c=(l.low+l.high)/2;if(a+=c,n+=c,u>=t[0]-1){o=a/t[0];var v=i[u-(t[0]-1)];a-=(v.low+v.high)/2}if(u>=t[1]-1){s=n/t[1];var v=i[u-(t[1]-1)];n-=(v.low+v.high)/2}return u>=r-1&&(h.ao=o-s),h})}},pa={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"bias".concat(t+1),title:"BIAS".concat(e,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,r=e.figures,a=t,n=[];return i.map(function(o,s){var l={},u=o.close;return a.forEach(function(h,c){var v;if(n[c]=((v=n[c])!==null&&v!==void 0?v:0)+u,s>=h-1){var d=n[c]/a[c];l[r[c].key]=(u-d)/d*100,n[c]-=i[s-(h-1)].close}}),l})}};function ga(i,e){var t=i.length,r=0;return i.forEach(function(a){var n=a.close-e;r+=n*n}),r=Math.abs(r),Math.sqrt(r/t)}var ma={name:"BOLL",shortName:"BOLL",series:vt.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=t[0]-1,a=0;return i.map(function(n,o){var s=n.close,l={};if(a+=s,o>=r){l.mid=a/t[0];var u=ga(i.slice(o-r,o+1),l.mid);l.up=l.mid+t[1]*u,l.dn=l.mid-t[1]*u,a-=i[o-r].close}return l})}},_a={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=0,o=0;return i.map(function(s,l){var u,h,c={},v=s.high,d=s.low,f=s.open,g=((u=i[l-1])!==null&&u!==void 0?u:s).close;if(n+=v-f,o+=f-d,r+=v-g,a+=g-d,l>=t[0]-1){o!==0?c.ar=n/o*100:c.ar=0,a!==0?c.br=r/a*100:c.br=0;var p=i[l-(t[0]-1)],m=p.high,_=p.low,y=p.open,b=((h=i[l-t[0]])!==null&&h!==void 0?h:i[l-(t[0]-1)]).close;r-=m-b,a-=b-_,n-=m-y,o-=y-_}return c})}},ya={name:"BBI",shortName:"BBI",series:vt.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=Math.max.apply(Math,fe([],Bt(t),!1)),a=[],n=[];return i.map(function(o,s){var l={},u=o.close;if(t.forEach(function(c,v){var d;a[v]=((d=a[v])!==null&&d!==void 0?d:0)+u,s>=c-1&&(n[v]=a[v]/c,a[v]-=i[s-(c-1)].close)}),s>=r-1){var h=0;n.forEach(function(c){h+=c}),l.bbi=h/4}return l})}},ba={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=t[0]-1,a=0,n=[];return i.map(function(o,s){var l={},u=(o.high+o.low+o.close)/3;if(a+=u,n.push(u),s>=r){var h=a/t[0],c=n.slice(s-r,s+1),v=0;c.forEach(function(g){v+=Math.abs(g-h)});var d=v/t[0];l.cci=d!==0?(u-h)/d/.015:0;var f=(i[s-r].high+i[s-r].low+i[s-r].close)/3;a-=f}return l})}},xa={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=Math.ceil(t[1]/2.5+1),a=Math.ceil(t[2]/2.5+1),n=Math.ceil(t[3]/2.5+1),o=Math.ceil(t[4]/2.5+1),s=0,l=[],u=0,h=[],c=0,v=[],d=0,f=[],g=[];return i.forEach(function(p,m){var _,y,b,x,C,w={},E=(_=i[m-1])!==null&&_!==void 0?_:p,I=(E.high+E.close+E.low+E.open)/4,P=Math.max(0,p.high-I),T=Math.max(0,I-p.low);m>=t[0]-1&&(T!==0?w.cr=P/T*100:w.cr=0,s+=w.cr,u+=w.cr,c+=w.cr,d+=w.cr,m>=t[0]+t[1]-2&&(l.push(s/t[1]),m>=t[0]+t[1]+r-3&&(w.ma1=l[l.length-1-r]),s-=(y=g[m-(t[1]-1)].cr)!==null&&y!==void 0?y:0),m>=t[0]+t[2]-2&&(h.push(u/t[2]),m>=t[0]+t[2]+a-3&&(w.ma2=h[h.length-1-a]),u-=(b=g[m-(t[2]-1)].cr)!==null&&b!==void 0?b:0),m>=t[0]+t[3]-2&&(v.push(c/t[3]),m>=t[0]+t[3]+n-3&&(w.ma3=v[v.length-1-n]),c-=(x=g[m-(t[3]-1)].cr)!==null&&x!==void 0?x:0),m>=t[0]+t[4]-2&&(f.push(d/t[4]),m>=t[0]+t[4]+o-3&&(w.ma4=f[f.length-1-o]),d-=(C=g[m-(t[4]-1)].cr)!==null&&C!==void 0?C:0)),g.push(w)}),g}},Ca={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=Math.max(t[0],t[1]),a=0,n=0,o=0,s=[];return i.forEach(function(l,u){var h,c={},v=l.close;a+=v,n+=v;var d=0,f=0;if(u>=t[0]-1&&(d=a/t[0],a-=i[u-(t[0]-1)].close),u>=t[1]-1&&(f=n/t[1],n-=i[u-(t[1]-1)].close),u>=r-1){var g=d-f;c.dma=g,o+=g,u>=r+t[2]-2&&(c.ama=o/t[2],o-=(h=s[u-(t[2]-1)].dma)!==null&&h!==void 0?h:0)}s.push(c)}),s}},wa={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=0,o=0,s=0,l=0,u=0,h=0,c=[];return i.forEach(function(v,d){var f,g,p={},m=(f=i[d-1])!==null&&f!==void 0?f:v,_=m.close,y=v.high,b=v.low,x=y-b,C=Math.abs(y-_),w=Math.abs(_-b),E=y-m.high,I=m.low-b,P=Math.max(Math.max(x,C),w),T=E>0&&E>I?E:0,D=I>0&&I>E?I:0;if(r+=P,a+=T,n+=D,d>=t[0]-1){d>t[0]-1?(o=o-o/t[0]+P,s=s-s/t[0]+T,l=l-l/t[0]+D):(o=r,s=a,l=n);var A=0,M=0;o!==0&&(A=s*100/o,M=l*100/o),p.pdi=A,p.mdi=M;var R=0;M+A!==0&&(R=Math.abs(M-A)/(M+A)*100),u+=R,d>=t[0]*2-2&&(d>t[0]*2-2?h=(h*(t[0]-1)+R)/t[0]:h=u/t[0],p.adx=h,d>=t[0]*2+t[1]-3&&(p.adxr=(((g=c[d-(t[1]-1)].adx)!==null&&g!==void 0?g:0)+h)/2))}c.push(p)}),c}},Sa={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=[];return i.map(function(n,o){var s,l={};if(o>0){var u=i[o-1],h=n.high,c=n.low,v=(s=n.volume)!==null&&s!==void 0?s:0,d=(h+c)/2-(u.high+u.low)/2;if(v===0||h-c===0)l.emv=0;else{var f=v/1e8/(h-c);l.emv=d/f}r+=l.emv,a.push(l.emv),o>=t[0]&&(l.maEmv=r/t[0],r-=a[o-t[0]])}return l})}},Ia={name:"EMA",shortName:"EMA",series:vt.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"ema".concat(t+1),title:"EMA".concat(e,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,r=e.figures,a=0,n=[];return i.map(function(o,s){var l={},u=o.close;return a+=u,t.forEach(function(h,c){s>=h-1&&(s>h-1?n[c]=(2*u+(h-1)*n[c])/(h+1):n[c]=a/h,l[r[c].key]=n[c])}),l})}},Ea={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=[];return i.forEach(function(n,o){var s,l={};if(o>=t[0]){var u=n.close,h=i[o-t[0]].close;l.mtm=u-h,r+=l.mtm,o>=t[0]+t[1]-1&&(l.maMtm=r/t[1],r-=(s=a[o-(t[1]-1)].mtm)!==null&&s!==void 0?s:0)}a.push(l)}),a}},Ta={name:"MA",shortName:"MA",series:vt.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"ma".concat(t+1),title:"MA".concat(e,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,r=e.figures,a=[];return i.map(function(n,o){var s={},l=n.close;return t.forEach(function(u,h){var c;a[h]=((c=a[h])!==null&&c!==void 0?c:0)+l,o>=u-1&&(s[r[h].key]=a[h]/u,a[h]-=i[o-(u-1)].close)}),s})}},Pa={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(i){var e,t,r=i.data,a=i.indicator,n=i.defaultStyles,o=r.prev,s=r.current,l=(e=o==null?void 0:o.macd)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER,u=(t=s==null?void 0:s.macd)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER,h="";u>0?h=J(a.styles,"bars[0].upColor",n.bars[0].upColor):u<0?h=J(a.styles,"bars[0].downColor",n.bars[0].downColor):h=J(a.styles,"bars[0].noChangeColor",n.bars[0].noChangeColor);var c=l<u?X.Stroke:X.Fill;return{style:c,color:h,borderColor:h}}}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=0,o=0,s=0,l=0,u=Math.max(t[0],t[1]);return i.map(function(h,c){var v={},d=h.close;return r+=d,c>=t[0]-1&&(c>t[0]-1?a=(2*d+(t[0]-1)*a)/(t[0]+1):a=r/t[0]),c>=t[1]-1&&(c>t[1]-1?n=(2*d+(t[1]-1)*n)/(t[1]+1):n=r/t[1]),c>=u-1&&(o=a-n,v.dif=o,s+=o,c>=u+t[2]-2&&(c>u+t[2]-2?l=(o*2+l*(t[2]-1))/(t[2]+1):l=s/t[2],v.macd=(o-l)*2,v.dea=l)),v})}},Ma={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=[];return i.forEach(function(o,s){var l,u,h,c,v=(l=i[s-1])!==null&&l!==void 0?l:o;o.close<v.close?a-=(u=o.volume)!==null&&u!==void 0?u:0:o.close>v.close&&(a+=(h=o.volume)!==null&&h!==void 0?h:0);var d={obv:a};r+=a,s>=t[0]-1&&(d.maObv=r/t[0],r-=(c=n[s-(t[0]-1)].obv)!==null&&c!==void 0?c:0),n.push(d)}),n}},Aa={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(i){var e=0;return i.map(function(t,r){var a,n,o={},s=t.close,l=(a=t.volume)!==null&&a!==void 0?a:1,u=((n=i[r-1])!==null&&n!==void 0?n:t).close,h=0,c=u*l;return c!==0&&(h=(s-u)/c),e+=h,o.pvt=e,o})}},ka={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=[],o=[];return i.forEach(function(s,l){var u,h,c={},v=((u=i[l-1])!==null&&u!==void 0?u:s).close,d=s.close-v>0?1:0;n.push(d),r+=d,l>=t[0]-1&&(c.psy=r/t[0]*100,a+=c.psy,l>=t[0]+t[1]-2&&(c.maPsy=a/t[1],a-=(h=o[l-(t[1]-1)].psy)!==null&&h!==void 0?h:0),r-=n[l-(t[0]-1)]),o.push(c)}),o}},Da={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=[],a=0;return i.forEach(function(n,o){var s,l,u={};if(o>=t[0]-1){var h=n.close,c=((s=i[o-t[0]])!==null&&s!==void 0?s:i[o-(t[0]-1)]).close;c!==0?u.roc=(h-c)/c*100:u.roc=0,a+=u.roc,o>=t[0]-1+t[1]-1&&(u.maRoc=a/t[1],a-=(l=r[o-(t[1]-1)].roc)!==null&&l!==void 0?l:0)}r.push(u)}),r}},Ra={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){var r=t+1;return{key:"rsi".concat(r),title:"RSI".concat(r,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,r=e.figures,a=t,n=[],o=[];return i.map(function(s,l){var u,h={},c=((u=i[l-1])!==null&&u!==void 0?u:s).close,v=s.close-c;return a.forEach(function(d,f){var g,p,m;if(v>0?n[f]=((g=n[f])!==null&&g!==void 0?g:0)+v:o[f]=((p=o[f])!==null&&p!==void 0?p:0)+Math.abs(v),l>=d-1){o[f]!==0?h[r[f].key]=100-100/(1+n[f]/o[f]):h[r[f].key]=0;var _=i[l-(d-1)],y=(m=i[l-d])!==null&&m!==void 0?m:_,b=_.close-y.close;b>0?n[f]-=b:o[f]-=Math.abs(b)}}),h})}},Fa={name:"SMA",shortName:"SMA",series:vt.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(i,e){var t=e.calcParams,r=0,a=0;return i.map(function(n,o){var s={},l=n.close;return r+=l,o>=t[0]-1&&(o>t[0]-1?a=(l*t[1]+a*(t[0]-t[1]+1))/(t[0]+1):a=r/t[0],s.sma=a),s})}},Ba={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=[];return i.forEach(function(a,n){var o,s,l,u,h={},c=a.close;if(n>=t[0]-1){var v=Or(i.slice(n-(t[0]-1),n+1),"high","low"),d=v[0],f=v[1],g=d-f,p=(c-f)/(g===0?1:g)*100;h.k=((t[1]-1)*((s=(o=r[n-1])===null||o===void 0?void 0:o.k)!==null&&s!==void 0?s:50)+p)/t[1],h.d=((t[2]-1)*((u=(l=r[n-1])===null||l===void 0?void 0:l.d)!==null&&u!==void 0?u:50)+h.k)/t[2],h.j=3*h.k-2*h.d}r.push(h)}),r}},Oa={name:"SAR",shortName:"SAR",series:vt.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(i){var e,t,r,a=i.data,n=i.indicator,o=i.defaultStyles,s=a.current,l=(e=s==null?void 0:s.sar)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER,u=(((t=s==null?void 0:s.high)!==null&&t!==void 0?t:0)+((r=s==null?void 0:s.low)!==null&&r!==void 0?r:0))/2,h=l<u?J(n.styles,"circles[0].upColor",o.circles[0].upColor):J(n.styles,"circles[0].downColor",o.circles[0].downColor);return{color:h}}}],calc:function(i,e){var t=e.calcParams,r=t[0]/100,a=t[1]/100,n=t[2]/100,o=r,s=-100,l=!1,u=0;return i.map(function(h,c){var v=u,d=h.high,f=h.low;if(l){(s===-100||s<d)&&(s=d,o=Math.min(o+a,n)),u=v+o*(s-v);var g=Math.min(i[Math.max(1,c)-1].low,f);u>h.low?(u=s,o=r,s=-100,l=!l):u>g&&(u=g)}else{(s===-100||s>f)&&(s=f,o=Math.min(o+a,n)),u=v+o*(s-v);var p=Math.max(i[Math.max(1,c)-1].high,d);u<h.high?(u=s,o=0,s=-100,l=!l):u<p&&(u=p)}return{high:d,low:f,sar:u}})}},La={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=0,o=0,s=0,l=0,u=0,h=[];return i.forEach(function(c,v){var d,f={},g=c.close;if(r+=g,v>=t[0]-1&&(v>t[0]-1?a=(2*g+(t[0]-1)*a)/(t[0]+1):a=r/t[0],s+=a,v>=t[0]*2-2&&(v>t[0]*2-2?n=(2*a+(t[0]-1)*n)/(t[0]+1):n=s/t[0],l+=n,v>=t[0]*3-3))){var p=0,m=0;v>t[0]*3-3?(p=(2*n+(t[0]-1)*o)/(t[0]+1),m=(p-o)/o*100):p=l/t[0],o=p,f.trix=m,u+=m,v>=t[0]*3+t[1]-4&&(f.maTrix=u/t[1],u-=(d=h[v-(t[1]-1)].trix)!==null&&d!==void 0?d:0)}h.push(f)}),h}};function br(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(i){var e=i.data,t=i.indicator,r=i.defaultStyles,a=e.current,n=J(t.styles,"bars[0].noChangeColor",r.bars[0].noChangeColor);return S(a)&&(a.close>a.open?n=J(t.styles,"bars[0].upColor",r.bars[0].upColor):a.close<a.open&&(n=J(t.styles,"bars[0].downColor",r.bars[0].downColor))),{color:n}}}}var Va={name:"VOL",shortName:"VOL",series:vt.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},br()],regenerateFigures:function(i){var e=i.map(function(t,r){return{key:"ma".concat(r+1),title:"MA".concat(t,": "),type:"line"}});return e.push(br()),e},calc:function(i,e){var t=e.calcParams,r=e.figures,a=t,n=[];return i.map(function(o,s){var l,u=(l=o.volume)!==null&&l!==void 0?l:0,h={volume:u,open:o.open,close:o.close};return a.forEach(function(c,v){var d,f;n[v]=((d=n[v])!==null&&d!==void 0?d:0)+u,s>=c-1&&(h[r[v].key]=n[v]/c,n[v]-=(f=i[s-(c-1)].volume)!==null&&f!==void 0?f:0)}),h})}},Na={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(i,e){var t=e.calcParams,r=0,a=0,n=0,o=0,s=[];return i.forEach(function(l,u){var h,c,v,d,f,g={},p=l.close,m=((h=i[u-1])!==null&&h!==void 0?h:l).close,_=(c=l.volume)!==null&&c!==void 0?c:0;if(p>m?r+=_:p<m?a+=_:n+=_,u>=t[0]-1){var y=n/2;a+y===0?g.vr=0:g.vr=(r+y)/(a+y)*100,o+=g.vr,u>=t[0]+t[1]-2&&(g.maVr=o/t[1],o-=(v=s[u-(t[1]-1)].vr)!==null&&v!==void 0?v:0);var b=i[u-(t[0]-1)],x=(d=i[u-t[0]])!==null&&d!==void 0?d:b,C=b.close,w=(f=b.volume)!==null&&f!==void 0?f:0;C>x.close?r-=w:C<x.close?a-=w:n-=w}s.push(g)}),s}},Wa={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"wr".concat(t+1),title:"WR".concat(t+1,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,r=e.figures,a=t;return i.map(function(n,o){var s={},l=n.close;return a.forEach(function(u,h){var c=u-1;if(o>=c){var v=Or(i.slice(o-c,o+1),"high","low"),d=v[0],f=v[1],g=d-f;s[r[h].key]=g===0?0:(l-d)/g*100}}),s})}},Lr={},za=[da,fa,pa,ma,_a,ya,ba,xa,Ca,wa,Sa,Ia,Ea,Ta,Pa,Ma,Aa,ka,Da,Ra,Fa,Ba,Oa,La,Va,Na,Wa];za.forEach(function(i){Lr[i.name]=na.extend(i)});function Vr(i){var e;return(e=Lr[i])!==null&&e!==void 0?e:null}var Xa={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e,t,r=i.chart,a=i.coordinates,n=i.bounding,o=i.overlay,s=i.yAxis,l=o.points;if(a.length>0){var u=0;if(!((e=s==null?void 0:s.isInCandle())!==null&&e!==void 0)||e)u=r.getPrecision().price;else{var h=(t=r.getIndicators({paneId:o.paneId}).get(o.paneId))!==null&&t!==void 0?t:[];h.forEach(function(_){u=Math.max(u,_.precision)})}var c=[],v=[],d=0,f=n.width;if(a.length>1&&F(l[0].value)&&F(l[1].value)){var g=[1,.786,.618,.5,.382,.236,0],p=a[0].y-a[1].y,m=l[0].value-l[1].value;g.forEach(function(_){var y,b=a[1].y+p*_,x=r.getDecimalFold().format(r.getThousandsSeparator().format((((y=l[1].value)!==null&&y!==void 0?y:0)+m*_).toFixed(u)));c.push({coordinates:[{x:d,y:b},{x:f,y:b}]}),v.push({x:d,y:b,text:"".concat(x," (").concat((_*100).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:c},{type:"text",isCheckEvent:!1,attrs:v}]}return[]}},Ha={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding,r={x:0,y:e[0].y};return S(e[1])&&e[0].x<e[1].x&&(r.x=t.width),[{type:"line",attrs:{coordinates:[e[0],r]}}]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].value=t.value,e[1].value=t.value},performEventMoveForDrawing:function(i){var e=i.currentStep,t=i.points,r=i.performPoint;e===2&&(t[0].value=r.value)}},Ya={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=[];return e.length===2&&t.push({coordinates:e}),[{type:"line",attrs:t}]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].value=t.value,e[1].value=t.value},performEventMoveForDrawing:function(i){var e=i.currentStep,t=i.points,r=i.performPoint;e===2&&(t[0].value=r.value)}},Ga={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.width,y:e[0].y}]}}]}},er=function(){function i(){this._children=[],this._callbacks=new Map}return i.prototype.registerEvent=function(e,t){return this._callbacks.set(e,t),this},i.prototype.onEvent=function(e,t,r){var a=this._callbacks.get(e);return S(a)&&this.checkEventOn(t)?a(t,r):!1},i.prototype.checkEventOn=function(e){var t,r;try{for(var a=lt(this._children),n=a.next();!n.done;n=a.next()){var o=n.value;if(o.checkEventOn(e))return!0}}catch(s){t={error:s}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return!1},i.prototype.dispatchEvent=function(e,t,r){var a=this._children.length-1;if(a>-1){for(var n=a;n>-1;n--)if(this._children[n].dispatchEvent(e,t,r))return!0}return this.onEvent(e,t,r)},i.prototype.addChild=function(e){return this._children.push(e),this},i.prototype.clear=function(){this._children=[]},i}(),q=2,Ua=function(i){L(e,i);function e(t){var r=i.call(this)||this;return r.attrs=t.attrs,r.styles=t.styles,r}return e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.setAttrs=function(t){return this.attrs=t,this},e.prototype.setStyles=function(t){return this.styles=t,this},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var r=function(a){L(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.checkEventOnImp=function(o,s,l){return t.checkEventOn(o,s,l)},n.prototype.drawImp=function(o,s,l){t.draw(o,s,l)},n}(e);return r},e}(er);function Za(i,e){var t,r,a=[];a=a.concat(e);try{for(var n=lt(a),o=n.next();!o.done;o=n.next()){var s=o.value,l=s.coordinates;if(l.length>1)for(var u=1;u<l.length;u++){var h=l[u-1],c=l[u];if(h.x===c.x){if(Math.abs(h.y-i.y)+Math.abs(c.y-i.y)-Math.abs(h.y-c.y)<q+q&&Math.abs(i.x-h.x)<q)return!0}else{var v=rr(h,c),d=Nr(v,i),f=Math.abs(d-i.y);if(Math.abs(h.x-i.x)+Math.abs(c.x-i.x)-Math.abs(h.x-c.x)<q+q&&f*f/(v[0]*v[0]+1)<q*q)return!0}}}}catch(g){t={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1}function Nr(i,e){return i!==null?e.x*i[0]+i[1]:e.y}function Oe(i,e,t){var r=rr(i,e);return Nr(r,t)}function rr(i,e){var t=i.x-e.x;if(t!==0){var r=(i.y-e.y)/t,a=i.y-r*i.x;return[r,a]}return null}function Wr(i,e,t){var r=e.length,a=F(t)?t>0&&t<1?t:0:t?.5:0;if(a>0&&r>2){for(var n=e[0].x,o=e[0].y,s=1;s<r-1;s++){var l=e[s-1],u=e[s],h=e[s+1],c=u.x-l.x,v=u.y-l.y,d=h.x-u.x,f=h.y-u.y,g=h.x-l.x,p=h.y-l.y,m=Math.sqrt(c*c+v*v),_=Math.sqrt(d*d+f*f),y=_/(_+m),b=u.x+g*a*y,x=u.y+p*a*y;b=Math.min(b,Math.max(h.x,u.x)),x=Math.min(x,Math.max(h.y,u.y)),b=Math.max(b,Math.min(h.x,u.x)),x=Math.max(x,Math.min(h.y,u.y)),g=b-u.x,p=x-u.y;var C=u.x-g*m/_,w=u.y-p*m/_;C=Math.min(C,Math.max(l.x,u.x)),w=Math.min(w,Math.max(l.y,u.y)),C=Math.max(C,Math.min(l.x,u.x)),w=Math.max(w,Math.min(l.y,u.y)),g=u.x-C,p=u.y-w,b=u.x+g*_/m,x=u.y+p*_/m,i.bezierCurveTo(n,o,C,w,u.x,u.y),n=b,o=x}var E=e[r-1];i.bezierCurveTo(n,o,E.x,E.y,E.x,E.y)}else for(var s=1;s<r;s++)i.lineTo(e[s].x,e[s].y)}function $a(i,e,t){var r=[];r=r.concat(e);var a=t.style,n=a===void 0?Y.Solid:a,o=t.smooth,s=o===void 0?!1:o,l=t.size,u=l===void 0?1:l,h=t.color,c=h===void 0?"currentColor":h,v=t.dashedValue,d=v===void 0?[2,2]:v;i.lineWidth=u,i.strokeStyle=c,n===Y.Dashed?i.setLineDash(d):i.setLineDash([]);var f=u%2===1?.5:0;r.forEach(function(g){var p=g.coordinates;p.length>1&&(p.length===2&&(p[0].x===p[1].x||p[0].y===p[1].y)?(i.beginPath(),p[0].x===p[1].x?(i.moveTo(p[0].x+f,p[0].y),i.lineTo(p[1].x+f,p[1].y)):(i.moveTo(p[0].x,p[0].y+f),i.lineTo(p[1].x,p[1].y+f)),i.stroke(),i.closePath()):(i.save(),u%2===1&&i.translate(.5,.5),i.beginPath(),i.moveTo(p[0].x,p[0].y),Wr(i,p,s),i.stroke(),i.closePath(),i.restore()))})}var ja={name:"line",checkEventOn:Za,draw:function(i,e,t){$a(i,e,t)}};function zr(i,e,t){var r=t??0,a=[];if(i.length>1)if(i[0].x===i[1].x){var n=0,o=e.height;if(a.push({coordinates:[{x:i[0].x,y:n},{x:i[0].x,y:o}]}),i.length>2){a.push({coordinates:[{x:i[2].x,y:n},{x:i[2].x,y:o}]});for(var s=i[0].x-i[2].x,l=0;l<r;l++){var u=s*(l+1);a.push({coordinates:[{x:i[0].x+u,y:n},{x:i[0].x+u,y:o}]})}}}else{var h=0,c=e.width,v=rr(i[0],i[1]),d=v[0],f=v[1];if(a.push({coordinates:[{x:h,y:h*d+f},{x:c,y:c*d+f}]}),i.length>2){var g=i[2].y-d*i[2].x;a.push({coordinates:[{x:h,y:h*d+g},{x:c,y:c*d+g}]});for(var s=f-g,l=0;l<r;l++){var p=f+s*(l+1);a.push({coordinates:[{x:h,y:h*d+p},{x:c,y:c*d+p}]})}}}return a}var qa={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return[{type:"line",attrs:zr(e,t)}]}},Ka={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return[{type:"line",attrs:zr(e,t,1)}]}},Ja={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e,t,r=i.chart,a=i.coordinates,n=i.bounding,o=i.overlay,s=i.yAxis,l=0;if(!((e=s==null?void 0:s.isInCandle())!==null&&e!==void 0)||e)l=r.getPrecision().price;else{var u=(t=r.getIndicators({paneId:o.paneId}).get(o.paneId))!==null&&t!==void 0?t:[];u.forEach(function(v){l=Math.max(l,v.precision)})}var h=o.points[0].value,c=h===void 0?0:h;return[{type:"line",attrs:{coordinates:[a[0],{x:n.width,y:a[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:a[0].x,y:a[0].y,text:r.getDecimalFold().format(r.getThousandsSeparator().format(c.toFixed(l))),baseline:"bottom"}}]}};function Qa(i,e){if(i.length>1){var t={x:0,y:0};return i[0].x===i[1].x&&i[0].y!==i[1].y?i[0].y<i[1].y?t={x:i[0].x,y:e.height}:t={x:i[0].x,y:0}:i[0].x>i[1].x?t={x:0,y:Oe(i[0],i[1],{x:0,y:i[0].y})}:t={x:e.width,y:Oe(i[0],i[1],{x:e.width,y:i[0].y})},{coordinates:[i[0],t]}}return[]}var tn={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return[{type:"line",attrs:Qa(e,t)}]}},en={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;return e.length===2?[{type:"line",attrs:{coordinates:e}}]:[]}},rn={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return e.length===2?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:t.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Oe(e[0],e[1],{x:0,y:e[0].y})},{x:t.width,y:Oe(e[0],e[1],{x:t.width,y:e[0].y})}]}}]:[]}},an={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;if(e.length===2){var r={x:e[0].x,y:0};return e[0].y<e[1].y&&(r.y=t.height),[{type:"line",attrs:{coordinates:[e[0],r]}}]}return[]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex,e[1].timestamp=t.timestamp,e[1].dataIndex=t.dataIndex},performEventMoveForDrawing:function(i){var e=i.currentStep,t=i.points,r=i.performPoint;e===2&&(t[0].timestamp=r.timestamp,t[0].dataIndex=r.dataIndex)}},nn={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;return e.length===2?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex,e[1].timestamp=t.timestamp,e[1].dataIndex=t.dataIndex},performEventMoveForDrawing:function(i){var e=i.currentStep,t=i.points,r=i.performPoint;e===2&&(t[0].timestamp=r.timestamp,t[0].dataIndex=r.dataIndex)}},on={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:t.height}]}}]}},sn={name:"simpleAnnotation",totalStep:2,styles:{line:{style:Y.Dashed}},createPointFigures:function(i){var e,t=i.overlay,r=i.coordinates,a="";S(t.extendData)&&(at(t.extendData)?a=t.extendData(t):a=(e=t.extendData)!==null&&e!==void 0?e:"");var n=r[0].x,o=r[0].y-6,s=o-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:n,y:o},{x:n,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:n,y:s},{x:n-4,y:l},{x:n+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:n,y:l,text:a,align:"center",baseline:"bottom"},ignoreEvent:!0}]}},ln={name:"simpleTag",totalStep:2,styles:{line:{style:Y.Dashed}},createPointFigures:function(i){var e=i.bounding,t=i.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:e.width,y:t[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(i){var e,t,r=i.chart,a=i.overlay,n=i.coordinates,o=i.bounding,s=i.yAxis,l=(e=s==null?void 0:s.isFromZero())!==null&&e!==void 0?e:!1,u="left",h=0;l?(u="left",h=0):(u="right",h=o.width);var c="";return S(a.extendData)&&(at(a.extendData)?c=a.extendData(a):c=(t=a.extendData)!==null&&t!==void 0?t:""),!S(c)&&F(a.points[0].value)&&(c=it(a.points[0].value,r.getPrecision().price)),{type:"text",attrs:{x:h,y:n[0].y,text:c,align:u,baseline:"middle"}}}},Xr={},un=[Xa,Ha,Ya,Ga,qa,Ka,Ja,tn,en,rn,an,nn,on,sn,ln];un.forEach(function(i){Xr[i.name]=la.extend(i)});function hn(i){var e;return(e=Xr[i])!==null&&e!==void 0?e:null}var cn={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},vn={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},dn={light:cn,dark:vn};function fn(i){var e;return(e=dn[i])!==null&&e!==void 0?e:null}var Ee=30,Hr=100,O={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},pt={Year:365*24*3600,Month:30*24*3600,Day:24*3600,Hour:3600,Minute:60,Second:1},xr={MIN:1,MAX:50},pn=10,gn=80,mn=.2,Je=10,_n=function(){function i(e,t){var r=this;this._styles=Ki(),this._customApi={formatDate:function(c,v){return ta(r._dateTimeFormat,c,v)},formatBigNumber:ea},this._locale="en-US",this._thousandsSeparator={sign:",",format:function(c){return ra(c,r._thousandsSeparator.sign)}},this._decimalFold={threshold:3,format:function(c){return ia(c,r._decimalFold.threshold)}},this._precision={price:2,volume:0},this._dataList=[],this._loadMoreDataCallback=null,this._loading=!0,this._loadDataMore={forward:!1,backward:!1},this._zoomEnabled=!0,this._scrollEnabled=!0,this._totalBarSpace=0,this._barSpace=pn,this._offsetRightDistance=gn,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange=Se(),this._cacheVisibleRange=Se(),this._timeTicks=new Map,this._visibleRangeTimeTickList=[],this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._crosshair={},this._activeTooltipIcon=null,this._actions=new Map,this._indicators=new Map,this._taskScheduler=new va,this._overlays=new Map,this._progressOverlayInfo=null,this._pressedOverlayInfo={paneId:"",overlay:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverOverlayInfo={paneId:"",overlay:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickOverlayInfo={paneId:"",overlay:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chart=e,this._calcOptimalBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace;var a=t??{},n=a.styles,o=a.locale,s=a.timezone,l=a.customApi,u=a.thousandsSeparator,h=a.decimalFold;S(n)&&this.setStyles(n),G(o)&&this.setLocale(o),this.setTimezone(s??""),S(l)&&this.setCustomApi(l),S(u)&&this.setThousandsSeparator(u),S(h)&&this.setDecimalFold(h)}return i.prototype.setStyles=function(e){var t,r,a=null;G(e)?a=fn(e):a=e,Z(this._styles,a),Rt((r=(t=a==null?void 0:a.candle)===null||t===void 0?void 0:t.tooltip)===null||r===void 0?void 0:r.custom)&&(this._styles.candle.tooltip.custom=a.candle.tooltip.custom)},i.prototype.getStyles=function(){return this._styles},i.prototype.setCustomApi=function(e){Z(this._customApi,e)},i.prototype.getCustomApi=function(){return this._customApi},i.prototype.setLocale=function(e){this._locale=e},i.prototype.getLocale=function(){return this._locale},i.prototype.setTimezone=function(e){if(!S(this._dateTimeFormat)||this.getTimezone()!==e){var t={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};e.length>0&&(t.timeZone=e);var r=null;try{r=new Intl.DateTimeFormat("en",t)}catch{}r!==null&&(this._classifyTimeTicks(this._dataList),this._adjustVisibleRangeTimeTickList(),this._dateTimeFormat=r)}},i.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},i.prototype.setThousandsSeparator=function(e){Z(this._thousandsSeparator,e)},i.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},i.prototype.setDecimalFold=function(e){Z(this._decimalFold,e)},i.prototype.getDecimalFold=function(){return this._decimalFold},i.prototype.getPrecision=function(){return this._precision},i.prototype.setPrecision=function(e){Z(this._precision,e),this._synchronizeIndicatorSeriesPrecision()},i.prototype.getDataList=function(){return this._dataList},i.prototype.getVisibleRangeDataList=function(){return this._visibleRangeDataList},i.prototype.getVisibleRangeHighLowPrice=function(){return this._visibleRangeHighLowPrice},i.prototype.addData=function(e,t,r){var a=this,n,o,s,l,u=!1,h=!1,c=0;if(Rt(e)){switch(c=e.length,t){case st.Init:{this.clearData(),this._dataList=e,this._loadDataMore.backward=(n=r==null?void 0:r.forward)!==null&&n!==void 0?n:!1,this._loadDataMore.forward=(o=r==null?void 0:r.forward)!==null&&o!==void 0?o:!1,this._classifyTimeTicks(this._dataList),this.setOffsetRightDistance(this._offsetRightDistance),h=!0;break}case st.Backward:{this._classifyTimeTicks(e,!0),this._dataList=this._dataList.concat(e),this._loadDataMore.backward=(s=r==null?void 0:r.backward)!==null&&s!==void 0?s:!1,h=c>0;break}case st.Forward:this._dataList=e.concat(this._dataList),this._classifyTimeTicks(this._dataList),this._loadDataMore.forward=(l=r==null?void 0:r.forward)!==null&&l!==void 0?l:!1,h=c>0}this._loading=!1,u=!0}else{var v=this._dataList.length,d=e.timestamp,f=J(this._dataList[v-1],"timestamp",0);if(d>f){this._classifyTimeTicks([e],!0),this._dataList.push(e);var g=this.getLastBarRightSideDiffBarCount();g<0&&this.setLastBarRightSideDiffBarCount(--g),c=1,u=!0,h=!0}else d===f&&(this._dataList[v-1]=e,u=!0,h=!0)}if(u&&(c>0&&this._overlays.forEach(function(m){m.forEach(function(_){var y=_.points;y.forEach(function(b){if(!S(b.timestamp)&&S(b.dataIndex)){t===st.Forward&&(b.dataIndex=b.dataIndex+c);var x=a._dataList[b.dataIndex];b.timestamp=x==null?void 0:x.timestamp}})})}),h)){this._adjustVisibleRange(),this.setCrosshair(this._crosshair,!0);var p=this.getIndicatorsByFilter({});p.forEach(function(m,_){m.forEach(function(y){a._addIndicatorCalcTask(_,y,t)})}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})}},i.prototype.setLoadMoreDataCallback=function(e){this._loadMoreDataCallback=e},i.prototype._calcOptimalBarSpace=function(){var e=4,t=1-mn*Math.atan(Math.max(e,this._barSpace)-e)/(Math.PI*.5),r=Math.min(Math.floor(this._barSpace*t),Math.floor(this._barSpace));r%2===0&&r+2>=this._barSpace&&--r,this._gapBarSpace=Math.max(1,r)},i.prototype._classifyTimeTicks=function(e,t){var r,a=0,n=null;t??!1?(a=this._dataList.length,n=this._dataList[a-1]):this._timeTicks.clear();for(var o=0;o<e.length;o++){var s=e[o],l=pt.Second,u=je(this._dateTimeFormat,s.timestamp);if(S(n)){var h=je(this._dateTimeFormat,n.timestamp);u.YYYY!==h.YYYY?l=pt.Year:u.MM!==h.MM?l=pt.Month:u.DD!==h.DD?l=pt.Day:u.HH!==h.HH?l=pt.Hour:u.mm!==h.mm?l=pt.Minute:l=pt.Second}var c=(r=this._timeTicks.get(l))!==null&&r!==void 0?r:[];c.push({dataIndex:o+a,weight:l,dateTime:u,timestamp:s.timestamp}),this._timeTicks.set(l,c),n=s}},i.prototype._adjustVisibleRangeTimeTickList=function(){var e,t,r=this,a=this._styles.xAxis.tickText,n=Math.max(Math.ceil(this._totalBarSpace/10),Re("0000-00-00 00:00",a.size,a.weight,a.family)),o=Math.ceil(n/this._barSpace),s=[];Array.from(this._timeTicks.keys()).sort(function(c,v){return v-c}).forEach(function(c){var v=s;s=[];for(var d=v.length,f=0,g=r._timeTicks.get(c),p=g.length,m=1/0,_=-1/0,y=0;y<p;y++){for(var b=g[y],x=b.dataIndex;f<d;){var C=v[f],w=C.dataIndex;if(w<x)f++,s.push(C),_=w,m=1/0;else{m=w;break}}m-x>=o&&x-_>=o&&(s.push(b),_=x)}for(;f<d;f++)s.push(v[f])}),this._visibleRangeTimeTickList=[];try{for(var l=lt(s),u=l.next();!u.done;u=l.next()){var h=u.value;h.dataIndex>=this._visibleRange.from&&h.dataIndex<=this._visibleRange.to&&this._visibleRangeTimeTickList.push(h)}}catch(c){e={error:c}}finally{try{u&&!u.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}},i.prototype.getVisibleRangeTimeTickList=function(){return this._visibleRangeTimeTickList},i.prototype._adjustVisibleRange=function(){var e=this,t,r,a=this._dataList.length,n=this._totalBarSpace/this._barSpace,o=0,s=0;this._scrollLimitRole===1?(o=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,s=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(o=this._minVisibleBarCount.left,s=this._minVisibleBarCount.right),o=Math.max(0,o),s=Math.max(0,s);var l=n-Math.min(o,a);this._lastBarRightSideDiffBarCount>l&&(this._lastBarRightSideDiffBarCount=l);var u=-a+Math.min(s,a);this._lastBarRightSideDiffBarCount<u&&(this._lastBarRightSideDiffBarCount=u);var h=Math.round(this._lastBarRightSideDiffBarCount+a+.5),c=h;h>a&&(h=a);var v=Math.round(h-n)-1;v<0&&(v=0);var d=this._lastBarRightSideDiffBarCount>0?Math.round(a+this._lastBarRightSideDiffBarCount-n)-1:v;this._visibleRange={from:v,to:h,realFrom:d,realTo:c},this.executeAction(bt.OnVisibleRangeChange,this._visibleRange),this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}];for(var f=d;f<c;f++){var g=this._dataList[f],p=this.dataIndexToCoordinate(f);this._visibleRangeDataList.push({dataIndex:f,x:p,data:g}),S(g)&&(this._visibleRangeHighLowPrice[0].price<g.high&&(this._visibleRangeHighLowPrice[0].price=g.high,this._visibleRangeHighLowPrice[0].x=p),this._visibleRangeHighLowPrice[1].price>g.low&&(this._visibleRangeHighLowPrice[1].price=g.low,this._visibleRangeHighLowPrice[1].x=p))}if((this._cacheVisibleRange.from!==this._visibleRange.from||this._cacheVisibleRange.to!==this._visibleRange.to)&&(this._cacheVisibleRange=k({},this._visibleRange),this._adjustVisibleRangeTimeTickList()),!this._loading&&S(this._loadMoreDataCallback)){var m=null;v===0?this._loadDataMore.forward&&(this._loading=!0,m={type:st.Forward,data:(t=this._dataList[0])!==null&&t!==void 0?t:null,callback:function(_,y){e.addData(_,st.Forward,{forward:y??!1,backward:y??!1})}}):h===a&&this._loadDataMore.backward&&(this._loading=!0,m={type:st.Backward,data:(r=this._dataList[a-1])!==null&&r!==void 0?r:null,callback:function(_,y){e.addData(_,st.Backward,{forward:y??!1,backward:y??!1})}}),S(m)&&this._loadMoreDataCallback(m)}},i.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}},i.prototype.setBarSpace=function(e,t){e<xr.MIN||e>xr.MAX||this._barSpace===e||(this._barSpace=e,this._calcOptimalBarSpace(),t==null||t(),this._adjustVisibleRange(),this.setCrosshair(this._crosshair,!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}))},i.prototype.setTotalBarSpace=function(e){this._totalBarSpace!==e&&(this._totalBarSpace=e,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,!0))},i.prototype.setOffsetRightDistance=function(e,t){return this._offsetRightDistance=this._scrollLimitRole===1?Math.min(this._maxOffsetDistance.right,e):e,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,(t??!1)&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})),this},i.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},i.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},i.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},i.prototype.setLastBarRightSideDiffBarCount=function(e){this._lastBarRightSideDiffBarCount=e},i.prototype.setMaxOffsetLeftDistance=function(e){this._scrollLimitRole=1,this._maxOffsetDistance.left=e},i.prototype.setMaxOffsetRightDistance=function(e){this._scrollLimitRole=1,this._maxOffsetDistance.right=e},i.prototype.setLeftMinVisibleBarCount=function(e){this._scrollLimitRole=0,this._minVisibleBarCount.left=e},i.prototype.setRightMinVisibleBarCount=function(e){this._scrollLimitRole=0,this._minVisibleBarCount.right=e},i.prototype.getVisibleRange=function(){return this._visibleRange},i.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},i.prototype.scroll=function(e){if(this._scrollEnabled){var t=e/this._barSpace,r=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-t,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0});var a=Math.round(r-this._lastBarRightSideDiffBarCount*this._barSpace);a!==0&&this.executeAction(bt.OnScroll,{distance:a})}},i.prototype.getDataByDataIndex=function(e){var t;return(t=this._dataList[e])!==null&&t!==void 0?t:null},i.prototype.coordinateToFloatIndex=function(e){var t=this._dataList.length,r=(this._totalBarSpace-e)/this._barSpace,a=t+this._lastBarRightSideDiffBarCount-r;return Math.round(a*1e6)/1e6},i.prototype.dataIndexToTimestamp=function(e){var t,r=this.getDataByDataIndex(e);return(t=r==null?void 0:r.timestamp)!==null&&t!==void 0?t:null},i.prototype.timestampToDataIndex=function(e){return this._dataList.length===0?0:Ke(this._dataList,"timestamp",e)},i.prototype.dataIndexToCoordinate=function(e){var t=this._dataList.length,r=t+this._lastBarRightSideDiffBarCount-e;return Math.floor(this._totalBarSpace-(r-.5)*this._barSpace+.5)},i.prototype.coordinateToDataIndex=function(e){return Math.ceil(this.coordinateToFloatIndex(e))-1},i.prototype.zoom=function(e,t){var r=this,a;if(this._zoomEnabled){var n=t??null;F(n==null?void 0:n.x)||(n={x:(a=this._crosshair.x)!==null&&a!==void 0?a:this._totalBarSpace/2});var o=n.x,s=this.coordinateToFloatIndex(o),l=this._barSpace,u=this._barSpace+e*(this._barSpace/Je);this.setBarSpace(u,function(){r._lastBarRightSideDiffBarCount+=s-r.coordinateToFloatIndex(o)});var h=this._barSpace/l;h!==1&&this.executeAction(bt.OnZoom,{scale:h})}},i.prototype.setZoomEnabled=function(e){this._zoomEnabled=e},i.prototype.isZoomEnabled=function(){return this._zoomEnabled},i.prototype.setScrollEnabled=function(e){this._scrollEnabled=e},i.prototype.isScrollEnabled=function(){return this._scrollEnabled},i.prototype.setCrosshair=function(e,t){var r=e??{},a=0,n=0;F(r.x)?(a=this.coordinateToDataIndex(r.x),a<0?n=0:a>this._dataList.length-1?n=this._dataList.length-1:n=a):(a=this._dataList.length-1,n=a);var o=this._dataList[n],s=this.dataIndexToCoordinate(a),l={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair=k(k({},r),{realX:s,kLineData:o,realDataIndex:a,dataIndex:n}),(l.x!==r.x||l.y!==r.y||l.paneId!==r.paneId)&&(S(o)&&this._chart.crosshairChange(this._crosshair),(t??!1)||this._chart.updatePane(1))},i.prototype.getCrosshair=function(){return this._crosshair},i.prototype.setActiveTooltipIcon=function(e){this._activeTooltipIcon=e??null},i.prototype.getActiveTooltipIcon=function(){return this._activeTooltipIcon},i.prototype.executeAction=function(e,t){var r;(r=this._actions.get(e))===null||r===void 0||r.execute(t)},i.prototype.subscribeAction=function(e,t){var r;this._actions.has(e)||this._actions.set(e,new aa),(r=this._actions.get(e))===null||r===void 0||r.subscribe(t)},i.prototype.unsubscribeAction=function(e,t){var r=this._actions.get(e);S(r)&&(r.unsubscribe(t),r.isEmpty()&&this._actions.delete(e))},i.prototype.hasAction=function(e){var t=this._actions.get(e);return S(t)&&!t.isEmpty()},i.prototype._sortIndicators=function(e){var t;G(e)?(t=this._indicators.get(e))===null||t===void 0||t.sort(function(r,a){return r.zLevel-a.zLevel}):this._indicators.forEach(function(r){r.sort(function(a,n){return a.zLevel-n.zLevel})})},i.prototype._addIndicatorCalcTask=function(e,t,r){var a=this;this._taskScheduler.addTask({id:yr(e,t.name),handler:function(){var n;(n=t.onDataStateChange)===null||n===void 0||n.call(t,{state:ce.Loading,type:r,indicator:t}),t.calcImp(a._dataList).then(function(o){var s;o&&(a._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),(s=t.onDataStateChange)===null||s===void 0||s.call(t,{state:ce.Ready,type:r,indicator:t}))}).catch(function(){var o;(o=t.onDataStateChange)===null||o===void 0||o.call(t,{state:ce.Error,type:r,indicator:t})})}})},i.prototype.addIndicator=function(e,t,r){var a=e.name,n=this._indicators.get(t);if(S(n)&&S(n.find(function(l){return l.name===a})))return!1;S(n)||(n=[]);var o=Vr(a),s=new o;return this._synchronizeIndicatorSeriesPrecision(s),s.override(e),r||(this.removeIndicator({paneId:t}),n=[]),n.push(s),this._indicators.set(t,n),this._sortIndicators(t),this._addIndicatorCalcTask(t,s,st.Init),!0},i.prototype.getIndicatorsByPaneId=function(e){var t;return(t=this._indicators.get(e))!==null&&t!==void 0?t:[]},i.prototype.getIndicatorsByFilter=function(e){var t=function(s,l){return s.filter(function(u){return!S(l)||u.name===l})},r=e.paneId,a=e.name,n=new Map;if(S(r)){var o=this.getIndicatorsByPaneId(r);n.set(r,t(o,a))}else S(a)?this._indicators.forEach(function(s,l){n.set(l,t(s,a))}):this._indicators.forEach(function(s,l){n.set(l,t(s))});return n},i.prototype.removeIndicator=function(e){var t=this,r=!1,a=this.getIndicatorsByFilter(e);return a.forEach(function(n,o){var s=t.getIndicatorsByPaneId(o);n.forEach(function(l){var u=s.findIndex(function(h){return h.name===l.name});u>-1&&(t._taskScheduler.removeTask(yr(o,l.name)),s.splice(u,1),r=!0)}),s.length===0&&t._indicators.delete(o)}),r},i.prototype.hasIndicators=function(e){return this._indicators.has(e)},i.prototype._synchronizeIndicatorSeriesPrecision=function(e){var t=this._precision,r=t.price,a=t.volume,n=function(o){switch(o.series){case vt.Price:{o.setSeriesPrecision(r);break}case vt.Volume:{o.setSeriesPrecision(a);break}}};S(e)?n(e):this._indicators.forEach(function(o){o.forEach(function(s){n(s)})})},i.prototype.overrideIndicator=function(e,t){var r=this,a=e.name,n=new Map;if(S(t)){var o=this._indicators.get(t);S(o)&&n.set(t,o)}else n=this._indicators;var s=!1,l=!1;return n.forEach(function(u,h){var c=u.find(function(p){return p.name===a});if(S(c)){c.override(e);var v=c.shouldUpdateImp(),d=v.calc,f=v.draw,g=v.sort;g&&(l=!0),d?r._addIndicatorCalcTask(h,c,st.Update):f&&(s=!0)}}),l&&this._sortIndicators(),s?(this._chart.layout({update:!0}),!0):!1},i.prototype.getOverlaysByFilter=function(e){var t,r,a=e.id,n=e.groupId,o=e.paneId,s=e.name,l=function(d){return d.filter(function(f){return S(a)?f.id===a:S(n)?f.groupId===n&&(!S(s)||f.name===s):!S(s)||f.name===s})},u=new Map;if(S(o)){var h=this.getOverlaysByPaneId(o);u.set(o,l(h))}else this._overlays.forEach(function(d,f){u.set(f,l(d))});var c=(t=this._progressOverlayInfo)===null||t===void 0?void 0:t.overlay;if(S(c)){var v=(r=u.get(c.paneId))!==null&&r!==void 0?r:[];v.push(c),u.set(c.paneId,v)}return u},i.prototype.getOverlaysByPaneId=function(e){var t;if(!G(e)){var r=[];return this._overlays.forEach(function(a){r=r.concat(a)}),r}return(t=this._overlays.get(e))!==null&&t!==void 0?t:[]},i.prototype._sortOverlays=function(e){var t;G(e)?(t=this._overlays.get(e))===null||t===void 0||t.sort(function(r,a){return r.zLevel-a.zLevel}):this._overlays.forEach(function(r){r.sort(function(a,n){return a.zLevel-n.zLevel})})},i.prototype.addOverlays=function(e,t){var r=this,a=[],n=e.map(function(o,s){var l,u,h,c,v,d;if(S(o.id)){var f=null;try{for(var g=lt(r._overlays),p=g.next();!p.done;p=g.next()){var m=Bt(p.value,2),_=m[1],y=_.find(function(w){return w.id===o.id});if(S(y)){f=y;break}}}catch(w){l={error:w}}finally{try{p&&!p.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}if(S(f))return o.id}var b=hn(o.name);if(S(b)){var x=(h=o.id)!==null&&h!==void 0?h:Br(sa),y=new b;o.id=x,(c=o.groupId)!==null&&c!==void 0||(o.groupId=x),y.override(o);var C=y.paneId;return a.includes(C)||a.push(C),y.isDrawing()?r._progressOverlayInfo={paneId:C,overlay:y,appointPaneFlag:t[s]}:(r._overlays.has(C)||r._overlays.set(C,[]),(v=r._overlays.get(C))===null||v===void 0||v.push(y)),y.isStart()&&((d=y.onDrawStart)===null||d===void 0||d.call(y,{overlay:y,chart:r._chart})),x}return null});return a.length>0&&(this._sortOverlays(),a.forEach(function(o){r._chart.updatePane(1,o)}),this._chart.updatePane(1,O.X_AXIS)),n},i.prototype.getProgressOverlayInfo=function(){return this._progressOverlayInfo},i.prototype.progressOverlayComplete=function(){var e;if(this._progressOverlayInfo!==null){var t=this._progressOverlayInfo,r=t.overlay,a=t.paneId;r.isDrawing()||(this._overlays.has(a)||this._overlays.set(a,[]),(e=this._overlays.get(a))===null||e===void 0||e.push(r),this._sortOverlays(a),this._progressOverlayInfo=null)}},i.prototype.updateProgressOverlayInfo=function(e,t){this._progressOverlayInfo!==null&&(Ne(t)&&t&&(this._progressOverlayInfo.appointPaneFlag=t),this._progressOverlayInfo.paneId=e,this._progressOverlayInfo.overlay.override({paneId:e}))},i.prototype.overrideOverlay=function(e){var t=this,r=!1,a=[],n=this.getOverlaysByFilter(e);return n.forEach(function(o,s){o.forEach(function(l){l.override(e);var u=l.shouldUpdate(),h=u.sort,c=u.draw;h&&(r=!0),(h||c)&&(a.includes(s)||a.push(s))})}),r&&this._sortOverlays(),a.length>0?(a.forEach(function(o){t._chart.updatePane(1,o)}),this._chart.updatePane(1,O.X_AXIS),!0):!1},i.prototype.removeOverlay=function(e){var t=this,r=[],a=this.getOverlaysByFilter(e);return a.forEach(function(n,o){var s=t.getOverlaysByPaneId(o);n.forEach(function(l){var u;if((u=l.onRemoved)===null||u===void 0||u.call(l,{overlay:l,chart:t._chart}),r.includes(o)||r.push(o),l.isDrawing())t._progressOverlayInfo=null;else{var h=s.findIndex(function(c){return c.id===l.id});h>-1&&s.splice(h,1)}s.length===0&&t._overlays.delete(o)})}),r.length>0?(r.forEach(function(n){t._chart.updatePane(1,n)}),this._chart.updatePane(1,O.X_AXIS),!0):!1},i.prototype.setPressedOverlayInfo=function(e){this._pressedOverlayInfo=e},i.prototype.getPressedOverlayInfo=function(){return this._pressedOverlayInfo},i.prototype.setHoverOverlayInfo=function(e,t){var r=this._hoverOverlayInfo,a=r.overlay,n=r.figureType,o=r.figureKey,s=r.figureIndex,l=e.overlay;if(((a==null?void 0:a.id)!==(l==null?void 0:l.id)||n!==e.figureType||s!==e.figureIndex)&&(this._hoverOverlayInfo=e,(a==null?void 0:a.id)!==(l==null?void 0:l.id))){var u=!1,h=!1;a!==null&&(h=!0,at(a.onMouseLeave)&&(a.onMouseLeave(k({chart:this._chart,overlay:a,figureKey:o,figureIndex:s},t)),u=!0)),l!==null&&(h=!0,at(l.onMouseEnter)&&(l.onMouseEnter(k({chart:this._chart,overlay:l,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),u=!0)),h&&this._sortOverlays(),u||this._chart.updatePane(1)}},i.prototype.getHoverOverlayInfo=function(){return this._hoverOverlayInfo},i.prototype.setClickOverlayInfo=function(e,t){var r,a,n,o,s=this._clickOverlayInfo,l=s.paneId,u=s.overlay,h=s.figureType,c=s.figureKey,v=s.figureIndex,d=e.overlay;(r=d==null?void 0:d.isDrawing())!==null&&r!==void 0&&r||(a=d==null?void 0:d.onClick)===null||a===void 0||a.call(d,k({chart:this._chart,overlay:d,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),((u==null?void 0:u.id)!==(d==null?void 0:d.id)||h!==e.figureType||v!==e.figureIndex)&&(this._clickOverlayInfo=e,(u==null?void 0:u.id)!==(d==null?void 0:d.id)&&((n=u==null?void 0:u.onDeselected)===null||n===void 0||n.call(u,k({chart:this._chart,overlay:u,figureKey:c,figureIndex:v},t)),(o=d==null?void 0:d.onSelected)===null||o===void 0||o.call(d,k({chart:this._chart,overlay:d,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),this._chart.updatePane(1,e.paneId),l!==e.paneId&&this._chart.updatePane(1,l),this._chart.updatePane(1,O.X_AXIS)))},i.prototype.getClickOverlayInfo=function(){return this._clickOverlayInfo},i.prototype.isOverlayEmpty=function(){return this._overlays.size===0&&this._progressOverlayInfo===null},i.prototype.isOverlayDrawing=function(){var e,t;return(t=(e=this._progressOverlayInfo)===null||e===void 0?void 0:e.overlay.isDrawing())!==null&&t!==void 0?t:!1},i.prototype.clearData=function(){this._loadDataMore.backward=!1,this._loadDataMore.forward=!1,this._loading=!0,this._dataList=[],this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._visibleRange=Se(),this._cacheVisibleRange=Se(),this._timeTicks.clear(),this._crosshair={},this._activeTooltipIcon=null},i.prototype.getChart=function(){return this._chart},i}(),N={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},ve=7;function yn(){return Rr(this,void 0,void 0,function(){return Fr(this,function(i){switch(i.label){case 0:return[4,new Promise(function(e){var t=new ResizeObserver(function(r){e(r.every(function(a){return"devicePixelContentBoxSize"in a})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})];case 1:return[2,i.sent()]}})})}var Cr=function(){function i(e,t){var r=this;this._supportedDevicePixelContentBox=!1,this._width=0,this._height=0,this._pixelWidth=0,this._pixelHeight=0,this._nextPixelWidth=0,this._nextPixelHeight=0,this._requestAnimationId=ie,this._mediaQueryListener=function(){var a=zt(r._element);r._nextPixelWidth=Math.round(r._element.clientWidth*a),r._nextPixelHeight=Math.round(r._element.clientHeight*a),r._resetPixelRatio()},this._listener=t,this._element=Ot("canvas",e),this._ctx=this._element.getContext("2d"),yn().then(function(a){r._supportedDevicePixelContentBox=a,a?(r._resizeObserver=new ResizeObserver(function(n){var o=n.find(function(l){return l.target===r._element}),s=o==null?void 0:o.devicePixelContentBoxSize[0];S(s)&&(r._nextPixelWidth=s.inlineSize,r._nextPixelHeight=s.blockSize,(r._pixelWidth!==r._nextPixelWidth||r._pixelHeight!==r._nextPixelHeight)&&r._resetPixelRatio())}),r._resizeObserver.observe(r._element,{box:"device-pixel-content-box"})):(r._mediaQueryList=window.matchMedia("(resolution: ".concat(zt(r._element),"dppx)")),r._mediaQueryList.addListener(r._mediaQueryListener))}).catch(function(a){return!1})}return i.prototype._resetPixelRatio=function(){var e=this;this._executeListener(function(){var t=e._element.clientWidth,r=e._element.clientHeight;e._width=t,e._height=r,e._pixelWidth=e._nextPixelWidth,e._pixelHeight=e._nextPixelHeight,e._element.width=e._nextPixelWidth,e._element.height=e._nextPixelHeight;var a=e._nextPixelWidth/t,n=e._nextPixelHeight/r;e._ctx.scale(a,n)})},i.prototype._executeListener=function(e){var t=this;this._requestAnimationId===ie&&(this._requestAnimationId=Be(function(){t._ctx.clearRect(0,0,t._width,t._height),e==null||e(),t._listener(),t._requestAnimationId=ie}))},i.prototype.update=function(e,t){if(this._width!==e||this._height!==t){if(this._element.style.width="".concat(e,"px"),this._element.style.height="".concat(t,"px"),!this._supportedDevicePixelContentBox){var r=zt(this._element);this._nextPixelWidth=Math.round(e*r),this._nextPixelHeight=Math.round(t*r),this._resetPixelRatio()}}else this._executeListener()},i.prototype.getElement=function(){return this._element},i.prototype.getContext=function(){return this._ctx},i.prototype.destroy=function(){S(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),S(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)},i}(),Yr=function(i){L(e,i);function e(t,r){var a=i.call(this)||this;return a._bounding=Fe(),a._pane=r,a._rootContainer=t,a._container=a.createContainer(),t.appendChild(a._container),a}return e.prototype.setBounding=function(t){return Z(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(this._container,this._bounding,t??3)},e.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},e}(er),ir=function(i){L(e,i);function e(t,r){var a=i.call(this,t,r)||this;a._mainCanvas=new Cr({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){a.updateMain(a._mainCanvas.getContext())}),a._overlayCanvas=new Cr({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){a.updateOverlay(a._overlayCanvas.getContext())});var n=a.getContainer();return n.appendChild(a._mainCanvas.getElement()),n.appendChild(a._overlayCanvas.getElement()),a}return e.prototype.createContainer=function(){return Ot("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},e.prototype.updateImp=function(t,r,a){var n=r.width,o=r.height,s=r.left;t.style.left="".concat(s,"px");var l=a,u=t.clientWidth,h=t.clientHeight;switch((n!==u||o!==h)&&(t.style.width="".concat(n,"px"),t.style.height="".concat(o,"px"),l=3),l){case 0:{this._mainCanvas.update(n,o);break}case 1:{this._overlayCanvas.update(n,o);break}case 3:case 4:{this._mainCanvas.update(n,o),this._overlayCanvas.update(n,o);break}}},e.prototype.destroy=function(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()},e.prototype.getImage=function(t){var r=this.getBounding(),a=r.width,n=r.height,o=Ot("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),l=zt(o);return o.width=a*l,o.height=n*l,s.scale(l,l),s.drawImage(this._mainCanvas.getElement(),0,0,a,n),t&&s.drawImage(this._overlayCanvas.getElement(),0,0,a,n),o},e}(Yr);function ne(i){return i==="transparent"||i==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(i)||/^[hH][Ss][Ll][Aa]\(([\s]*(3603[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(i)}function bn(i,e){var t,r,a=[];a=a.concat(e);try{for(var n=lt(a),o=n.next();!o.done;o=n.next()){var s=o.value,l=s.x,u=s.y,h=s.r,c=i.x-l,v=i.y-u;if(!(c*c+v*v>h*h))return!0}}catch(d){t={error:d}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1}function xn(i,e,t){var r=[];r=r.concat(e);var a=t.style,n=a===void 0?X.Fill:a,o=t.color,s=o===void 0?"currentColor":o,l=t.borderSize,u=l===void 0?1:l,h=t.borderColor,c=h===void 0?"currentColor":h,v=t.borderStyle,d=v===void 0?Y.Solid:v,f=t.borderDashedValue,g=f===void 0?[2,2]:f,p=(n===X.Fill||t.style===X.StrokeFill)&&(!G(s)||!ne(s));p&&(i.fillStyle=s,r.forEach(function(m){var _=m.x,y=m.y,b=m.r;i.beginPath(),i.arc(_,y,b,0,Math.PI*2),i.closePath(),i.fill()})),(n===X.Stroke||t.style===X.StrokeFill)&&u>0&&!ne(c)&&(i.strokeStyle=c,i.lineWidth=u,d===Y.Dashed?i.setLineDash(g):i.setLineDash([]),r.forEach(function(m){var _=m.x,y=m.y,b=m.r;(!p||b>u)&&(i.beginPath(),i.arc(_,y,b,0,Math.PI*2),i.closePath(),i.stroke())}))}var Cn={name:"circle",checkEventOn:bn,draw:function(i,e,t){xn(i,e,t)}};function wn(i,e){var t,r,a=[];a=a.concat(e);try{for(var n=lt(a),o=n.next();!o.done;o=n.next()){for(var s=o.value,l=!1,u=s.coordinates,h=0,c=u.length-1;h<u.length;c=h++)u[h].y>i.y!=u[c].y>i.y&&i.x<(u[c].x-u[h].x)*(i.y-u[h].y)/(u[c].y-u[h].y)+u[h].x&&(l=!l);if(l)return!0}}catch(v){t={error:v}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1}function Sn(i,e,t){var r=[];r=r.concat(e);var a=t.style,n=a===void 0?X.Fill:a,o=t.color,s=o===void 0?"currentColor":o,l=t.borderSize,u=l===void 0?1:l,h=t.borderColor,c=h===void 0?"currentColor":h,v=t.borderStyle,d=v===void 0?Y.Solid:v,f=t.borderDashedValue,g=f===void 0?[2,2]:f;(n===X.Fill||t.style===X.StrokeFill)&&(!G(s)||!ne(s))&&(i.fillStyle=s,r.forEach(function(p){var m=p.coordinates;i.beginPath(),i.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)i.lineTo(m[_].x,m[_].y);i.closePath(),i.fill()})),(n===X.Stroke||t.style===X.StrokeFill)&&u>0&&!ne(c)&&(i.strokeStyle=c,i.lineWidth=u,d===Y.Dashed?i.setLineDash(g):i.setLineDash([]),r.forEach(function(p){var m=p.coordinates;i.beginPath(),i.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)i.lineTo(m[_].x,m[_].y);i.closePath(),i.stroke()}))}var In={name:"polygon",checkEventOn:wn,draw:function(i,e,t){Sn(i,e,t)}};function En(i,e){var t,r,a=[];a=a.concat(e);try{for(var n=lt(a),o=n.next();!o.done;o=n.next()){var s=o.value,l=s.x,u=s.width;u<q*2&&(l-=q,u=q*2);var h=s.y,c=s.height;if(c<q*2&&(h-=q,c=q*2),i.x>=l&&i.x<=l+u&&i.y>=h&&i.y<=h+c)return!0}}catch(v){t={error:v}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1}function Gr(i,e,t){var r,a=[];a=a.concat(e);var n=t.style,o=n===void 0?X.Fill:n,s=t.color,l=s===void 0?"transparent":s,u=t.borderSize,h=u===void 0?1:u,c=t.borderColor,v=c===void 0?"transparent":c,d=t.borderStyle,f=d===void 0?Y.Solid:d,g=t.borderRadius,p=g===void 0?0:g,m=t.borderDashedValue,_=m===void 0?[2,2]:m,y=(r=i.roundRect)!==null&&r!==void 0?r:i.rect,b=(o===X.Fill||t.style===X.StrokeFill)&&(!G(l)||!ne(l));if(b&&(i.fillStyle=l,a.forEach(function(w){var E=w.x,I=w.y,P=w.width,T=w.height;i.beginPath(),y.call(i,E,I,P,T,p),i.closePath(),i.fill()})),(o===X.Stroke||t.style===X.StrokeFill)&&h>0&&!ne(v)){i.strokeStyle=v,i.fillStyle=v,i.lineWidth=h,f===Y.Dashed?i.setLineDash(_):i.setLineDash([]);var x=h%2===1?.5:0,C=Math.round(x*2);a.forEach(function(w){var E=w.x,I=w.y,P=w.width,T=w.height;P>h*2&&T>h*2?(i.beginPath(),y.call(i,E+x,I+x,P-C,T-C,p),i.closePath(),i.stroke()):b||i.fillRect(E,I,P,T)})}}var Tn={name:"rect",checkEventOn:En,draw:function(i,e,t){Gr(i,e,t)}};function Ur(i,e){var t=e.size,r=t===void 0?12:t,a=e.paddingLeft,n=a===void 0?0:a,o=e.paddingTop,s=o===void 0?0:o,l=e.paddingRight,u=l===void 0?0:l,h=e.paddingBottom,c=h===void 0?0:h,v=e.weight,d=v===void 0?"normal":v,f=e.family,g=i.x,p=i.y,m=i.text,_=i.align,y=_===void 0?"left":_,b=i.baseline,x=b===void 0?"top":b,C=i.width,w=i.height,E=C??n+Re(m,r,d,f)+u,I=w??s+r+c,P=0;switch(y){case"left":case"start":{P=g;break}case"right":case"end":{P=g-E;break}default:{P=g-E/2;break}}var T=0;switch(x){case"top":case"hanging":{T=p;break}case"bottom":case"ideographic":case"alphabetic":{T=p-I;break}default:{T=p-I/2;break}}return{x:P,y:T,width:E,height:I}}function Pn(i,e,t){var r,a,n=[];n=n.concat(e);try{for(var o=lt(n),s=o.next();!s.done;s=o.next()){var l=s.value,u=Ur(l,t),h=u.x,c=u.y,v=u.width,d=u.height;if(i.x>=h&&i.x<=h+v&&i.y>=c&&i.y<=c+d)return!0}}catch(f){r={error:f}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}return!1}function Mn(i,e,t){var r=[];r=r.concat(e);var a=t.color,n=a===void 0?"currentColor":a,o=t.size,s=o===void 0?12:o,l=t.family,u=t.weight,h=t.paddingLeft,c=h===void 0?0:h,v=t.paddingTop,d=v===void 0?0:v,f=t.paddingRight,g=f===void 0?0:f,p=r.map(function(m){return Ur(m,t)});Gr(i,p,k(k({},t),{color:t.backgroundColor})),i.textAlign="left",i.textBaseline="top",i.font=jt(s,u,l),i.fillStyle=n,r.forEach(function(m,_){var y=p[_];i.fillText(m.text,y.x+c,y.y+d,y.width-c-g)})}var An={name:"text",checkEventOn:Pn,draw:function(i,e,t){Mn(i,e,t)}};function kn(i,e){var t=i.x-e.x,r=i.y-e.y;return Math.sqrt(t*t+r*r)}function Dn(i,e){var t,r,a=[];a=a.concat(e);try{for(var n=lt(a),o=n.next();!o.done;o=n.next()){var s=o.value;if(Math.abs(kn(i,s)-s.r)<q){var l=s.r,u=s.startAngle,h=s.endAngle,c=l*Math.cos(u)+s.x,v=l*Math.sin(u)+s.y,d=l*Math.cos(h)+s.x,f=l*Math.sin(h)+s.y;if(i.x<=Math.max(c,d)+q&&i.x>=Math.min(c,d)-q&&i.y<=Math.max(v,f)+q&&i.y>=Math.min(v,f)-q)return!0}}}catch(g){t={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1}function Rn(i,e,t){var r=[];r=r.concat(e);var a=t.style,n=a===void 0?Y.Solid:a,o=t.size,s=o===void 0?1:o,l=t.color,u=l===void 0?"currentColor":l,h=t.dashedValue,c=h===void 0?[2,2]:h;i.lineWidth=s,i.strokeStyle=u,n===Y.Dashed?i.setLineDash(c):i.setLineDash([]),r.forEach(function(v){var d=v.x,f=v.y,g=v.r,p=v.startAngle,m=v.endAngle;i.beginPath(),i.arc(d,f,g,p,m),i.stroke(),i.closePath()})}var Fn={name:"arc",checkEventOn:Dn,draw:function(i,e,t){Rn(i,e,t)}},Zr={},Bn=[Cn,ja,In,Tn,An,Fn];Bn.forEach(function(i){Zr[i.name]=Ua.extend(i)});function On(i){var e;return(e=Zr[i])!==null&&e!==void 0?e:null}var xt=function(i){L(e,i);function e(t){var r=i.call(this)||this;return r._widget=t,r}return e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,r){var a=On(t.name);if(a!==null){var n=new a(t);if(S(r)){for(var o in r)r.hasOwnProperty(o)&&n.registerEvent(o,r[o]);this.addChild(n)}return n}return null},e.prototype.draw=function(t){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];this.clear(),this.drawImp(t,r)},e}(er),Ln=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r,a,n=this.getWidget(),o=this.getWidget().getPane(),s=o.getChart(),l=n.getBounding(),u=s.getStyles().grid,h=u.show;if(h){t.save(),t.globalCompositeOperation="destination-over";var c=u.horizontal,v=c.show;if(v){var d=o.getAxisComponent(),f=d.getTicks().map(function(_){return{coordinates:[{x:0,y:_.coord},{x:l.width,y:_.coord}]}});(r=this.createFigure({name:"line",attrs:f,styles:c}))===null||r===void 0||r.draw(t)}var g=u.vertical,p=g.show;if(p){var m=s.getXAxisPane().getAxisComponent(),f=m.getTicks().map(function(y){return{coordinates:[{x:y.coord,y:0},{x:y.coord,y:l.height}]}});(a=this.createFigure({name:"line",attrs:f,styles:g}))===null||a===void 0||a.draw(t)}t.restore()}},e}(xt),$r=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.eachChildren=function(t){for(var r=this.getWidget().getPane(),a=r.getChart().getChartStore(),n=a.getVisibleRangeDataList(),o=a.getBarSpace(),s=n.length,l=0;l<s;)t(n[l],o,l),++l},e}(xt),jr=function(i){L(e,i);function e(){var t=i.apply(this,fe([],Bt(arguments),!1))||this;return t._boundCandleBarClickEvent=function(r){return function(){return t.getWidget().getPane().getChart().executeAction(bt.OnCandleBarClick,r),!1}},t}return e.prototype.drawImp=function(t){var r=this,a=this.getWidget().getPane(),n=a.getId()===O.CANDLE,o=a.getChart().getChartStore(),s=this.getCandleBarOptions();if(s!==null){var l=0,u=0;if(s.type===gt.Ohlc){var h=o.getBarSpace().gapBar;l=Math.min(Math.max(Math.round(h*.2),1),8),l>2&&l%2===1&&l--,u=Math.floor(u/2)}var c=a.getAxisComponent();this.eachChildren(function(v,d){var f=v.data,g=v.x;if(S(f)){var p=f.open,m=f.high,_=f.low,y=f.close,b=s.type,x=s.styles,C=[];y>p?(C[0]=x.upColor,C[1]=x.upBorderColor,C[2]=x.upWickColor):y<p?(C[0]=x.downColor,C[1]=x.downBorderColor,C[2]=x.downWickColor):(C[0]=x.noChangeColor,C[1]=x.noChangeBorderColor,C[2]=x.noChangeWickColor);var w=c.convertToPixel(p),E=c.convertToPixel(y),I=[w,E,c.convertToPixel(m),c.convertToPixel(_)];I.sort(function(D,A){return D-A});var P=d.gapBar%2===0?1:0,T=[];switch(b){case gt.CandleSolid:{T=r._createSolidBar(g,I,d,C,P);break}case gt.CandleStroke:{T=r._createStrokeBar(g,I,d,C,P);break}case gt.CandleUpStroke:{y>p?T=r._createStrokeBar(g,I,d,C,P):T=r._createSolidBar(g,I,d,C,P);break}case gt.CandleDownStroke:{p>y?T=r._createStrokeBar(g,I,d,C,P):T=r._createSolidBar(g,I,d,C,P);break}case gt.Ohlc:{T=[{name:"rect",attrs:[{x:g-u,y:I[0],width:l,height:I[3]-I[0]},{x:g-d.halfGapBar,y:w+l>I[3]?I[3]-l:w,width:d.halfGapBar,height:l},{x:g+u,y:E+l>I[3]?I[3]-l:E,width:d.halfGapBar-u,height:l}],styles:{color:C[0]}}];break}}T.forEach(function(D){var A,M=null;n&&(M={mouseClickEvent:r._boundCandleBarClickEvent(v)}),(A=r.createFigure(D,M??void 0))===null||A===void 0||A.draw(t)})}})}},e.prototype.getCandleBarOptions=function(){var t=this.getWidget().getPane().getChart().getStyles().candle;return{type:t.type,styles:t.bar}},e.prototype._createSolidBar=function(t,r,a,n,o){return[{name:"rect",attrs:{x:t,y:r[0],width:1,height:r[3]-r[0]},styles:{color:n[2]}},{name:"rect",attrs:{x:t-a.halfGapBar,y:r[1],width:a.gapBar+o,height:Math.max(1,r[2]-r[1])},styles:{style:X.StrokeFill,color:n[0],borderColor:n[1]}}]},e.prototype._createStrokeBar=function(t,r,a,n,o){return[{name:"rect",attrs:[{x:t,y:r[0],width:1,height:r[1]-r[0]},{x:t,y:r[2],width:1,height:r[3]-r[2]}],styles:{color:n[2]}},{name:"rect",attrs:{x:t-a.halfGapBar,y:r[1],width:a.gapBar+o,height:Math.max(1,r[2]-r[1])},styles:{style:X.Stroke,borderColor:n[1]}}]},e}($r),Vn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.getCandleBarOptions=function(){var t,r,a=this.getWidget().getPane(),n=a.getAxisComponent();if(!n.isInCandle()){var o=a.getChart().getChartStore(),s=o.getIndicatorsByPaneId(a.getId());try{for(var l=lt(s),u=l.next();!u.done;u=l.next()){var h=u.value;if(h.shouldOhlc&&h.visible){var c=h.styles,v=o.getStyles().indicator,d=J(c,"ohlc.upColor",v.ohlc.upColor),f=J(c,"ohlc.downColor",v.ohlc.downColor),g=J(c,"ohlc.noChangeColor",v.ohlc.noChangeColor);return{type:gt.Ohlc,styles:{upColor:d,downColor:f,noChangeColor:g,upBorderColor:d,downBorderColor:f,noChangeBorderColor:g,upWickColor:d,downWickColor:f,noChangeWickColor:g}}}}}catch(p){t={error:p}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}}return null},e.prototype.drawImp=function(t){var r=this;i.prototype.drawImp.call(this,t);var a=this.getWidget(),n=a.getPane(),o=n.getChart(),s=a.getBounding(),l=o.getXAxisPane().getAxisComponent(),u=n.getAxisComponent(),h=o.getChartStore(),c=h.getIndicatorsByPaneId(n.getId()),v=h.getStyles().indicator;t.save(),c.forEach(function(d){if(d.visible){d.zLevel<0?t.globalCompositeOperation="destination-over":t.globalCompositeOperation="source-over";var f=!1;if(d.draw!==null&&(t.save(),f=d.draw({ctx:t,chart:o,indicator:d,bounding:s,xAxis:l,yAxis:u}),t.restore()),!f){var g=d.result,p=[];r.eachChildren(function(m,_){var y,b,x,C=_.halfGapBar,w=m.dataIndex,E=m.x,I=l.convertToPixel(w-1),P=l.convertToPixel(w+1),T=(y=g[w-1])!==null&&y!==void 0?y:null,D=(b=g[w])!==null&&b!==void 0?b:null,A=(x=g[w+1])!==null&&x!==void 0?x:null,M={x:I},R={x:E},B={x:P};d.figures.forEach(function(z){var U=z.key,Q=T==null?void 0:T[U];F(Q)&&(M[U]=u.convertToPixel(Q));var tt=D==null?void 0:D[U];F(tt)&&(R[U]=u.convertToPixel(tt));var nt=A==null?void 0:A[U];F(nt)&&(B[U]=u.convertToPixel(nt))}),tr(d,w,v,function(z,U,Q){var tt,nt,ut;if(S(D==null?void 0:D[z.key])){var Ct=R[z.key],K=(tt=z.attrs)===null||tt===void 0?void 0:tt.call(z,{data:{prev:T,current:D,next:A},coordinate:{prev:M,current:R,next:B},bounding:s,barSpace:_,xAxis:l,yAxis:u});if(!S(K))switch(z.type){case"circle":{K={x:E,y:Ct,r:Math.max(1,C)};break}case"rect":case"bar":{var ot=(nt=z.baseValue)!==null&&nt!==void 0?nt:u.getRange().from,Xt=u.convertToPixel(ot),wt=Math.abs(Xt-Ct);ot!==(D==null?void 0:D[z.key])&&(wt=Math.max(1,wt));var ht=0;Ct>Xt?ht=Xt:ht=Ct,K={x:E-C,y:ht,width:Math.max(1,C*2),height:wt};break}case"line":{S(p[Q])||(p[Q]=[]),F(R[z.key])&&F(B[z.key])&&p[Q].push({coordinates:[{x:R.x,y:R[z.key]},{x:B.x,y:B[z.key]}],styles:U});break}}var et=z.type;S(K)&&et!=="line"&&((ut=r.createFigure({name:et==="bar"?"rect":et,attrs:K,styles:U}))===null||ut===void 0||ut.draw(t))}})}),p.forEach(function(m){var _,y,b,x;if(m.length>1){for(var C=[{coordinates:[m[0].coordinates[0],m[0].coordinates[1]],styles:m[0].styles}],w=1;w<m.length;w++){var E=C[C.length-1],I=m[w],P=E.coordinates[E.coordinates.length-1];P.x===I.coordinates[0].x&&P.y===I.coordinates[0].y&&E.styles.style===I.styles.style&&E.styles.color===I.styles.color&&E.styles.size===I.styles.size&&E.styles.smooth===I.styles.smooth&&((_=E.styles.dashedValue)===null||_===void 0?void 0:_[0])===((y=I.styles.dashedValue)===null||y===void 0?void 0:y[0])&&((b=E.styles.dashedValue)===null||b===void 0?void 0:b[1])===((x=I.styles.dashedValue)===null||x===void 0?void 0:x[1])?E.coordinates.push(I.coordinates[1]):C.push({coordinates:[I.coordinates[0],I.coordinates[1]],styles:I.styles})}C.forEach(function(T){var D,A=T.coordinates,M=T.styles;(D=r.createFigure({name:"line",attrs:{coordinates:A},styles:M}))===null||D===void 0||D.draw(t)})}})}}}),t.restore()},e}(jr),Nn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r=this.getWidget(),a=r.getPane(),n=r.getBounding(),o=r.getPane().getChart().getChartStore(),s=o.getCrosshair(),l=o.getStyles().crosshair;if(G(s.paneId)&&l.show){if(s.paneId===a.getId()){var u=s.y;this._drawLine(t,[{x:0,y:u},{x:n.width,y:u}],l.horizontal)}var h=s.realX;this._drawLine(t,[{x:h,y:0},{x:h,y:n.height}],l.vertical)}},e.prototype._drawLine=function(t,r,a){var n;if(a.show){var o=a.line;o.show&&((n=this.createFigure({name:"line",attrs:{coordinates:r},styles:o}))===null||n===void 0||n.draw(t))}},e}(xt),qr=function(i){L(e,i);function e(){var t=i.apply(this,fe([],Bt(arguments),!1))||this;return t._boundIconClickEvent=function(r){return function(){var a=t.getWidget().getPane();return a.getChart().getChartStore().executeAction(bt.OnTooltipIconClick,k({},r)),!0}},t._boundIconMouseMoveEvent=function(r){return function(){return t.getWidget().getPane().getChart().getChartStore().setActiveTooltipIcon(k({},r)),!0}},t}return e.prototype.drawImp=function(t){var r=this.getWidget(),a=r.getPane(),n=a.getChart().getChartStore(),o=n.getCrosshair();if(S(o.kLineData)){var s=r.getBounding(),l=n.getStyles().indicator.tooltip,u=l.offsetLeft,h=l.offsetTop,c=l.offsetRight;this.drawIndicatorTooltip(t,u,h,s.width-c)}},e.prototype.drawIndicatorTooltip=function(t,r,a,n){var o=this,s=this.getWidget().getPane(),l=s.getChart().getChartStore(),u=l.getStyles().indicator,h=u.tooltip;if(this.isDrawTooltip(l.getCrosshair(),h)){var c=l.getIndicatorsByPaneId(s.getId()),v=h.text;c.forEach(function(d){var f=0,g={x:r,y:a},p=o.getIndicatorTooltipData(d),m=p.name,_=p.calcParamsText,y=p.legends,b=p.icons,x=m.length>0,C=y.length>0;if(x||C){var w=Bt(o.classifyTooltipIcons(b),3),E=w[0],I=w[1],P=w[2];if(f=o.drawStandardTooltipIcons(t,E,g,d.name,r,f,n),x){var T=m;_.length>0&&(T="".concat(T).concat(_)),f=o.drawStandardTooltipLegends(t,[{title:{text:"",color:v.color},value:{text:T,color:v.color}}],g,r,f,n,v)}f=o.drawStandardTooltipIcons(t,I,g,d.name,r,f,n),C&&(f=o.drawStandardTooltipLegends(t,y,g,r,f,n,h.text)),f=o.drawStandardTooltipIcons(t,P,g,d.name,r,f,n),a=g.y+f}})}return a},e.prototype.drawStandardTooltipIcons=function(t,r,a,n,o,s,l){var u=this;if(r.length>0){var h=0,c=0;r.forEach(function(g){var p=g.marginLeft,m=p===void 0?0:p,_=g.marginTop,y=_===void 0?0:_,b=g.marginRight,x=b===void 0?0:b,C=g.marginBottom,w=C===void 0?0:C,E=g.paddingLeft,I=E===void 0?0:E,P=g.paddingTop,T=P===void 0?0:P,D=g.paddingRight,A=D===void 0?0:D,M=g.paddingBottom,R=M===void 0?0:M,B=g.size,z=g.fontFamily,U=g.icon;t.font=jt(B,"normal",z),h+=m+I+t.measureText(U).width+A+x,c=Math.max(c,y+T+B+R+w)}),a.x+h>l?(a.x=o,a.y+=s,s=c):s=Math.max(s,c);var v=this.getWidget().getPane(),d=v.getId(),f=v.getChart().getChartStore().getActiveTooltipIcon();r.forEach(function(g){var p,m=g.marginLeft,_=m===void 0?0:m,y=g.marginTop,b=y===void 0?0:y,x=g.marginRight,C=x===void 0?0:x,w=g.paddingLeft,E=w===void 0?0:w,I=g.paddingTop,P=I===void 0?0:I,T=g.paddingRight,D=T===void 0?0:T,A=g.paddingBottom,M=A===void 0?0:A,R=g.color,B=g.activeColor,z=g.size,U=g.fontFamily,Q=g.icon,tt=g.backgroundColor,nt=g.activeBackgroundColor,ut=(f==null?void 0:f.paneId)===d&&f.indicatorName===n&&f.iconId===g.id;(p=u.createFigure({name:"text",attrs:{text:Q,x:a.x+_,y:a.y+b},styles:{paddingLeft:E,paddingTop:P,paddingRight:D,paddingBottom:M,color:ut?B:R,size:z,family:U,backgroundColor:ut?nt:tt}},{mouseClickEvent:u._boundIconClickEvent({paneId:d,indicatorName:n,iconId:g.id}),mouseMoveEvent:u._boundIconMouseMoveEvent({paneId:d,indicatorName:n,iconId:g.id})}))===null||p===void 0||p.draw(t),a.x+=_+E+t.measureText(Q).width+D+C})}return s},e.prototype.drawStandardTooltipLegends=function(t,r,a,n,o,s,l){var u=this;if(r.length>0){var h=l.marginLeft,c=l.marginTop,v=l.marginRight,d=l.marginBottom,f=l.size,g=l.family,p=l.weight;t.font=jt(f,p,g),r.forEach(function(m){var _,y,b=m.title,x=m.value,C=t.measureText(b.text).width,w=t.measureText(x.text).width,E=C+w,I=c+f+d;a.x+h+E+v>s?(a.x=n,a.y+=o,o=I):o=Math.max(o,I),b.text.length>0&&((_=u.createFigure({name:"text",attrs:{x:a.x+h,y:a.y+c,text:b.text},styles:{color:b.color,size:f,family:g,weight:p}}))===null||_===void 0||_.draw(t)),(y=u.createFigure({name:"text",attrs:{x:a.x+h+C,y:a.y+c,text:x.text},styles:{color:x.color,size:f,family:g,weight:p}}))===null||y===void 0||y.draw(t),a.x+=h+E+v})}return o},e.prototype.isDrawTooltip=function(t,r){var a=r.showRule;return a===ae.Always||a===ae.FollowCross&&G(t.paneId)},e.prototype.getIndicatorTooltipData=function(t){var r,a,n=this.getWidget().getPane().getChart().getChartStore(),o=n.getStyles().indicator,s=o.tooltip,l=s.showName?t.shortName:"",u="",h=t.calcParams;h.length>0&&s.showParams&&(u="(".concat(h.join(","),")"));var c={name:l,calcParamsText:u,legends:[],icons:s.icons},v=n.getCrosshair().dataIndex,d=t.result,f=n.getCustomApi(),g=n.getDecimalFold(),p=n.getThousandsSeparator(),m=[];if(t.visible){var _=(a=(r=d[v])!==null&&r!==void 0?r:d[v-1])!==null&&a!==void 0?a:{};tr(t,v,o,function(A,M){if(G(A.title)){var R=M.color,B=_[A.key];F(B)&&(B=it(B,t.precision),t.shouldFormatBigNumber&&(B=f.formatBigNumber(B))),m.push({title:{text:A.title,color:R},value:{text:g.format(p.format(B??s.defaultValue)),color:R}})}}),c.legends=m}if(at(t.createTooltipDataSource)){var y=this.getWidget(),b=y.getPane(),x=b.getChart(),C=t.createTooltipDataSource({chart:x,indicator:t,crosshair:n.getCrosshair(),bounding:y.getBounding(),xAxis:b.getChart().getXAxisPane().getAxisComponent(),yAxis:b.getAxisComponent()}),w=C.name,E=C.calcParamsText,I=C.legends,P=C.icons;if(G(w)&&s.showName&&(c.name=w),G(E)&&s.showParams&&(c.calcParamsText=E),S(P)&&(c.icons=P),S(I)&&t.visible){var T=[],D=o.tooltip.text.color;I.forEach(function(A){var M={text:"",color:D};Pt(A.title)?M=A.title:M.text=A.title;var R={text:"",color:D};Pt(A.value)?R=A.value:R.text=A.value,F(Number(R.text))&&(R.text=g.format(p.format(R.text))),T.push({title:M,value:R})}),c.legends=T}}return c},e.prototype.classifyTooltipIcons=function(t){var r=[],a=[],n=[];return t.forEach(function(o){switch(o.position){case he.Left:{r.push(o);break}case he.Middle:{a.push(o);break}case he.Right:{n.push(o);break}}}),[r,a,n]},e}(xt),Kr=function(i){L(e,i);function e(t){var r=i.call(this,t)||this;return r._initEvent(),r}return e.prototype._initEvent=function(){var t=this,r=this.getWidget().getPane(),a=r.getId(),n=r.getChart(),o=n.getChartStore();this.registerEvent("mouseMoveEvent",function(s){var l,u=o.getProgressOverlayInfo();if(u!==null){var h=u.overlay,c=u.paneId;h.isStart()&&(o.updateProgressOverlayInfo(a),c=a);var v=h.points.length-1,d="".concat(Kt,"point_").concat(v);return h.isDrawing()&&c===a&&(h.eventMoveForDrawing(t._coordinateToPoint(h,s)),(l=h.onDrawing)===null||l===void 0||l.call(h,k({chart:n,overlay:h,figureKey:d,figureIndex:v},s))),t._figureMouseMoveEvent(h,1,d,v,0)(s)}return o.setHoverOverlayInfo({paneId:a,overlay:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},s),!1}).registerEvent("mouseClickEvent",function(s){var l,u,h=o.getProgressOverlayInfo();if(h!==null){var c=h.overlay,v=h.paneId;c.isStart()&&(o.updateProgressOverlayInfo(a,!0),v=a);var d=c.points.length-1,f="".concat(Kt,"point_").concat(d);return c.isDrawing()&&v===a&&(c.eventMoveForDrawing(t._coordinateToPoint(c,s)),(l=c.onDrawing)===null||l===void 0||l.call(c,k({chart:n,overlay:c,figureKey:f,figureIndex:d},s)),c.nextStep(),c.isDrawing()||(o.progressOverlayComplete(),(u=c.onDrawEnd)===null||u===void 0||u.call(c,k({chart:n,overlay:c,figureKey:f,figureIndex:d},s)))),t._figureMouseClickEvent(c,1,f,d,0)(s)}return o.setClickOverlayInfo({paneId:a,overlay:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},s),!1}).registerEvent("mouseDoubleClickEvent",function(s){var l,u=o.getProgressOverlayInfo();if(u!==null){var h=u.overlay,c=u.paneId;if(h.isDrawing()&&c===a&&(h.forceComplete(),!h.isDrawing())){o.progressOverlayComplete();var v=h.points.length-1,d="".concat(Kt,"point_").concat(v);(l=h.onDrawEnd)===null||l===void 0||l.call(h,k({chart:n,overlay:h,figureKey:d,figureIndex:v},s))}var f=h.points.length-1;return t._figureMouseClickEvent(h,1,"".concat(Kt,"point_").concat(f),f,0)(s)}return!1}).registerEvent("mouseRightClickEvent",function(s){var l=o.getProgressOverlayInfo();if(l!==null){var u=l.overlay;if(u.isDrawing()){var h=u.points.length-1;return t._figureMouseRightClickEvent(u,1,"".concat(Kt,"point_").concat(h),h,0)(s)}}return!1}).registerEvent("mouseUpEvent",function(s){var l,u=o.getPressedOverlayInfo(),h=u.overlay,c=u.figureIndex,v=u.figureKey;return h!==null&&((l=h.onPressedMoveEnd)===null||l===void 0||l.call(h,k({chart:n,overlay:h,figureKey:v,figureIndex:c},s))),o.setPressedOverlayInfo({paneId:a,overlay:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(s){var l,u,h=o.getPressedOverlayInfo(),c=h.overlay,v=h.figureType,d=h.figureIndex,f=h.figureKey;if(c!==null){if(!c.lock&&!((u=(l=c.onPressedMoving)===null||l===void 0?void 0:l.call(c,k({chart:n,overlay:c,figureIndex:d,figureKey:f},s)))!==null&&u!==void 0&&u)){var g=t._coordinateToPoint(c,s);v===1?c.eventPressedPointMove(g,d):c.eventPressedOtherMove(g,t.getWidget().getPane().getChart().getChartStore())}return!0}return!1})},e.prototype._createFigureEvents=function(t,r,a,n,o,s){var l=null;if(!t.isDrawing()){var u=[];if(S(s)&&(Ne(s)?s&&(u=oa()):u=s),u.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(t,r,a,n,o),mouseDownEvent:this._figureMouseDownEvent(t,r,a,n,o),mouseClickEvent:this._figureMouseClickEvent(t,r,a,n,o),mouseRightClickEvent:this._figureMouseRightClickEvent(t,r,a,n,o),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(t,r,a,n,o)};l={},!u.includes("mouseMoveEvent")&&!u.includes("touchMoveEvent")&&(l.mouseMoveEvent=this._figureMouseMoveEvent(t,r,a,n,o)),!u.includes("mouseDownEvent")&&!u.includes("touchStartEvent")&&(l.mouseDownEvent=this._figureMouseDownEvent(t,r,a,n,o)),!u.includes("mouseClickEvent")&&!u.includes("tapEvent")&&(l.mouseClickEvent=this._figureMouseClickEvent(t,r,a,n,o)),!u.includes("mouseDoubleClickEvent")&&!u.includes("doubleTapEvent")&&(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(t,r,a,n,o)),u.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(t,r,a,n,o))}return l??void 0},e.prototype._figureMouseMoveEvent=function(t,r,a,n,o){var s=this;return function(l){var u=s.getWidget().getPane();return u.getChart().getChartStore().setHoverOverlayInfo({paneId:u.getId(),overlay:t,figureType:r,figureKey:a,figureIndex:n,attrsIndex:o},l),!0}},e.prototype._figureMouseDownEvent=function(t,r,a,n,o){var s=this;return function(l){var u,h=s.getWidget().getPane(),c=h.getId();return t.startPressedMove(s._coordinateToPoint(t,l)),(u=t.onPressedMoveStart)===null||u===void 0||u.call(t,k({chart:h.getChart(),overlay:t,figureIndex:n,figureKey:a},l)),h.getChart().getChartStore().setPressedOverlayInfo({paneId:c,overlay:t,figureType:r,figureKey:a,figureIndex:n,attrsIndex:o}),!0}},e.prototype._figureMouseClickEvent=function(t,r,a,n,o){var s=this;return function(l){var u=s.getWidget().getPane(),h=u.getId();return u.getChart().getChartStore().setClickOverlayInfo({paneId:h,overlay:t,figureType:r,figureKey:a,figureIndex:n,attrsIndex:o},l),!0}},e.prototype._figureMouseDoubleClickEvent=function(t,r,a,n,o){var s=this;return function(l){var u;return(u=t.onDoubleClick)===null||u===void 0||u.call(t,k(k({},l),{chart:s.getWidget().getPane().getChart(),figureIndex:n,figureKey:a,overlay:t})),!0}},e.prototype._figureMouseRightClickEvent=function(t,r,a,n,o){var s=this;return function(l){var u,h;return(h=(u=t.onRightClick)===null||u===void 0?void 0:u.call(t,k({chart:s.getWidget().getPane().getChart(),overlay:t,figureIndex:n,figureKey:a},l)))!==null&&h!==void 0&&h||s.getWidget().getPane().getChart().getChartStore().removeOverlay(t),!0}},e.prototype._coordinateToPoint=function(t,r){var a,n={},o=this.getWidget().getPane(),s=o.getChart(),l=o.getId(),u=s.getChartStore();if(this.coordinateToPointTimestampDataIndexFlag()){var h=s.getXAxisPane().getAxisComponent(),c=h.convertFromPixel(r.x),v=(a=u.dataIndexToTimestamp(c))!==null&&a!==void 0?a:void 0;n.dataIndex=c,n.timestamp=v}if(this.coordinateToPointValueFlag()){var d=o.getAxisComponent(),f=d.convertFromPixel(r.y);if(t.mode!==re.Normal&&l===O.CANDLE&&F(n.dataIndex)){var g=u.getDataByDataIndex(n.dataIndex);if(g!==null){var p=t.modeSensitivity;if(f>g.high)if(t.mode===re.WeakMagnet){var m=d.convertToPixel(g.high),_=d.convertFromPixel(m-p);f<_&&(f=g.high)}else f=g.high;else if(f<g.low)if(t.mode===re.WeakMagnet){var y=d.convertToPixel(g.low),_=d.convertFromPixel(y-p);f>_&&(f=g.low)}else f=g.low;else{var b=Math.max(g.open,g.close),x=Math.min(g.open,g.close);f>b?f-b<g.high-f?f=b:f=g.high:f<x?f-g.low<x-f?f=g.low:f=x:b-f<f-x?f=b:f=x}}}n.value=f}return n},e.prototype.coordinateToPointValueFlag=function(){return!0},e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.dispatchEvent=function(t,r,a){return this.getWidget().getPane().getChart().getChartStore().isOverlayDrawing()?this.onEvent(t,r,a):i.prototype.dispatchEvent.call(this,t,r,a)},e.prototype.checkEventOn=function(){return!0},e.prototype.drawImp=function(t){var r=this,a=this.getCompleteOverlays();a.forEach(function(o){o.visible&&r._drawOverlay(t,o)});var n=this.getProgressOverlay();S(n)&&n.visible&&this._drawOverlay(t,n)},e.prototype._drawOverlay=function(t,r){var a=r.points,n=this.getWidget().getPane(),o=n.getChart(),s=o.getChartStore(),l=n.getAxisComponent(),u=o.getXAxisPane().getAxisComponent(),h=a.map(function(v){var d,f=v.dataIndex;F(v.timestamp)&&(f=s.timestampToDataIndex(v.timestamp));var g={x:0,y:0};return F(f)&&(g.x=u.convertToPixel(f)),F(v.value)&&(g.y=(d=l==null?void 0:l.convertToPixel(v.value))!==null&&d!==void 0?d:0),g});if(h.length>0){var c=new Array().concat(this.getFigures(r,h));this.drawFigures(t,r,c)}this.drawDefaultFigures(t,r,h)},e.prototype.drawFigures=function(t,r,a){var n=this,o=this.getWidget().getPane().getChart().getStyles().overlay;a.forEach(function(s,l){var u=s.type,h=s.styles,c=s.attrs,v=s.ignoreEvent,d=[].concat(c);d.forEach(function(f,g){var p,m,_,y=n._createFigureEvents(r,2,(p=s.key)!==null&&p!==void 0?p:"",l,g,v),b=k(k(k({},o[u]),(m=r.styles)===null||m===void 0?void 0:m[u]),h);(_=n.createFigure({name:u,attrs:f,styles:b},y))===null||_===void 0||_.draw(t)})})},e.prototype.getCompleteOverlays=function(){var t=this.getWidget().getPane();return t.getChart().getChartStore().getOverlaysByPaneId(t.getId())},e.prototype.getProgressOverlay=function(){var t=this.getWidget().getPane(),r=t.getChart().getChartStore().getProgressOverlayInfo();return S(r)&&r.paneId===t.getId()?r.overlay:null},e.prototype.getFigures=function(t,r){var a,n,o=this.getWidget(),s=o.getPane(),l=s.getChart(),u=s.getAxisComponent(),h=l.getXAxisPane().getAxisComponent(),c=o.getBounding();return(n=(a=t.createPointFigures)===null||a===void 0?void 0:a.call(t,{chart:l,overlay:t,coordinates:r,bounding:c,xAxis:h,yAxis:u}))!==null&&n!==void 0?n:[]},e.prototype.drawDefaultFigures=function(t,r,a){var n=this,o,s;if(r.needDefaultPointFigure){var l=this.getWidget().getPane().getChart().getChartStore(),u=l.getHoverOverlayInfo(),h=l.getClickOverlayInfo();if(((o=u.overlay)===null||o===void 0?void 0:o.id)===r.id&&u.figureType!==0||((s=h.overlay)===null||s===void 0?void 0:s.id)===r.id&&h.figureType!==0){var c=l.getStyles().overlay,v=r.styles,d=k(k({},c.point),v==null?void 0:v.point);a.forEach(function(f,g){var p,m,_,y=f.x,b=f.y,x=d.radius,C=d.color,w=d.borderColor,E=d.borderSize;((p=u.overlay)===null||p===void 0?void 0:p.id)===r.id&&u.figureType===1&&u.figureIndex===g&&(x=d.activeRadius,C=d.activeColor,w=d.activeBorderColor,E=d.activeBorderSize),(m=n.createFigure({name:"circle",attrs:{x:y,y:b,r:x+E},styles:{color:w}},n._createFigureEvents(r,1,"".concat(Kt,"point_").concat(g),g,0)))===null||m===void 0||m.draw(t),(_=n.createFigure({name:"circle",attrs:{x:y,y:b,r:x},styles:{color:C}}))===null||_===void 0||_.draw(t)})}}},e}(xt),Jr=function(i){L(e,i);function e(t,r){var a=i.call(this,t,r)||this;return a._gridView=new Ln(a),a._indicatorView=new Vn(a),a._crosshairLineView=new Nn(a),a._tooltipView=a.createTooltipView(),a._overlayView=new Kr(a),a.addChild(a._tooltipView),a.addChild(a._overlayView),a.getContainer().style.cursor="crosshair",a.registerEvent("mouseMoveEvent",function(){return r.getChart().getChartStore().setActiveTooltipIcon(),!1}),a}return e.prototype.getName=function(){return N.MAIN},e.prototype.updateMain=function(t){this.getPane().getOptions().state!=="minimize"&&(this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t))},e.prototype.createTooltipView=function(){return new qr(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this.getPane().getOptions().state!=="minimize"&&(this._overlayView.draw(t),this._crosshairLineView.draw(t)),this._tooltipView.draw(t)},e}(ir),Wn=function(i){L(e,i);function e(){var t=i.apply(this,fe([],Bt(arguments),!1))||this;return t._ripplePoint=t.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}),t._animationFrameTime=0,t._animation=new qe({iterationCount:1/0}).doFrame(function(r){t._animationFrameTime=r;var a=t.getWidget().getPane();a.getChart().updatePane(0,a.getId())}),t}return e.prototype.drawImp=function(t){var r,a,n,o=this.getWidget(),s=o.getPane(),l=s.getChart(),u=l.getDataList(),h=u.length-1,c=o.getBounding(),v=s.getAxisComponent(),d=l.getStyles().candle.area,f=[],g=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,m=null;if(this.eachChildren(function(w){var E=w.data,I=w.x,P=E==null?void 0:E[d.value];if(F(P)){var T=v.convertToPixel(P);p===Number.MIN_SAFE_INTEGER&&(p=I),f.push({x:I,y:T}),g=Math.min(g,T),w.dataIndex===h&&(m={x:I,y:T})}}),f.length>0){(r=this.createFigure({name:"line",attrs:{coordinates:f},styles:{color:d.lineColor,size:d.lineSize,smooth:d.smooth}}))===null||r===void 0||r.draw(t);var _=d.backgroundColor,y="";if(Rt(_)){var b=t.createLinearGradient(0,c.height,0,g);try{_.forEach(function(w){var E=w.offset,I=w.color;b.addColorStop(E,I)})}catch{}y=b}else y=_;t.fillStyle=y,t.beginPath(),t.moveTo(p,c.height),t.lineTo(f[0].x,f[0].y),Wr(t,f,d.smooth),t.lineTo(f[f.length-1].x,c.height),t.closePath(),t.fill()}var x=d.point;if(x.show&&S(m)){(a=this.createFigure({name:"circle",attrs:{x:m.x,y:m.y,r:x.radius},styles:{style:"fill",color:x.color}}))===null||a===void 0||a.draw(t);var C=x.rippleRadius;x.animation&&(C=x.radius+this._animationFrameTime/x.animationDuration*(x.rippleRadius-x.radius),this._animation.setDuration(x.animationDuration).start()),(n=this._ripplePoint)===null||n===void 0||n.setAttrs({x:m.x,y:m.y,r:C}).setStyles({style:"fill",color:x.rippleColor}).draw(t)}else this.stopAnimation()},e.prototype.stopAnimation=function(){this._animation.stop()},e}($r),zn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r=this.getWidget(),a=r.getPane(),n=a.getChart().getChartStore(),o=n.getStyles().candle.priceMark,s=o.high,l=o.low;if(o.show&&(s.show||l.show)){var u=n.getVisibleRangeHighLowPrice(),h=n.getPrecision(),c=a.getAxisComponent(),v=u[0],d=v.price,f=v.x,g=u[1],p=g.price,m=g.x,_=c.convertToPixel(d),y=c.convertToPixel(p),b=n.getDecimalFold(),x=n.getThousandsSeparator();s.show&&d!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,b.format(x.format(it(d,h.price))),{x:f,y:_},_<y?[-2,-5]:[2,5],s),l.show&&p!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,b.format(x.format(it(p,h.price))),{x:m,y},_<y?[2,5]:[-2,-5],l)}},e.prototype._drawMark=function(t,r,a,n,o){var s,l,u,h=a.x,c=a.y+n[0];(s=this.createFigure({name:"line",attrs:{coordinates:[{x:h-2,y:c+n[0]},{x:h,y:c},{x:h+2,y:c+n[0]}]},styles:{color:o.color}}))===null||s===void 0||s.draw(t);var v=0,d=0,f="left",g=this.getWidget().getBounding().width;h>g/2?(v=h-5,d=v-o.textOffset,f="right"):(v=h+5,f="left",d=v+o.textOffset);var p=c+n[1];(l=this.createFigure({name:"line",attrs:{coordinates:[{x:h,y:c},{x:h,y:p},{x:v,y:p}]},styles:{color:o.color}}))===null||l===void 0||l.draw(t),(u=this.createFigure({name:"text",attrs:{x:d,y:p,text:r,align:f,baseline:"middle"},styles:{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}}))===null||u===void 0||u.draw(t)},e}(xt),Xn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,h=u.line;if(l.show&&u.show&&h.show){var c=n.getAxisComponent(),v=s.getDataList(),d=v[v.length-1];if(S(d)){var f=d.close,g=d.open,p=c.convertToNicePixel(f),m="";f>g?m=u.upColor:f<g?m=u.downColor:m=u.noChangeColor,(r=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:p},{x:o.width,y:p}]},styles:{style:h.style,color:m,size:h.size,dashedValue:h.dashedValue}}))===null||r===void 0||r.draw(t)}}},e}(xt),Ft;(function(i){i.Left="left",i.Right="right"})(Ft||(Ft={}));function wr(){return{from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0}}var Qr=function(){function i(e){this.scrollZoomEnabled=!0,this._range=wr(),this._prevRange=wr(),this._ticks=[],this._autoCalcTickFlag=!0,this._parent=e}return i.prototype.getParent=function(){return this._parent},i.prototype.buildTicks=function(e){return this._autoCalcTickFlag&&(this._range=this.createRangeImp()),this._prevRange.from!==this._range.from||this._prevRange.to!==this._range.to||e?(this._prevRange=this._range,this._ticks=this.createTicksImp(),!0):!1},i.prototype.getTicks=function(){return this._ticks},i.prototype.setRange=function(e){this._autoCalcTickFlag=!1,this._range=e},i.prototype.getRange=function(){return this._range},i.prototype.setAutoCalcTickFlag=function(e){this._autoCalcTickFlag=e},i.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},i}(),Hn={time:"",open:"",high:"",low:"",close:"",volume:"",turnover:"",change:""},Yn={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "},Gn={"zh-CN":Hn,"en-US":Yn};function Un(i,e){var t;return(t=Gn[e][i])!==null&&t!==void 0?t:i}var Zn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r=this.getWidget(),a=r.getPane().getChart().getChartStore(),n=a.getCrosshair();if(S(n.kLineData)){var o=r.getBounding(),s=a.getStyles(),l=s.candle,u=s.indicator;if(l.tooltip.showType===Et.Rect&&u.tooltip.showType===Et.Rect){var h=this.isDrawTooltip(n,l.tooltip),c=this.isDrawTooltip(n,u.tooltip);this._drawRectTooltip(t,h,c,l.tooltip.offsetTop)}else if(l.tooltip.showType===Et.Standard&&u.tooltip.showType===Et.Standard){var v=l.tooltip,d=v.offsetLeft,f=v.offsetTop,g=v.offsetRight,p=o.width-g,m=this._drawCandleStandardTooltip(t,d,f,p);this.drawIndicatorTooltip(t,d,m,p)}else if(l.tooltip.showType===Et.Rect&&u.tooltip.showType===Et.Standard){var _=l.tooltip,d=_.offsetLeft,f=_.offsetTop,g=_.offsetRight,p=o.width-g,y=this.drawIndicatorTooltip(t,d,f,p),h=this.isDrawTooltip(n,l.tooltip);this._drawRectTooltip(t,h,!1,y)}else{var b=l.tooltip,d=b.offsetLeft,f=b.offsetTop,g=b.offsetRight,p=o.width-g,x=this._drawCandleStandardTooltip(t,d,f,p),c=this.isDrawTooltip(n,u.tooltip);this._drawRectTooltip(t,!1,c,x)}}},e.prototype._drawCandleStandardTooltip=function(t,r,a,n){var o=this.getWidget().getPane().getChart().getChartStore(),s=o.getStyles().candle,l=s.tooltip,u=l.text,h=0,c={x:r,y:a},v=o.getCrosshair();if(this.isDrawTooltip(v,l)){var d=this._getCandleTooltipLegends(),f=Bt(this.classifyTooltipIcons(l.icons),3),g=f[0],p=f[1],m=f[2];h=this.drawStandardTooltipIcons(t,g,c,"",r,h,n),h=this.drawStandardTooltipIcons(t,p,c,"",r,h,n),d.length>0&&(h=this.drawStandardTooltipLegends(t,d,c,r,h,n,u)),h=this.drawStandardTooltipIcons(t,m,c,"",r,h,n)}return c.y+h},e.prototype._drawRectTooltip=function(t,r,a,n){var o=this,s,l,u=this.getWidget(),h=u.getPane(),c=h.getChart().getChartStore(),v=c.getStyles(),d=v.candle,f=v.indicator,g=d.tooltip,p=f.tooltip;if(r||a){var m=this._getCandleTooltipLegends(),_=g.offsetLeft,y=g.offsetTop,b=g.offsetRight,x=g.offsetBottom,C=g.text,w=C.marginLeft,E=C.marginRight,I=C.marginTop,P=C.marginBottom,T=C.size,D=C.weight,A=C.family,M=g.rect,R=M.position,B=M.paddingLeft,z=M.paddingRight,U=M.paddingTop,Q=M.paddingBottom,tt=M.offsetLeft,nt=M.offsetRight,ut=M.offsetTop,Ct=M.offsetBottom,K=M.borderSize,ot=M.borderRadius,Xt=M.borderColor,wt=M.color,ht=0,et=0,dt=0;r&&(t.font=jt(T,D,A),m.forEach(function(At){var yt=At.title,ft=At.value,St="".concat(yt.text).concat(ft.text),kt=t.measureText(St).width+w+E;ht=Math.max(ht,kt)}),dt+=(P+I+T)*m.length);var Mt=p.text,pe=Mt.marginLeft,ge=Mt.marginRight,me=Mt.marginTop,qt=Mt.marginBottom,oe=Mt.size,We=Mt.weight,ze=Mt.family,ar=[];if(a){var si=c.getIndicatorsByPaneId(h.getId());t.font=jt(oe,We,ze),si.forEach(function(At){var yt=o.getIndicatorTooltipData(At).legends;ar.push(yt),yt.forEach(function(ft){var St=ft.title,kt=ft.value,xe="".concat(St.text).concat(kt.text),vi=t.measureText(xe).width+pe+ge;ht=Math.max(ht,vi),dt+=me+qt+oe})})}if(et+=ht,et!==0&&dt!==0){var _e=c.getCrosshair(),ye=u.getBounding(),nr=h.getYAxisWidget().getBounding();et+=K*2+B+z,dt+=K*2+U+Q;var li=ye.width/2,or=R===De.Pointer&&_e.paneId===O.CANDLE,sr=((s=_e.realX)!==null&&s!==void 0?s:0)>li,_t=0;if(or){var lr=_e.realX;sr?_t=lr-nt-et:_t=lr+tt}else{var be=this.getWidget().getPane().getAxisComponent();sr?(_t=tt+_,be.inside&&be.position===Ft.Left&&(_t+=nr.width)):(_t=ye.width-nt-et-b,be.inside&&be.position===Ft.Right&&(_t-=nr.width))}var Ht=n+ut;if(or){var ui=_e.y;Ht=ui-dt/2,Ht+dt>ye.height-Ct-x&&(Ht=ye.height-Ct-dt-x),Ht<n+ut&&(Ht=n+ut+y)}(l=this.createFigure({name:"rect",attrs:{x:_t,y:Ht,width:et,height:dt},styles:{style:X.StrokeFill,color:wt,borderColor:Xt,borderSize:K,borderRadius:ot}}))===null||l===void 0||l.draw(t);var hi=_t+K+B+w,Lt=Ht+K+U;if(r&&m.forEach(function(At){var yt,ft;Lt+=I;var St=At.title;(yt=o.createFigure({name:"text",attrs:{x:hi,y:Lt,text:St.text},styles:{color:St.color,size:T,family:A,weight:D}}))===null||yt===void 0||yt.draw(t);var kt=At.value;(ft=o.createFigure({name:"text",attrs:{x:_t+et-K-E-z,y:Lt,text:kt.text,align:"right"},styles:{color:kt.color,size:T,family:A,weight:D}}))===null||ft===void 0||ft.draw(t),Lt+=T+P}),a){var ci=_t+K+B+pe;ar.forEach(function(At){At.forEach(function(yt){var ft,St;Lt+=me;var kt=yt.title,xe=yt.value;(ft=o.createFigure({name:"text",attrs:{x:ci,y:Lt,text:kt.text},styles:{color:kt.color,size:oe,family:ze,weight:We}}))===null||ft===void 0||ft.draw(t),(St=o.createFigure({name:"text",attrs:{x:_t+et-K-ge-z,y:Lt,text:xe.text,align:"right"},styles:{color:xe.color,size:oe,family:ze,weight:We}}))===null||St===void 0||St.draw(t),Lt+=oe+qt})})}}}},e.prototype._getCandleTooltipLegends=function(){var t,r,a,n,o,s,l=this.getWidget().getPane().getChart().getChartStore(),u=l.getStyles().candle,h=l.getDataList(),c=l.getCustomApi(),v=l.getDecimalFold(),d=l.getThousandsSeparator(),f=l.getLocale(),g=l.getPrecision(),p=g.price,m=g.volume,_=(t=l.getCrosshair().dataIndex)!==null&&t!==void 0?t:0,y=u.tooltip,b=y.text.color,x=(r=h[_-1])!==null&&r!==void 0?r:null,C=h[_],w=(a=x==null?void 0:x.close)!==null&&a!==void 0?a:C.close,E=C.close-w,I={"{time}":c.formatDate(C.timestamp,"YYYY-MM-DD HH:mm",Tt.Tooltip),"{open}":v.format(d.format(it(C.open,p))),"{high}":v.format(d.format(it(C.high,p))),"{low}":v.format(d.format(it(C.low,p))),"{close}":v.format(d.format(it(C.close,p))),"{volume}":v.format(d.format(c.formatBigNumber(it((n=C.volume)!==null&&n!==void 0?n:y.defaultValue,m)))),"{turnover}":v.format(d.format(it((o=C.turnover)!==null&&o!==void 0?o:y.defaultValue,p))),"{change}":w===0?y.defaultValue:"".concat(d.format(it(E/w*100)),"%")},P=at(y.custom)?y.custom({prev:x,current:C,next:(s=h[_+1])!==null&&s!==void 0?s:null},u):y.custom;return P.map(function(T){var D,A=T.title,M=T.value,R={text:"",color:""};Pt(A)?R=k({},A):(R.text=A,R.color=b),R.text=Un(R.text,f);var B={text:y.defaultValue,color:""};Pt(M)?B=k({},M):(B.text=M,B.color=b);var z=/{(\S*)}/.exec(B.text);if(z!==null&&z.length>1){var U="{".concat(z[1],"}");B.text=B.text.replace(U,(D=I[U])!==null&&D!==void 0?D:y.defaultValue),U==="{change}"&&(B.color=E===0?u.priceMark.last.noChangeColor:E>0?u.priceMark.last.upColor:u.priceMark.last.downColor)}return{title:R,value:B}})},e}(qr),$n=function(i){L(e,i);function e(t,r){var a=i.call(this,t,r)||this;return a._candleBarView=new jr(a),a._candleAreaView=new Wn(a),a._candleHighLowPriceView=new zn(a),a._candleLastPriceLineView=new Xn(a),a.addChild(a._candleBarView),a}return e.prototype.updateMainContent=function(t){var r=this.getPane().getChart().getStyles().candle;r.type!==gt.Area?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(t),this._candleLastPriceLineView.draw(t)},e.prototype.createTooltipView=function(){return new Zn(this)},e}(Jr),ti=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t,r){var a=this,n,o,s=this.getWidget(),l=s.getPane(),u=s.getBounding(),h=l.getAxisComponent(),c=this.getAxisStyles(l.getChart().getStyles());if(c.show&&(c.axisLine.show&&((n=this.createFigure({name:"line",attrs:this.createAxisLine(u,c),styles:c.axisLine}))===null||n===void 0||n.draw(t)),!r[0])){var v=h.getTicks();if(c.tickLine.show){var d=this.createTickLines(v,u,c);d.forEach(function(g){var p;(p=a.createFigure({name:"line",attrs:g,styles:c.tickLine}))===null||p===void 0||p.draw(t)})}if(c.tickText.show){var f=this.createTickTexts(v,u,c);(o=this.createFigure({name:"text",attrs:f,styles:c.tickText}))===null||o===void 0||o.draw(t)}}},e}(xt),jn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,r){var a=this.getWidget().getPane().getAxisComponent(),n=r.axisLine.size,o=0;return a.isFromZero()?o=0:o=t.width-n,{coordinates:[{x:o,y:0},{x:o,y:t.height}]}},e.prototype.createTickLines=function(t,r,a){var n=this.getWidget().getPane().getAxisComponent(),o=a.axisLine,s=a.tickLine,l=0,u=0;return n.isFromZero()?(l=0,o.show&&(l+=o.size),u=l+s.length):(l=r.width,o.show&&(l-=o.size),u=l-s.length),t.map(function(h){return{coordinates:[{x:l,y:h.coord},{x:u,y:h.coord}]}})},e.prototype.createTickTexts=function(t,r,a){var n=this.getWidget().getPane().getAxisComponent(),o=a.axisLine,s=a.tickLine,l=a.tickText,u=0;n.isFromZero()?(u=l.marginStart,o.show&&(u+=o.size),s.show&&(u+=s.length)):(u=r.width-l.marginEnd,o.show&&(u-=o.size),s.show&&(u-=s.length));var h=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map(function(c){return{x:u,y:c.coord,text:c.text,align:h,baseline:"middle"}})},e}(ti),qn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,h=u.text;if(l.show&&u.show&&h.show){var c=s.getPrecision(),v=n.getAxisComponent(),d=s.getDataList(),f=d[d.length-1];if(S(f)){var g=f.close,p=f.open,m=v.convertToNicePixel(g),_="";g>p?_=u.upColor:g<p?_=u.downColor:_=u.noChangeColor;var y=v.getRange(),b=v.displayValueToText(v.realValueToDisplayValue(v.valueToRealValue(g,{range:y}),{range:y}),c.price);b=s.getDecimalFold().format(s.getThousandsSeparator().format(b));var x=0,C="left";v.isFromZero()?(x=0,C="left"):(x=o.width,C="right"),(r=this.createFigure({name:"text",attrs:{x,y:m,text:b,align:C,baseline:"middle"},styles:k(k({},h),{backgroundColor:_})}))===null||r===void 0||r.draw(t)}}},e}(xt),Kn=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r=this,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().indicator,u=l.lastValueMark,h=u.text;if(u.show){var c=n.getAxisComponent(),v=c.getRange(),d=s.getDataList(),f=d.length-1,g=s.getIndicatorsByPaneId(n.getId()),p=s.getCustomApi(),m=s.getDecimalFold(),_=s.getThousandsSeparator();g.forEach(function(y){var b,x,C=y.result,w=(x=(b=C[f])!==null&&b!==void 0?b:C[f-1])!==null&&x!==void 0?x:{};if(S(w)&&y.visible){var E=y.precision;tr(y,f,l,function(I,P){var T,D=w[I.key];if(F(D)){var A=c.convertToNicePixel(D),M=c.displayValueToText(c.realValueToDisplayValue(c.valueToRealValue(D,{range:v}),{range:v}),E);y.shouldFormatBigNumber&&(M=p.formatBigNumber(M)),M=m.format(_.format(M));var R=0,B="left";c.isFromZero()?(R=0,B="left"):(R=o.width,B="right"),(T=r.createFigure({name:"text",attrs:{x:R,y:A,text:M,align:B,baseline:"middle"},styles:k(k({},h),{backgroundColor:P.color})}))===null||T===void 0||T.draw(t)}})}})}},e}(xt),ei=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,r,a){this.drawFigures(t,r,this.getDefaultFigures(r,a))},e.prototype.getDefaultFigures=function(t,r){var a,n=this.getWidget(),o=n.getPane(),s=o.getChart().getChartStore(),l=s.getClickOverlayInfo(),u=[];if(t.needDefaultYAxisFigure&&t.id===((a=l.overlay)===null||a===void 0?void 0:a.id)&&l.paneId===o.getId()){var h=o.getAxisComponent(),c=n.getBounding(),v=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,f=h.isFromZero(),g="left",p=0;f?(g="left",p=0):(g="right",p=c.width);var m=s.getDecimalFold(),_=s.getThousandsSeparator();r.forEach(function(y,b){var x=t.points[b];if(F(x.value)){v=Math.min(v,y.y),d=Math.max(d,y.y);var C=m.format(_.format(it(x.value,s.getPrecision().price)));u.push({type:"text",attrs:{x:p,y:y.y,text:C,align:g,baseline:"middle"},ignoreEvent:!0})}}),r.length>1&&u.unshift({type:"rect",attrs:{x:0,y:v,width:c.width,height:d-v},ignoreEvent:!0})}return u},e.prototype.getFigures=function(t,r){var a,n,o=this.getWidget(),s=o.getPane(),l=s.getChart(),u=s.getAxisComponent(),h=l.getXAxisPane().getAxisComponent(),c=o.getBounding();return(n=(a=t.createYAxisFigures)===null||a===void 0?void 0:a.call(t,{chart:l,overlay:t,coordinates:r,bounding:c,xAxis:h,yAxis:u}))!==null&&n!==void 0?n:[]},e}(Kr),ri=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.drawImp=function(t){var r,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=a.getPane().getChart().getChartStore(),l=s.getCrosshair(),u=s.getStyles().crosshair;if(G(l.paneId)&&this.compare(l,n.getId())&&u.show){var h=this.getDirectionStyles(u),c=h.text;if(h.show&&c.show){var v=n.getAxisComponent(),d=this.getText(l,s,v);t.font=jt(c.size,c.weight,c.family),(r=this.createFigure({name:"text",attrs:this.getTextAttrs(d,t.measureText(d).width,l,o,v,c),styles:c}))===null||r===void 0||r.draw(t)}}},e.prototype.compare=function(t,r){return t.paneId===r},e.prototype.getDirectionStyles=function(t){return t.horizontal},e.prototype.getText=function(t,r,a){var n=a,o=a.convertFromPixel(t.y),s=0,l=!1;if(n.isInCandle())s=r.getPrecision().price;else{var u=r.getIndicatorsByPaneId(t.paneId);u.forEach(function(v){s=Math.max(v.precision,s),l||(l=v.shouldFormatBigNumber)})}var h=n.getRange(),c=n.displayValueToText(n.realValueToDisplayValue(n.valueToRealValue(o,{range:h}),{range:h}),s);return l&&(c=r.getCustomApi().formatBigNumber(c)),r.getDecimalFold().format(r.getThousandsSeparator().format(c))},e.prototype.getTextAttrs=function(t,r,a,n,o,s){var l=o,u=0,h="left";return l.isFromZero()?(u=0,h="left"):(u=n.width,h="right"),{x:u,y:a.y,text:t,align:h,baseline:"middle"}},e}(xt),Jn=function(i){L(e,i);function e(t,r){var a=i.call(this,t,r)||this;return a._yAxisView=new jn(a),a._candleLastPriceLabelView=new qn(a),a._indicatorLastValueView=new Kn(a),a._overlayYAxisView=new ei(a),a._crosshairHorizontalLabelView=new ri(a),a.getContainer().style.cursor="ns-resize",a.addChild(a._overlayYAxisView),a}return e.prototype.getName=function(){return N.Y_AXIS},e.prototype.updateMain=function(t){var r=this.getPane().getOptions().state==="minimize";this._yAxisView.draw(t,r),r||(this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t))},e.prototype.updateOverlay=function(t){this.getPane().getOptions().state!=="minimize"&&(this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t))},e}(ir),Ie=8,Te=function(i){L(e,i);function e(t,r){var a=i.call(this,t)||this;return a.reverse=!1,a.inside=!1,a.position=Ft.Right,a.gap={top:.2,bottom:.1},a.createRange=function(n){return n.defaultRange},a.minSpan=function(n){return Gt(-n)},a.valueToRealValue=function(n){return n},a.realValueToDisplayValue=function(n){return n},a.displayValueToRealValue=function(n){return n},a.realValueToValue=function(n){return n},a.displayValueToText=function(n,o){return it(n,o)},a.override(r),a}return e.prototype.override=function(t){var r=t.name,a=t.gap,n=ke(t,["name","gap"]);G(this.name)||(this.name=r),Z(this.gap,a),Z(this,n)},e.prototype.createRangeImp=function(){var t=this.getParent(),r=t.getChart(),a=r.getChartStore(),n=t.getId(),o=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,l=!1,u=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,v=a.getIndicatorsByPaneId(n);v.forEach(function(ot){l||(l=ot.shouldOhlc),c=Math.min(c,ot.precision),F(ot.minValue)&&(u=Math.min(u,ot.minValue)),F(ot.maxValue)&&(h=Math.max(h,ot.maxValue))});var d=4,f=this.isInCandle();if(f){var g=a.getPrecision().price;c!==Number.MAX_SAFE_INTEGER?d=Math.min(c,g):d=g}else c!==Number.MAX_SAFE_INTEGER&&(d=c);var p=a.getVisibleRangeDataList(),m=r.getStyles().candle,_=m.type===gt.Area,y=m.area.value,b=f&&!_||!f&&l;p.forEach(function(ot){var Xt=ot.dataIndex,wt=ot.data;if(S(wt)&&(b&&(o=Math.min(o,wt.low),s=Math.max(s,wt.high)),f&&_)){var ht=wt[y];F(ht)&&(o=Math.min(o,ht),s=Math.max(s,ht))}v.forEach(function(et){var dt,Mt=et.result,pe=et.figures,ge=(dt=Mt[Xt])!==null&&dt!==void 0?dt:{};pe.forEach(function(me){var qt=ge[me.key];F(qt)&&(o=Math.min(o,qt),s=Math.max(s,qt))})})}),o!==Number.MAX_SAFE_INTEGER&&s!==Number.MIN_SAFE_INTEGER?(o=Math.min(u,o),s=Math.max(h,s)):(o=0,s=10);var x=s-o,C={from:o,to:s,range:x,realFrom:o,realTo:s,realRange:x,displayFrom:o,displayTo:s,displayRange:x},w=this.createRange({chart:r,paneId:n,defaultRange:C}),E=w.realFrom,I=w.realTo,P=w.realRange,T=this.minSpan(d);if(E===I||P<T){var D=u===E,A=h===I,M=Ie/2;E=D?E:A?E-Ie*T:E-M*T,I=A?I:D?I+Ie*T:I+M*T}var R=this.getBounding().height,B=this.gap,z=B.top,U=B.bottom,Q=z;Q>=1&&(Q=Q/R);var tt=U;tt>=1&&(tt=tt/R),P=I-E,E=E-P*tt,I=I+P*Q;var nt=this.realValueToValue(E,{range:w}),ut=this.realValueToValue(I,{range:w}),Ct=this.realValueToDisplayValue(E,{range:w}),K=this.realValueToDisplayValue(I,{range:w});return{from:nt,to:ut,range:ut-nt,realFrom:E,realTo:I,realRange:I-E,displayFrom:Ct,displayTo:K,displayRange:K-Ct}},e.prototype.isInCandle=function(){return this.getParent().getId()===O.CANDLE},e.prototype.isFromZero=function(){return this.position===Ft.Left&&this.inside||this.position===Ft.Right&&!this.inside},e.prototype.createTicksImp=function(){var t=this,r,a,n=this.getRange(),o=n.displayFrom,s=n.displayTo,l=n.displayRange,u=[];if(l>=0){var h=ha(l/Ie),c=ca(h),v=_r(Math.ceil(o/h)*h,c),d=_r(Math.floor(s/h)*h,c),f=0,g=v;if(h!==0)for(;g<=d;){var p=g.toFixed(c);u[f]={text:p,coord:0,value:p},++f,g+=h}}var m=this.getParent(),_=(a=(r=m.getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&a!==void 0?a:0,y=m.getChart().getChartStore(),b=[],x=y.getIndicatorsByPaneId(m.getId()),C=y.getStyles(),w=0,E=!1;this.isInCandle()?w=y.getPrecision().price:x.forEach(function(M){w=Math.max(w,M.precision),E||(E=M.shouldFormatBigNumber)});var I=y.getCustomApi(),P=y.getThousandsSeparator(),T=y.getDecimalFold(),D=C.xAxis.tickText.size,A=NaN;return u.forEach(function(M){var R=M.value,B=t.displayValueToText(+R,w),z=t.convertToPixel(t.realValueToValue(t.displayValueToRealValue(+R,{range:n}),{range:n}));E&&(B=I.formatBigNumber(R)),B=T.format(P.format(B));var U=F(A);z>D&&z<_-D&&(U&&Math.abs(A-z)>D*2||!U)&&(b.push({text:B,coord:z,value:R}),A=z)}),at(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:b}):b},e.prototype.getAutoSize=function(){var t=this.getParent(),r=t.getChart(),a=r.getChartStore(),n=a.getStyles(),o=n.yAxis,s=o.size;if(s!=="auto")return s;var l=0;if(o.show&&(o.axisLine.show&&(l+=o.axisLine.size),o.tickLine.show&&(l+=o.tickLine.length),o.tickText.show)){var u=0;this.getTicks().forEach(function(y){u=Math.max(u,Re(y.text,o.tickText.size,o.tickText.weight,o.tickText.family))}),l+=o.tickText.marginStart+o.tickText.marginEnd+u}var h=n.crosshair,c=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var v=a.getIndicatorsByPaneId(t.getId()),d=0,f=!1;v.forEach(function(y){d=Math.max(y.precision,d),f||(f=y.shouldFormatBigNumber)});var g=2;if(this.isInCandle()){var p=a.getPrecision().price,m=n.indicator.lastValueMark;m.show&&m.text.show?g=Math.max(d,p):g=p}else g=d;var _=it(this.getRange().displayTo,g);f&&(_=a.getCustomApi().formatBigNumber(_)),_=a.getDecimalFold().format(_),c+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+h.horizontal.text.borderSize*2+Re(_,h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(l,c)},e.prototype.getBounding=function(){return this.getParent().getYAxisWidget().getBounding()},e.prototype.convertFromPixel=function(t){var r=this.getBounding().height,a=this.getRange(),n=a.realFrom,o=a.realRange,s=this.reverse?t/r:1-t/r,l=s*o+n;return this.realValueToValue(l,{range:a})},e.prototype.convertToPixel=function(t){var r,a,n=this.getRange(),o=this.valueToRealValue(t,{range:n}),s=(a=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&a!==void 0?a:0,l=n.realFrom,u=n.realRange,h=(o-l)/u;return this.reverse?Math.round(h*s):Math.round((1-h)*s)},e.prototype.convertToNicePixel=function(t){var r,a,n=(a=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&a!==void 0?a:0,o=this.convertToPixel(t);return Math.round(Math.max(n*.05,Math.min(o,n*.98)))},e.extend=function(t){var r=function(a){L(n,a);function n(o){return a.call(this,o,t)||this}return n}(e);return r},e}(Qr),Qn={name:"normal"},to={name:"percentage",minSpan:function(){return Math.pow(10,-2)},displayValueToText:function(i){return"".concat(it(i,2),"%")},valueToRealValue:function(i,e){var t=e.range;return(i-t.from)/t.range*t.realRange+t.realFrom},realValueToValue:function(i,e){var t=e.range;return(i-t.realFrom)/t.realRange*t.range+t.from},createRange:function(i){var e=i.chart,t=i.defaultRange,r=e.getDataList(),a=e.getVisibleRange(),n=r[a.from];if(S(n)){var o=t.from,s=t.to,l=t.range,u=(t.from-n.close)/n.close*100,h=(t.to-n.close)/n.close*100,c=h-u;return{from:o,to:s,range:l,realFrom:u,realTo:h,realRange:c,displayFrom:u,displayTo:h,displayRange:c}}return t}},eo={name:"logarithm",minSpan:function(i){return .05*Gt(-i)},valueToRealValue:function(i){return i<0?-Dt(Math.abs(i)):Dt(i)},realValueToDisplayValue:function(i){return i<0?-Gt(Math.abs(i)):Gt(i)},displayValueToRealValue:function(i){return i<0?-Dt(Math.abs(i)):Dt(i)},realValueToValue:function(i){return i<0?-Gt(Math.abs(i)):Gt(i)},createRange:function(i){var e=i.defaultRange,t=e.from,r=e.to,a=e.range,n=t<0?-Dt(Math.abs(t)):Dt(t),o=r<0?-Dt(Math.abs(r)):Dt(r);return{from:t,to:r,range:a,realFrom:n,realTo:o,realRange:o-n,displayFrom:t,displayTo:r,displayRange:a}}},Sr={normal:Te.extend(Qn),percentage:Te.extend(to),logarithm:Te.extend(eo)};function ro(i){var e;return(e=Sr[i])!==null&&e!==void 0?e:Sr.normal}var ii=function(){function i(e,t,r,a){this._bounding=Fe(),this._originalBounding=Fe(),this._visible=!0,this._chart=r,this._id=a,this._init(e,t)}return i.prototype._init=function(e,t){this._rootContainer=e,this._container=Ot("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),t!==null?e.insertBefore(this._container,t):e.appendChild(this._container)},i.prototype.getContainer=function(){return this._container},i.prototype.setVisible=function(e){this._visible!==e&&(this._container.style.display=e?"block":"none",this._visible=e)},i.prototype.getVisible=function(){return this._visible},i.prototype.getId=function(){return this._id},i.prototype.getChart=function(){return this._chart},i.prototype.getBounding=function(){return this._bounding},i.prototype.setOriginalBounding=function(e){Z(this._originalBounding,e)},i.prototype.getOriginalBounding=function(){return this._originalBounding},i.prototype.update=function(e){this._bounding.height!==this._container.clientHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(e??3,this._container,this._bounding)},i.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},i}(),ai=function(i){L(e,i);function e(t,r,a,n,o){var s=i.call(this,t,r,a,n)||this;s._yAxisWidget=null,s._options={id:"",minHeight:Ee,dragEnabled:!0,order:0,height:Hr,state:"normal",axis:{name:"normal",scrollZoomEnabled:!0}};var l=s.getContainer();return s._mainWidget=s.createMainWidget(l),s._yAxisWidget=s.createYAxisWidget(l),s.setOptions(o),s}return e.prototype.setOptions=function(t){var r,a,n,o,s,l=this.getId();if(l===O.CANDLE||l===O.X_AXIS){var u=(r=t.axis)===null||r===void 0?void 0:r.name;(!S(this._axis)||S(u)&&this._options.axis.name!==u)&&(this._axis=this.createAxisComponent(u??"normal"))}else S(this._axis)||(this._axis=this.createAxisComponent("normal"));this._axis instanceof Te&&this._axis.setAutoCalcTickFlag(!0),Z(this._options,t),this._axis.override(k(k({},this._options.axis),{name:(n=(a=t.axis)===null||a===void 0?void 0:a.name)!==null&&n!==void 0?n:"normal"}));var h=null,c="default";return this.getId()===O.X_AXIS?(h=this.getMainWidget().getContainer(),c="ew-resize"):(h=this.getYAxisWidget().getContainer(),c="ns-resize"),!((s=(o=t.axis)===null||o===void 0?void 0:o.scrollZoomEnabled)!==null&&s!==void 0)||s?h.style.cursor=c:h.style.cursor="default",this},e.prototype.getOptions=function(){return this._options},e.prototype.getAxisComponent=function(){return this._axis},e.prototype.setBounding=function(t,r,a,n){var o,s,l,u;Z(this.getBounding(),t);var h={};S(t.height)&&(h.height=t.height),S(t.top)&&(h.top=t.top),this._mainWidget.setBounding(h);var c=S(r);if(c&&this._mainWidget.setBounding(r),S(this._yAxisWidget)){this._yAxisWidget.setBounding(h);var v=this._axis;v.position===Ft.Left?S(a)&&this._yAxisWidget.setBounding(k(k({},a),{left:0})):S(n)&&(this._yAxisWidget.setBounding(n),c&&this._yAxisWidget.setBounding({left:((o=r.left)!==null&&o!==void 0?o:0)+((s=r.width)!==null&&s!==void 0?s:0)+((l=r.right)!==null&&l!==void 0?l:0)-((u=n.width)!==null&&u!==void 0?u:0)}))}return this},e.prototype.getMainWidget=function(){return this._mainWidget},e.prototype.getYAxisWidget=function(){return this._yAxisWidget},e.prototype.updateImp=function(t){var r;this._mainWidget.update(t),(r=this._yAxisWidget)===null||r===void 0||r.update(t)},e.prototype.destroy=function(){var t;i.prototype.destroy.call(this),this._mainWidget.destroy(),(t=this._yAxisWidget)===null||t===void 0||t.destroy()},e.prototype.getImage=function(t){var r=this.getBounding(),a=r.width,n=r.height,o=Ot("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),l=zt(o);o.width=a*l,o.height=n*l,s.scale(l,l);var u=this._mainWidget.getBounding();if(s.drawImage(this._mainWidget.getImage(t),u.left,0,u.width,u.height),this._yAxisWidget!==null){var h=this._yAxisWidget.getBounding();s.drawImage(this._yAxisWidget.getImage(t),h.left,0,h.width,h.height)}return o},e.prototype.createYAxisWidget=function(t){return null},e}(ii),ni=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.createAxisComponent=function(t){var r=ro(t??"default");return new r(this)},e.prototype.createMainWidget=function(t){return new Jr(t,this)},e.prototype.createYAxisWidget=function(t){return new Jn(t,this)},e}(ai),io=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.createMainWidget=function(t){return new $n(t,this)},e}(ni),ao=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t){return{coordinates:[{x:0,y:0},{x:t.width,y:0}]}},e.prototype.createTickLines=function(t,r,a){var n=a.tickLine,o=a.axisLine.size;return t.map(function(s){return{coordinates:[{x:s.coord,y:0},{x:s.coord,y:o+n.length}]}})},e.prototype.createTickTexts=function(t,r,a){var n=a.tickText,o=a.axisLine.size,s=a.tickLine.length;return t.map(function(l){return{x:l.coord,y:o+s+n.marginStart,text:l.text,align:"center",baseline:"top"}})},e}(ti),no=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.coordinateToPointValueFlag=function(){return!1},e.prototype.getCompleteOverlays=function(){return this.getWidget().getPane().getChart().getChartStore().getOverlaysByPaneId()},e.prototype.getProgressOverlay=function(){var t,r;return(r=(t=this.getWidget().getPane().getChart().getChartStore().getProgressOverlayInfo())===null||t===void 0?void 0:t.overlay)!==null&&r!==void 0?r:null},e.prototype.getDefaultFigures=function(t,r){var a,n=[],o=this.getWidget(),s=o.getPane(),l=s.getChart().getChartStore(),u=l.getClickOverlayInfo();if(t.needDefaultXAxisFigure&&t.id===((a=u.overlay)===null||a===void 0?void 0:a.id)){var h=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;r.forEach(function(v,d){h=Math.min(h,v.x),c=Math.max(c,v.x);var f=t.points[d];if(F(f.timestamp)){var g=l.getCustomApi().formatDate(f.timestamp,"YYYY-MM-DD HH:mm",Tt.Crosshair);n.push({type:"text",attrs:{x:v.x,y:0,text:g,align:"center"},ignoreEvent:!0})}}),r.length>1&&n.unshift({type:"rect",attrs:{x:h,y:0,width:c-h,height:o.getBounding().height},ignoreEvent:!0})}return n},e.prototype.getFigures=function(t,r){var a,n,o=this.getWidget(),s=o.getPane(),l=s.getChart(),u=s.getAxisComponent(),h=l.getXAxisPane().getAxisComponent(),c=o.getBounding();return(n=(a=t.createXAxisFigures)===null||a===void 0?void 0:a.call(t,{chart:l,overlay:t,coordinates:r,bounding:c,xAxis:h,yAxis:u}))!==null&&n!==void 0?n:[]},e}(ei),oo=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.compare=function(t){return S(t.kLineData)&&t.dataIndex===t.realDataIndex},e.prototype.getDirectionStyles=function(t){return t.vertical},e.prototype.getText=function(t,r){var a,n=(a=t.kLineData)===null||a===void 0?void 0:a.timestamp;return r.getCustomApi().formatDate(n,"YYYY-MM-DD HH:mm",Tt.Crosshair)},e.prototype.getTextAttrs=function(t,r,a,n,o,s){var l=a.realX,u=0,h="center";return l-r/2-s.paddingLeft<0?(u=0,h="left"):l+r/2+s.paddingRight>n.width?(u=n.width,h="right"):u=l,{x:u,y:0,text:t,align:h,baseline:"top"}},e}(ri),so=function(i){L(e,i);function e(t,r){var a=i.call(this,t,r)||this;return a._xAxisView=new ao(a),a._overlayXAxisView=new no(a),a._crosshairVerticalLabelView=new oo(a),a.getContainer().style.cursor="ew-resize",a.addChild(a._overlayXAxisView),a}return e.prototype.getName=function(){return N.X_AXIS},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(ir),lo=function(i){L(e,i);function e(t,r){var a=i.call(this,t)||this;return a.override(r),a}return e.prototype.override=function(t){var r=t.name,a=t.scrollZoomEnabled,n=t.createTicks;G(this.name)||(this.name=r),this.scrollZoomEnabled=a??this.scrollZoomEnabled,this.createTicks=n??this.createTicks},e.prototype.createRangeImp=function(){var t=this.getParent().getChart().getChartStore(),r=t.getVisibleRange(),a=r.from,n=r.to,o=a,s=n-1,l=n-a,u={from:o,to:s,range:l,realFrom:o,realTo:s,realRange:l,displayFrom:o,displayTo:s,displayRange:l};return u},e.prototype.createTicksImp=function(){var t=this,r=this.getParent().getChart().getChartStore(),a=r.getCustomApi().formatDate,n=r.getVisibleRangeTimeTickList(),o=n.map(function(s){var l=s.dataIndex,u=s.weight,h=s.timestamp,c="";switch(u){case pt.Year:{c=a(h,"YYYY",Tt.XAxis);break}case pt.Month:{c=a(h,"YYYY-MM",Tt.XAxis);break}case pt.Day:{c=a(h,"MM-DD",Tt.XAxis);break}case pt.Hour:case pt.Minute:{c=a(h,"HH:mm",Tt.XAxis);break}default:{c=a(h,"HH:mm:ss",Tt.XAxis);break}}return{coord:t.convertToPixel(l),text:c,value:h}});return at(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:o}):o},e.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),r=t.xAxis,a=r.size;if(a!=="auto")return a;var n=t.crosshair,o=0;r.show&&(r.axisLine.show&&(o+=r.axisLine.size),r.tickLine.show&&(o+=r.tickLine.length),r.tickText.show&&(o+=r.tickText.marginStart+r.tickText.marginEnd+r.tickText.size));var s=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(s+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+n.vertical.text.borderSize*2+n.vertical.text.size),Math.max(o,s)},e.prototype.getBounding=function(){return this.getParent().getMainWidget().getBounding()},e.prototype.convertTimestampFromPixel=function(t){var r=this.getParent().getChart().getChartStore(),a=r.coordinateToDataIndex(t);return r.dataIndexToTimestamp(a)},e.prototype.convertTimestampToPixel=function(t){var r=this.getParent().getChart().getChartStore(),a=r.timestampToDataIndex(t);return r.dataIndexToCoordinate(a)},e.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().coordinateToDataIndex(t)},e.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().dataIndexToCoordinate(t)},e.extend=function(t){var r=function(a){L(n,a);function n(o){return a.call(this,o,t)||this}return n}(e);return r},e}(Qr),uo={name:"normal"},Ir={normal:lo.extend(uo)};function ho(i){var e;return(e=Ir[i])!==null&&e!==void 0?e:Ir.normal}var co=function(i){L(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.createAxisComponent=function(t){var r=ho(t);return new r(this)},e.prototype.createMainWidget=function(t){return new so(t,this)},e}(ai);function vo(i,e){var t=0;return function(){var r=Date.now();r-t>e&&(i.apply(this,arguments),t=r)}}var fo=function(i){L(e,i);function e(t,r){var a=i.call(this,t,r)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._bottomPaneHeight=0,a._topPane=null,a._bottomPane=null,a._pressedMouseMoveEvent=vo(a._pressedTouchMouseMoveEvent,20),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return e.prototype.getName=function(){return N.SEPARATOR},e.prototype.checkEventOn=function(){return!0},e.prototype._mouseDownEvent=function(t){var r=this;this._dragFlag=!0,this._dragStartY=t.pageY;var a=this.getPane(),n=a.getChart();this._topPane=a.getTopPane(),this._bottomPane=a.getBottomPane();var o=n.getDrawPanes();if(this._topPane.getOptions().state==="minimize")for(var s=o.findIndex(function(c){var v;return c.getId()===((v=r._topPane)===null||v===void 0?void 0:v.getId())}),l=s-1;l>-1;l--){var u=o[l];if(u.getOptions().state!=="minimize"){this._topPane=u;break}}if(this._bottomPane.getOptions().state==="minimize")for(var s=o.findIndex(function(v){var d;return v.getId()===((d=r._bottomPane)===null||d===void 0?void 0:d.getId())}),l=s+1;l<o.length;l++){var h=o[l];if(h.getOptions().state!=="minimize"){this._bottomPane=h;break}}return this._topPaneHeight=this._topPane.getBounding().height,this._bottomPaneHeight=this._bottomPane.getBounding().height,!0},e.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._topPane=null,this._bottomPane=null,this._topPaneHeight=0,this._bottomPaneHeight=0,this._mouseLeaveEvent()},e.prototype._pressedTouchMouseMoveEvent=function(t){var r=t.pageY-this._dragStartY,a=r<0;if(S(this._topPane)&&S(this._bottomPane)){var n=this._bottomPane.getOptions();if(this._topPane.getOptions().state!=="minimize"&&n.state!=="minimize"&&n.dragEnabled){var o=null,s=null,l=0,u=0;a?(o=this._topPane,s=this._bottomPane,l=this._topPaneHeight,u=this._bottomPaneHeight):(o=this._bottomPane,s=this._topPane,l=this._bottomPaneHeight,u=this._topPaneHeight);var h=o.getOptions().minHeight;if(l>h){var c=Math.max(l-Math.abs(r),h),v=l-c;o.setBounding({height:c}),s.setBounding({height:u+v});var d=this.getPane(),f=d.getChart();f.getChartStore().executeAction(bt.OnPaneDrag,{paneId:d.getId()}),f.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}}}return!0},e.prototype._mouseEnterEvent=function(){var t=this.getPane(),r=t.getBottomPane();if(r.getOptions().dragEnabled){var a=t.getChart(),n=a.getStyles().separator;return this.getContainer().style.background=n.activeBackgroundColor,!0}return!1},e.prototype._mouseLeaveEvent=function(){return this._dragFlag?!1:(this.getContainer().style.background="transparent",!0)},e.prototype.createContainer=function(){return Ot("div",{width:"100%",height:"".concat(ve,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},e.prototype.updateImp=function(t,r,a){if(a===4||a===2){var n=this.getPane().getChart().getStyles().separator;t.style.top="".concat(-Math.floor((ve-n.size)/2),"px"),t.style.height="".concat(ve,"px")}},e}(Yr),Er=function(i){L(e,i);function e(t,r,a,n,o,s){var l=i.call(this,t,r,a,n)||this;return l.getContainer().style.overflow="",l._topPane=o,l._bottomPane=s,l._separatorWidget=new fo(l.getContainer(),l),l}return e.prototype.setBounding=function(t){return Z(this.getBounding(),t),this},e.prototype.getTopPane=function(){return this._topPane},e.prototype.setTopPane=function(t){return this._topPane=t,this},e.prototype.getBottomPane=function(){return this._bottomPane},e.prototype.setBottomPane=function(t){return this._bottomPane=t,this},e.prototype.getWidget=function(){return this._separatorWidget},e.prototype.getImage=function(t){var r=this.getBounding(),a=r.width,n=r.height,o=this.getChart().getStyles().separator,s=Ot("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),l=s.getContext("2d"),u=zt(s);return s.width=a*u,s.height=n*u,l.scale(u,u),l.fillStyle=o.color,l.fillRect(0,0,a,n),s},e.prototype.updateImp=function(t,r,a){if(t===4||t===2){var n=this.getChart().getStyles().separator;r.style.backgroundColor=n.color,r.style.height="".concat(a.height,"px"),r.style.marginLeft="".concat(a.left,"px"),r.style.width="".concat(a.width,"px"),this._separatorWidget.update(t)}},e}(ii);function Tr(){return typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes("firefox")}function Ue(){return typeof window>"u"?!1:/iPhone|iPad|iPod|iOS/.test(window.navigator.userAgent)}var Jt={CancelClick:5,CancelTap:5,DoubleClick:5,DoubleTap:30},ue={Left:0,Middle:1,Right:2},po=10,go=function(){function i(e,t,r){var a=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!Ue(),this._onFirefoxOutsideMouseUp=function(n){a._mouseUpHandler(n)},this._onMobileSafariDoubleClick=function(n){if(a._firesTouchEvents(n)){if(++a._tapCount,a._tapTimeoutId!==null&&a._tapCount>1){var o=a._mouseTouchMoveWithDownInfo(a._getCoordinate(n),a._tapCoordinate).manhattanDistance;o<Jt.DoubleTap&&!a._cancelTap&&a._processEvent(a._makeCompatEvent(n),a._handler.doubleTapEvent),a._resetTapTimeout()}}else if(++a._clickCount,a._clickTimeoutId!==null&&a._clickCount>1){var o=a._mouseTouchMoveWithDownInfo(a._getCoordinate(n),a._clickCoordinate).manhattanDistance;o<Jt.DoubleClick&&!a._cancelClick&&a._processEvent(a._makeCompatEvent(n),a._handler.mouseDoubleClickEvent),a._resetClickTimeout()}},this._target=e,this._handler=t,this._options=r,this._init()}return i.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},i.prototype._mouseEnterHandler=function(e){var t=this,r,a,n;(r=this._unsubscribeMousemove)===null||r===void 0||r.call(this),(a=this._unsubscribeMouseWheel)===null||a===void 0||a.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this);var o=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){t._target.removeEventListener("mousemove",o)},this._target.addEventListener("mousemove",o);var s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){t._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){t._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),!this._firesTouchEvents(e)&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},i.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},i.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},i.prototype._mouseMoveHandler=function(e){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},i.prototype._mouseWheelHandler=function(e){if(Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(!S(this._handler.mouseWheelHortEvent)||(this._preventDefault(e),Math.abs(e.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(e),-e.deltaX)}else{if(!S(this._handler.mouseWheelVertEvent))return;var t=-(e.deltaY/100);if(t===0)return;switch(this._preventDefault(e),e.deltaMode){case e.DOM_DELTA_PAGE:t*=120;break;case e.DOM_DELTA_LINE:t*=32;break}if(t!==0){var r=Math.sign(t)*Math.min(1,Math.abs(t));this._handler.mouseWheelVertEvent(this._makeCompatEvent(e),r)}}},i.prototype._contextMenuHandler=function(e){this._preventDefault(e)},i.prototype._touchMoveHandler=function(e){var t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var r=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._touchMoveStartCoordinate),a=r.xOffset,n=r.yOffset,o=r.manhattanDistance;if(!(!this._touchMoveExceededManhattanDistance&&o<Jt.CancelTap)){if(!this._touchMoveExceededManhattanDistance){var s=a*.5,l=n>=s&&!this._options.treatVertDragAsPageScroll(),u=s>n&&!this._options.treatHorzDragAsPageScroll();!l&&!u&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(e,t),this._handler.touchMoveEvent)}}},i.prototype._mouseMoveWithDownHandler=function(e){if(e.button===ue.Left){var t=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._mouseMoveStartCoordinate),r=t.manhattanDistance;r>=Jt.CancelClick&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.pressedMouseMoveEvent)}},i.prototype._mouseTouchMoveWithDownInfo=function(e,t){var r=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y),n=r+a;return{xOffset:r,yOffset:a,manhattanDistance:n}},i.prototype._touchEndHandler=function(e){var t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null&&e.touches.length===0&&(t=e.changedTouches[0]),t!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var r=this._makeCompatEvent(e,t);if(this._processEvent(r,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){var a=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._tapCoordinate).manhattanDistance;a<Jt.DoubleTap&&!this._cancelTap&&this._processEvent(r,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(r,this._handler.tapEvent),S(this._handler.tapEvent)&&this._preventDefault(e));this._tapCount===0&&this._preventDefault(e),e.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(e))}},i.prototype._mouseUpHandler=function(e){if(e.button===ue.Left){var t=this._makeCompatEvent(e);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),Tr()){var r=this._target.ownerDocument.documentElement;r.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(e))if(this._processEvent(t,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){var a=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate).manhattanDistance;a<Jt.DoubleClick&&!this._cancelClick&&this._processEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(t,this._handler.mouseClickEvent)}},i.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},i.prototype._touchStartHandler=function(e){if(this._activeTouchId===null){var t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(e);var r=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{var a=this._touchMoveHandler.bind(this),n=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){r.removeEventListener("touchmove",a),r.removeEventListener("touchend",n)},r.addEventListener("touchmove",a,{passive:!1}),r.addEventListener("touchend",n,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),500)}this._processEvent(this._makeCompatEvent(e,t),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(t))}},i.prototype._mouseDownHandler=function(e){if(e.button===ue.Right){this._preventDefault(e),this._processEvent(this._makeCompatEvent(e),this._handler.mouseRightClickEvent);return}if(e.button===ue.Left){var t=this._target.ownerDocument.documentElement;Tr()&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{var r=this._mouseMoveWithDownHandler.bind(this),a=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){t.removeEventListener("mousemove",r),t.removeEventListener("mouseup",a)},t.addEventListener("mousemove",r),t.addEventListener("mouseup",a)}this._mousePressed=!0,!this._firesTouchEvents(e)&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(e)))}},i.prototype._init=function(){var e=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{var t=this._target.ownerDocument,r=function(a){e._handler.mouseDownOutsideEvent!=null&&(a.composed&&e._target.contains(a.composedPath()[0])||a.target!==null&&e._target.contains(a.target)||e._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){t.removeEventListener("touchstart",r)},this._unsubscribeOutsideMouseEvents=function(){t.removeEventListener("mousedown",r)},t.addEventListener("mousedown",r),t.addEventListener("touchstart",r,{passive:!0})}Ue()&&(this._unsubscribeMobileSafariEvents=function(){e._target.removeEventListener("dblclick",e._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(a){if(a.button===ue.Middle)return a.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},i.prototype._initPinch=function(){var e=this;!S(this._handler.pinchStartEvent)&&!S(this._handler.pinchEvent)&&!S(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",function(t){e._checkPinchState(t.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(t){if(!(t.touches.length!==2||e._startPinchMiddleCoordinate===null)&&S(e._handler.pinchEvent)){var r=e._getTouchDistance(t.touches[0],t.touches[1]),a=r/e._startPinchDistance;e._handler.pinchEvent(k(k({},e._startPinchMiddleCoordinate),{pageX:0,pageY:0}),a),e._preventDefault(t)}},{passive:!1}),this._target.addEventListener("touchend",function(t){e._checkPinchState(t.touches)}))},i.prototype._checkPinchState=function(e){e.length===1&&(this._pinchPrevented=!1),e.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)},i.prototype._startPinch=function(e){var t=this._target.getBoundingClientRect();this._startPinchMiddleCoordinate={x:(e[0].clientX-t.left+(e[1].clientX-t.left))/2,y:(e[0].clientY-t.top+(e[1].clientY-t.top))/2},this._startPinchDistance=this._getTouchDistance(e[0],e[1]),S(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},i.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,S(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},i.prototype._mouseLeaveHandler=function(e){var t,r,a;(t=this._unsubscribeMousemove)===null||t===void 0||t.call(this),(r=this._unsubscribeMouseWheel)===null||r===void 0||r.call(this),(a=this._unsubscribeContextMenu)===null||a===void 0||a.call(this),!this._firesTouchEvents(e)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!Ue())},i.prototype._longTapHandler=function(e){var t=this._touchWithId(e.touches,this._activeTouchId);t!==null&&(this._processEvent(this._makeCompatEvent(e,t),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},i.prototype._firesTouchEvents=function(e){var t;return S((t=e.sourceCapabilities)===null||t===void 0?void 0:t.firesTouchEvents)?e.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(e)<this._lastTouchEventTimeStamp+500},i.prototype._processEvent=function(e,t){t==null||t.call(this._handler,e)},i.prototype._makeCompatEvent=function(e,t){var r=this,a=t??e,n=this._target.getBoundingClientRect();return{x:a.clientX-n.left,y:a.clientY-n.top,pageX:a.pageX,pageY:a.pageY,isTouch:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click"&&e.type!=="wheel",preventDefault:function(){e.type!=="touchstart"&&r._preventDefault(e)}}},i.prototype._getTouchDistance=function(e,t){var r=e.clientX-t.clientX,a=e.clientY-t.clientY;return Math.sqrt(r*r+a*a)},i.prototype._preventDefault=function(e){e.cancelable&&e.preventDefault()},i.prototype._getCoordinate=function(e){return{x:e.pageX,y:e.pageY}},i.prototype._eventTimeStamp=function(e){var t;return(t=e.timeStamp)!==null&&t!==void 0?t:performance.now()},i.prototype._touchWithId=function(e,t){for(var r=0;r<e.length;++r)if(e[r].identifier===t)return e[r];return null},i}(),mo=function(){function i(e,t){var r=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(a){if(a.shiftKey)switch(a.code){case"Equal":{r._chart.getChartStore().zoom(.5);break}case"Minus":{r._chart.getChartStore().zoom(-.5);break}case"ArrowLeft":{var n=r._chart.getChartStore();n.startScroll(),n.scroll(-3*n.getBarSpace().bar);break}case"ArrowRight":{var n=r._chart.getChartStore();n.startScroll(),n.scroll(3*n.getBarSpace().bar);break}}},this._container=e,this._chart=t,this._event=new go(e,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),e.addEventListener("keydown",this._boundKeyBoardDownEvent)}return i.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},i.prototype.pinchEvent=function(e,t){var r=this._findWidgetByEvent(e),a=r.pane,n=r.widget;if((a==null?void 0:a.getId())!==O.X_AXIS&&(n==null?void 0:n.getName())===N.MAIN){var o=this._makeWidgetEvent(e,n),s=(t-this._pinchScale)*5;return this._pinchScale=t,this._chart.getChartStore().zoom(s,{x:o.x,y:o.y}),!0}return!1},i.prototype.mouseWheelHortEvent=function(e,t){var r=this._chart.getChartStore();return r.startScroll(),r.scroll(t),!0},i.prototype.mouseWheelVertEvent=function(e,t){var r=this._findWidgetByEvent(e).widget,a=this._makeWidgetEvent(e,r),n=r==null?void 0:r.getName();return n===N.MAIN?(this._chart.getChartStore().zoom(t,{x:a.x,y:a.y}),!0):!1},i.prototype.mouseDownEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,a=t.widget;if(this._mouseDownWidget=a,a!==null){var n=this._makeWidgetEvent(e,a),o=a.getName();switch(o){case N.SEPARATOR:return a.dispatchEvent("mouseDownEvent",n);case N.MAIN:{var s=r.getAxisComponent().getRange();return this._prevYAxisRange=k({},s),this._startScrollCoordinate={x:n.x,y:n.y},this._chart.getChartStore().startScroll(),a.dispatchEvent("mouseDownEvent",n)}case N.X_AXIS:{var l=a.dispatchEvent("mouseDownEvent",n);return l&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:n.x,y:n.y},this._xAxisStartScaleDistance=n.pageX,l}case N.Y_AXIS:{var l=a.dispatchEvent("mouseDownEvent",n);l&&this._chart.updatePane(1);var s=r.getAxisComponent().getRange();return this._prevYAxisRange=k({},s),this._yAxisStartScaleDistance=n.pageY,l}}}return!1},i.prototype.mouseMoveEvent=function(e){var t,r,a,n=this._findWidgetByEvent(e),o=n.pane,s=n.widget,l=this._makeWidgetEvent(e,s);if((((t=this._mouseMoveTriggerWidgetInfo.pane)===null||t===void 0?void 0:t.getId())!==(o==null?void 0:o.getId())||((r=this._mouseMoveTriggerWidgetInfo.widget)===null||r===void 0?void 0:r.getName())!==(s==null?void 0:s.getName()))&&(s==null||s.dispatchEvent("mouseEnterEvent",l),(a=this._mouseMoveTriggerWidgetInfo.widget)===null||a===void 0||a.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:o,widget:s}),s!==null){var u=s.getName();switch(u){case N.MAIN:{var h=s.dispatchEvent("mouseMoveEvent",l),c=this._chart.getChartStore(),v={x:l.x,y:l.y,paneId:o==null?void 0:o.getId()};return h&&c.getActiveTooltipIcon()!==null&&(v=void 0,s.getContainer().style.cursor="pointer"),this._chart.getChartStore().setCrosshair(v),h}case N.SEPARATOR:case N.X_AXIS:case N.Y_AXIS:{var h=s.dispatchEvent("mouseMoveEvent",l);return this._chart.getChartStore().setCrosshair(),h}}}return!1},i.prototype.pressedMouseMoveEvent=function(e){var t,r,a;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===N.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",e);var n=this._findWidgetByEvent(e),o=n.pane,s=n.widget;if(s!==null&&((t=this._mouseDownWidget)===null||t===void 0?void 0:t.getPane().getId())===(o==null?void 0:o.getId())&&((r=this._mouseDownWidget)===null||r===void 0?void 0:r.getName())===s.getName()){var l=this._makeWidgetEvent(e,s),u=s.getName();switch(u){case N.MAIN:{var h=s.getBounding(),c=s.dispatchEvent("pressedMouseMoveEvent",l);if(!c&&this._startScrollCoordinate!==null){var v=o.getAxisComponent();if(this._prevYAxisRange!==null&&!v.getAutoCalcTickFlag()&&v.scrollZoomEnabled){var d=this._prevYAxisRange,f=d.from,g=d.to,p=d.range,m=0;v.reverse?m=this._startScrollCoordinate.y-l.y:m=l.y-this._startScrollCoordinate.y;var _=m/h.height,y=p*_,b=f+y,x=g+y,C=v.valueToRealValue(b,{range:this._prevYAxisRange}),w=v.valueToRealValue(x,{range:this._prevYAxisRange}),E=v.realValueToDisplayValue(C,{range:this._prevYAxisRange}),I=v.realValueToDisplayValue(w,{range:this._prevYAxisRange});v.setRange({from:b,to:x,range:x-b,realFrom:C,realTo:w,realRange:w-C,displayFrom:E,displayTo:I,displayRange:I-E})}var P=l.x-this._startScrollCoordinate.x;this._chart.getChartStore().scroll(P)}return this._chart.getChartStore().setCrosshair({x:l.x,y:l.y,paneId:o==null?void 0:o.getId()}),c}case N.X_AXIS:{var c=s.dispatchEvent("pressedMouseMoveEvent",l);if(c)this._chart.updatePane(1);else{var T=o.getAxisComponent();if(T.scrollZoomEnabled){var _=this._xAxisStartScaleDistance/l.pageX;if(Number.isFinite(_)){var D=(_-this._xAxisScale)*10;this._xAxisScale=_,this._chart.getChartStore().zoom(D,(a=this._xAxisStartScaleCoordinate)!==null&&a!==void 0?a:void 0)}}}return c}case N.Y_AXIS:{var c=s.dispatchEvent("pressedMouseMoveEvent",l);if(c)this._chart.updatePane(1);else{var v=o.getAxisComponent();if(this._prevYAxisRange!==null&&v.scrollZoomEnabled){var A=this._prevYAxisRange,f=A.from,g=A.to,p=A.range,_=l.pageY/this._yAxisStartScaleDistance,M=p*_,y=(M-p)/2,b=f-y,x=g+y,C=v.valueToRealValue(b,{range:this._prevYAxisRange}),w=v.valueToRealValue(x,{range:this._prevYAxisRange}),E=v.realValueToDisplayValue(C,{range:this._prevYAxisRange}),I=v.realValueToDisplayValue(w,{range:this._prevYAxisRange});v.setRange({from:b,to:x,range:M,realFrom:C,realTo:w,realRange:w-C,displayFrom:E,displayTo:I,displayRange:I-E}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})}}return c}}}return!1},i.prototype.mouseUpEvent=function(e){var t=this._findWidgetByEvent(e).widget,r=!1;if(t!==null){var a=this._makeWidgetEvent(e,t),n=t.getName();switch(n){case N.MAIN:case N.SEPARATOR:case N.X_AXIS:case N.Y_AXIS:{r=t.dispatchEvent("mouseUpEvent",a);break}}r&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,r},i.prototype.mouseClickEvent=function(e){var t=this._findWidgetByEvent(e).widget;if(t!==null){var r=this._makeWidgetEvent(e,t);return t.dispatchEvent("mouseClickEvent",r)}return!1},i.prototype.mouseRightClickEvent=function(e){var t=this._findWidgetByEvent(e).widget,r=!1;if(t!==null){var a=this._makeWidgetEvent(e,t),n=t.getName();switch(n){case N.MAIN:case N.X_AXIS:case N.Y_AXIS:{r=t.dispatchEvent("mouseRightClickEvent",a);break}}r&&this._chart.updatePane(1)}return!1},i.prototype.mouseDoubleClickEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,a=t.widget;if(a!==null){var n=a.getName();switch(n){case N.MAIN:{var o=this._makeWidgetEvent(e,a);return a.dispatchEvent("mouseDoubleClickEvent",o)}case N.Y_AXIS:{var s=r.getAxisComponent();if(!s.getAutoCalcTickFlag())return s.setAutoCalcTickFlag(!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),!0;break}}}return!1},i.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().setCrosshair(),!0},i.prototype.touchStartEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,a=t.widget;if(a!==null){var n=this._makeWidgetEvent(e,a),o=a.getName();switch(o){case N.MAIN:{var s=this._chart.getChartStore();if(a.dispatchEvent("mouseDownEvent",n))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,s.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(pr(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:n.x,y:n.y},s.startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var l=n.x-this._touchCoordinate.x,u=n.y-this._touchCoordinate.y,h=Math.sqrt(l*l+u*u);h<po?(this._touchCoordinate={x:n.x,y:n.y},s.setCrosshair({x:n.x,y:n.y,paneId:r==null?void 0:r.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,s.setCrosshair())}return!0}case N.X_AXIS:case N.Y_AXIS:{var c=a.dispatchEvent("mouseDownEvent",n);return c&&this._chart.updatePane(1),c}}}return!1},i.prototype.touchMoveEvent=function(e){var t,r,a,n=this._findWidgetByEvent(e),o=n.pane,s=n.widget;if(s!==null){var l=this._makeWidgetEvent(e,s),u=s.getName(),h=this._chart.getChartStore();switch(u){case N.MAIN:{if(s.dispatchEvent("pressedMouseMoveEvent",l))return(t=l.preventDefault)===null||t===void 0||t.call(l),h.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(r=l.preventDefault)===null||r===void 0||r.call(l),h.setCrosshair({x:l.x,y:l.y,paneId:o==null?void 0:o.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var c=l.x-this._startScrollCoordinate.x;h.scroll(c)}return!0}case N.X_AXIS:case N.Y_AXIS:{var v=s.dispatchEvent("pressedMouseMoveEvent",l);return v&&((a=l.preventDefault)===null||a===void 0||a.call(l),this._chart.updatePane(1)),v}}}return!1},i.prototype.touchEndEvent=function(e){var t=this,r=this._findWidgetByEvent(e).widget;if(r!==null){var a=this._makeWidgetEvent(e,r),n=r.getName();switch(n){case N.MAIN:{if(r.dispatchEvent("mouseUpEvent",a),this._startScrollCoordinate!==null){var o=new Date().getTime()-this._flingStartTime,s=a.x-this._startScrollCoordinate.x,l=s/(o>0?o:1)*20;if(o<200&&Math.abs(l)>0){var u=this._chart.getChartStore(),h=function(){t._flingScrollRequestId=Be(function(){u.startScroll(),u.scroll(l),l=l*(1-.025),Math.abs(l)<1?t._flingScrollRequestId!==null&&(pr(t._flingScrollRequestId),t._flingScrollRequestId=null):h()})};h()}}return!0}case N.X_AXIS:case N.Y_AXIS:{var c=r.dispatchEvent("mouseUpEvent",a);c&&this._chart.updatePane(1)}}}return!1},i.prototype.tapEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,a=t.widget,n=!1;if(a!==null){var o=this._makeWidgetEvent(e,a),s=a.dispatchEvent("mouseClickEvent",o);if(a.getName()===N.MAIN){var l=this._makeWidgetEvent(e,a),u=this._chart.getChartStore();s?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,u.setCrosshair(void 0,!0),n=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},u.setCrosshair({x:l.x,y:l.y,paneId:r==null?void 0:r.getId()},!0),n=!0),this._touchCancelCrosshair=!1)}(n||s)&&this._chart.updatePane(1)}return n},i.prototype.doubleTapEvent=function(e){return this.mouseDoubleClickEvent(e)},i.prototype.longTapEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,a=t.widget;if(a!==null&&a.getName()===N.MAIN){var n=this._makeWidgetEvent(e,a);return this._touchCoordinate={x:n.x,y:n.y},this._chart.getChartStore().setCrosshair({x:n.x,y:n.y,paneId:r==null?void 0:r.getId()}),!0}return!1},i.prototype._findWidgetByEvent=function(e){var t,r,a,n,o=e.x,s=e.y,l=this._chart.getSeparatorPanes(),u=this._chart.getStyles().separator.size;try{for(var h=lt(l),c=h.next();!c.done;c=h.next()){var v=Bt(c.value,2),d=v[1],f=d.getBounding(),g=f.top-Math.round((ve-u)/2);if(o>=f.left&&o<=f.left+f.width&&s>=g&&s<=g+ve)return{pane:d,widget:d.getWidget()}}}catch(P){t={error:P}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}var p=this._chart.getDrawPanes(),m=null;try{for(var _=lt(p),y=_.next();!y.done;y=_.next()){var b=y.value,f=b.getBounding();if(o>=f.left&&o<=f.left+f.width&&s>=f.top&&s<=f.top+f.height){m=b;break}}}catch(P){a={error:P}}finally{try{y&&!y.done&&(n=_.return)&&n.call(_)}finally{if(a)throw a.error}}var x=null;if(m!==null){if(!S(x)){var C=m.getMainWidget(),w=C.getBounding();o>=w.left&&o<=w.left+w.width&&s>=w.top&&s<=w.top+w.height&&(x=C)}if(!S(x)){var E=m.getYAxisWidget();if(E!==null){var I=E.getBounding();o>=I.left&&o<=I.left+I.width&&s>=I.top&&s<=I.top+I.height&&(x=E)}}}return{pane:m,widget:x}},i.prototype._makeWidgetEvent=function(e,t){var r,a,n,o=(r=t==null?void 0:t.getBounding())!==null&&r!==void 0?r:null;return k(k({},e),{x:e.x-((a=o==null?void 0:o.left)!==null&&a!==void 0?a:0),y:e.y-((n=o==null?void 0:o.top)!==null&&n!==void 0?n:0)})},i.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},i}(),It;(function(i){i.Root="root",i.Main="main",i.YAxis="yAxis"})(It||(It={}));var oi=function(){function i(e,t){this._chartBounding=Fe(),this._drawPanes=[],this._separatorPanes=new Map,this._layoutOptions={measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!1,forceBuildYAxisTick:!1},this._layoutPending=!1,this._initContainer(e),this._chartEvent=new mo(this._chartContainer,this),this._chartStore=new _n(this,t),this._initPanes(t),this._layout()}return i.prototype._initContainer=function(e){this._container=e,this._chartContainer=Ot("div",{position:"relative",width:"100%",height:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",overflow:"hidden",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,e.appendChild(this._chartContainer),this._cacheChartBounding()},i.prototype._cacheChartBounding=function(){this._chartBounding.width=Math.floor(this._chartContainer.clientWidth),this._chartBounding.height=Math.floor(this._chartContainer.clientHeight)},i.prototype._initPanes=function(e){var t=this,r,a=(r=e==null?void 0:e.layout)!==null&&r!==void 0?r:[{type:"candle"}],n=function(s){var l,u;if(!S(t._candlePane)){var h=(l=s.options)!==null&&l!==void 0?l:{};Z(h,{id:O.CANDLE}),t._candlePane=t._createPane(io,O.CANDLE,h);var c=(u=s.content)!==null&&u!==void 0?u:[];c.forEach(function(v){t.createIndicator(v,!0,h)})}},o=function(s){if(!S(t._xAxisPane)){var l=t._createPane(co,O.X_AXIS,s??{});t._xAxisPane=l}};a.forEach(function(s){var l;switch(s.type){case"candle":{n(s);break}case"indicator":{var u=(l=s.content)!==null&&l!==void 0?l:[];if(u.length>0){var h=null;u.forEach(function(c){S(h)?t.createIndicator(c,!0,{id:h}):h=t.createIndicator(c,!0,s.options)})}break}case"xAxis":{o(s.options);break}}}),n({}),o({order:Number.MAX_SAFE_INTEGER})},i.prototype._createPane=function(e,t,r){var a,n,o,s=null,l=null,u=(a=r==null?void 0:r.order)!==null&&a!==void 0?a:0,h=this._drawPanes.length;if(h>0&&(u<this._drawPanes[0].getOptions().order&&(l=new e(this._chartContainer,this._drawPanes[0].getContainer(),this,t,r??{}),s=0),!S(l)))for(var c=1;c<this._drawPanes.length;c++){var v=this._drawPanes[c-1],d=this._drawPanes[c];if(u>=v.getOptions().order&&u<d.getOptions().order){var f=null;d.getId()!==O.X_AXIS?f=(o=(n=this._separatorPanes.get(d))===null||n===void 0?void 0:n.getContainer())!==null&&o!==void 0?o:null:f=d.getContainer(),l=new e(this._chartContainer,f,this,t,r??{}),s=c;break}}S(l)||(l=new e(this._chartContainer,null,this,t,r??{}));var g=0;if(F(s)?(this._drawPanes.splice(s,0,l),g=s):(this._drawPanes.push(l),g=this._drawPanes.length-1),l.getId()!==O.X_AXIS){var p=this._drawPanes[g+1];if(S(p)&&p.getId()===O.X_AXIS&&(p=this._drawPanes[g+2]),S(p)){var m=this._separatorPanes.get(p);S(m)?m.setTopPane(l):(m=new Er(this._chartContainer,p.getContainer(),this,"",l,p),this._separatorPanes.set(p,m))}var v=this._drawPanes[g-1];if(S(v)&&v.getId()===O.X_AXIS&&(v=this._drawPanes[g-2]),S(v)){var m=new Er(this._chartContainer,l.getContainer(),this,"",v,l);this._separatorPanes.set(l,m)}}return l},i.prototype._recalculatePaneHeight=function(e,t,r){if(r===0)return!1;var a=this._drawPanes.filter(function(c){var v=c.getId();return c.getOptions().state==="normal"&&v!==e.getId()&&v!==O.X_AXIS}),n=a.length;if(n===0)return!1;if(e.getId()!==O.CANDLE&&S(this._candlePane)&&this._candlePane.getOptions().state==="normal"){var o=this._candlePane.getBounding().height;if(o>0){var s=this._candlePane.getOptions().minHeight,l=o+r;l<s&&(l=s,t-=o+r-l),this._candlePane.setBounding({height:l})}}else{var u=r,h=Math.floor(r/n);a.forEach(function(c,v){var d=c.getBounding().height,f=0;v===n-1?f=d+u:f=d+h,f<c.getOptions().minHeight&&(f=c.getOptions().minHeight),c.setBounding({height:f}),u-=f-d}),Math.abs(u)>0&&(t-=u)}return e.setBounding({height:t}),!0},i.prototype.getDrawPaneById=function(e){if(e===O.CANDLE)return this._candlePane;if(e===O.X_AXIS)return this._xAxisPane;var t=this._drawPanes.find(function(r){return r.getId()===e});return t??null},i.prototype.getContainer=function(){return this._container},i.prototype.getChartStore=function(){return this._chartStore},i.prototype.getXAxisPane=function(){return this._xAxisPane},i.prototype.getDrawPanes=function(){return this._drawPanes},i.prototype.getSeparatorPanes=function(){return this._separatorPanes},i.prototype.layout=function(e){var t=this,r,a,n,o,s;(r=e.measureHeight)!==null&&r!==void 0&&r&&(this._layoutOptions.measureHeight=e.measureHeight),(a=e.measureWidth)!==null&&a!==void 0&&a&&(this._layoutOptions.measureWidth=e.measureWidth),(n=e.update)!==null&&n!==void 0&&n&&(this._layoutOptions.update=e.update),(o=e.buildYAxisTick)!==null&&o!==void 0&&o&&(this._layoutOptions.buildYAxisTick=e.buildYAxisTick),(s=e.buildYAxisTick)!==null&&s!==void 0&&s&&(this._layoutOptions.forceBuildYAxisTick=e.forceBuildYAxisTick),this._layoutPending||(this._layoutPending=!0,Promise.resolve().then(function(l){t._layout(),t._layoutPending=!1}).catch(function(l){}))},i.prototype._layout=function(){var e=this,t=this._layoutOptions,r=t.measureHeight,a=t.measureWidth,n=t.update,o=t.buildYAxisTick,s=t.forceBuildYAxisTick;if(r){var l=this._chartBounding.height,u=this.getStyles().separator.size,h=this._xAxisPane.getAxisComponent().getAutoSize(),c=l-h;c<0&&(c=0),this._drawPanes.forEach(function(A){var M=A.getId();if(S(e._separatorPanes.get(A))&&(c-=u),M!==O.X_AXIS&&M!==O.CANDLE&&A.getVisible()){var R=A.getBounding().height;R>c?(R=c,c=0):c-=R,A.setBounding({height:R})}}),this._candlePane.setBounding({height:Math.max(c,0)}),this._xAxisPane.setBounding({height:h});var v=0;this._drawPanes.forEach(function(A){var M=e._separatorPanes.get(A);S(M)&&(M.setBounding({height:u,top:v}),v+=u),A.setBounding({top:v}),v+=A.getBounding().height})}var d=a;if((o||s)&&this._drawPanes.forEach(function(A){var M=A.getAxisComponent().buildTicks(s);d||(d=M)}),d){var f=this._chartBounding.width,g=this.getStyles(),p=0,m=!0,_=0,y=!0;this._drawPanes.forEach(function(A){if(A.getId()!==O.X_AXIS){var M=A.getAxisComponent(),R=M.inside,B=M.getAutoSize();M.position===Ft.Left?(p=Math.max(p,B),R&&(m=!1)):(_=Math.max(_,B),R&&(y=!1))}});var b=f,x=0,C=0;m&&(b-=p,x=p),y&&(b-=_,C=_),this._chartStore.setTotalBarSpace(b);var w={width:f},E={width:b,left:x,right:C},I={width:p},P={width:_},T=g.separator.fill,D={};T?D=w:D=E,this._drawPanes.forEach(function(A){var M;(M=e._separatorPanes.get(A))===null||M===void 0||M.setBounding(D),A.setBounding(w,E,I,P)})}n&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4)),this._layoutOptions={measureHeight:!1,measureWidth:!1,update:!1,buildYAxisTick:!1,forceBuildYAxisTick:!1}},i.prototype.updatePane=function(e,t){var r=this;if(S(t)){var a=this.getDrawPaneById(t);a==null||a.update(e)}else this._drawPanes.forEach(function(n){var o;n.update(e),(o=r._separatorPanes.get(n))===null||o===void 0||o.update(e)})},i.prototype.crosshairChange=function(e){var t=this;if(this._chartStore.hasAction(bt.OnCrosshairChange)){var r={};this._drawPanes.forEach(function(a){var n=a.getId(),o={},s=t._chartStore.getIndicatorsByPaneId(n);s.forEach(function(l){var u,h=l.result;o[l.name]=h[(u=e.dataIndex)!==null&&u!==void 0?u:h.length-1]}),r[n]=o}),G(e.paneId)&&this._chartStore.executeAction(bt.OnCrosshairChange,k(k({},e),{indicatorData:r}))}},i.prototype.getDom=function(e,t){var r,a;if(S(e)){var n=this.getDrawPaneById(e);if(S(n)){var o=t??It.Root;switch(o){case It.Root:return n.getContainer();case It.Main:return n.getMainWidget().getContainer();case It.YAxis:return(a=(r=n.getYAxisWidget())===null||r===void 0?void 0:r.getContainer())!==null&&a!==void 0?a:null}}}else return this._chartContainer;return null},i.prototype.getSize=function(e,t){var r,a;if(S(e)){var n=this.getDrawPaneById(e);if(S(n)){var o=t??It.Root;switch(o){case It.Root:return n.getBounding();case It.Main:return n.getMainWidget().getBounding();case It.YAxis:return(a=(r=n.getYAxisWidget())===null||r===void 0?void 0:r.getBounding())!==null&&a!==void 0?a:null}}}else return this._chartBounding;return null},i.prototype.setPrecision=function(e){this._chartStore.setPrecision(e)},i.prototype.getPrecision=function(){return this._chartStore.getPrecision()},i.prototype.setStyles=function(e){var t=this;this._setOptions(function(){t._chartStore.setStyles(e)})},i.prototype.getStyles=function(){return this._chartStore.getStyles()},i.prototype.setCustomApi=function(e){var t=this;this._setOptions(function(){t._chartStore.setCustomApi(e)})},i.prototype.getCustomApi=function(){return this._chartStore.getCustomApi()},i.prototype.setLocale=function(e){var t=this;this._setOptions(function(){t._chartStore.setLocale(e)})},i.prototype.getLocale=function(){return this._chartStore.getLocale()},i.prototype.setTimezone=function(e){var t=this;this._setOptions(function(){t._chartStore.setTimezone(e)})},i.prototype.getTimezone=function(){return this._chartStore.getTimezone()},i.prototype.setThousandsSeparator=function(e){var t=this;this._setOptions(function(){t._chartStore.setThousandsSeparator(e)})},i.prototype.getThousandsSeparator=function(){return this._chartStore.getThousandsSeparator()},i.prototype.setDecimalFold=function(e){var t=this;this._setOptions(function(){t._chartStore.setDecimalFold(e)})},i.prototype.getDecimalFold=function(){return this._chartStore.getDecimalFold()},i.prototype._setOptions=function(e){e(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},i.prototype.setOffsetRightDistance=function(e){this._chartStore.setOffsetRightDistance(e,!0)},i.prototype.getOffsetRightDistance=function(){return this._chartStore.getOffsetRightDistance()},i.prototype.setMaxOffsetLeftDistance=function(e){e<0||this._chartStore.setMaxOffsetLeftDistance(e)},i.prototype.setMaxOffsetRightDistance=function(e){e<0||this._chartStore.setMaxOffsetRightDistance(e)},i.prototype.setLeftMinVisibleBarCount=function(e){e<0||this._chartStore.setLeftMinVisibleBarCount(Math.ceil(e))},i.prototype.setRightMinVisibleBarCount=function(e){e<0||this._chartStore.setRightMinVisibleBarCount(Math.ceil(e))},i.prototype.setBarSpace=function(e){this._chartStore.setBarSpace(e)},i.prototype.getBarSpace=function(){return this._chartStore.getBarSpace()},i.prototype.getVisibleRange=function(){return this._chartStore.getVisibleRange()},i.prototype.clearData=function(){this._chartStore.clearData()},i.prototype.getDataList=function(){return this._chartStore.getDataList()},i.prototype.applyNewData=function(e,t){this._drawPanes.forEach(function(a){a.getAxisComponent().setAutoCalcTickFlag(!0)});var r={forward:!1,backward:!1};Ne(t)?(r.forward=t,r.backward=t):r=k(k({},r),t),this._chartStore.addData(e,st.Init,r)},i.prototype.updateData=function(e){this._chartStore.addData(e,st.Update)},i.prototype.setLoadMoreDataCallback=function(e){this._chartStore.setLoadMoreDataCallback(e)},i.prototype.createIndicator=function(e,t,r){var a,n=G(e)?{name:e}:e;if(Vr(n.name)===null)return null;var o=k({},r);G(o.id)||(o.id=Br(O.INDICATOR));var s=this.getDrawPaneById(o.id);S(s)||(s=this._createPane(ni,o.id,o),(a=o.height)!==null&&a!==void 0||(o.height=Hr)),this.setPaneOptions(o);var l=this._chartStore.addIndicator(n,o.id,t??!1);return l&&this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0}),o.id},i.prototype.overrideIndicator=function(e,t){return this._chartStore.overrideIndicator(e,t)},i.prototype.getIndicators=function(e){return this._chartStore.getIndicatorsByFilter(e??{})},i.prototype.removeIndicator=function(e){var t=this,r=this._chartStore.removeIndicator(e??{});if(r){var a=!1,n=[];this._drawPanes.forEach(function(o){var s=o.getId();s!==O.CANDLE&&s!==O.X_AXIS&&n.push(s)}),n.forEach(function(o){var s,l,u;if(!t._chartStore.hasIndicators(o)){var h=t._drawPanes.findIndex(function(_){return _.getId()===o}),c=t._drawPanes[h];if(S(c)){a=!0;var v=t._separatorPanes.get(c);if(S(v)){var d=v.getTopPane();try{for(var f=lt(t._separatorPanes),g=f.next();!g.done;g=f.next()){var p=g.value;if(p[1].getTopPane().getId()===o){p[1].setTopPane(d);break}}}catch(_){s={error:_}}finally{try{g&&!g.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}v.destroy(),t._separatorPanes.delete(c)}t._recalculatePaneHeight(c,0,c.getBounding().height),t._drawPanes.splice(h,1),c.destroy();var m=t._drawPanes[0];S(m)&&m.getId()===O.X_AXIS&&(m=t._drawPanes[1]),(u=t._separatorPanes.get(m))===null||u===void 0||u.destroy(),t._separatorPanes.delete(m)}}}),this._drawPanes.length===2&&(this._candlePane.setVisible(!0),this._candlePane.setBounding({height:this._chartBounding.height-this._xAxisPane.getBounding().height})),this.layout({measureHeight:a,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}return r},i.prototype.createOverlay=function(e){var t=this,r=[],a=[],n=function(s){!S(s.paneId)||t.getDrawPaneById(s.paneId)===null?(s.paneId=O.CANDLE,a.push(!1)):a.push(!0),r.push(s)};G(e)?n({name:e}):Rt(e)?e.forEach(function(s){var l=null;G(s)?l={name:s}:l=s,n(l)}):n(e);var o=this._chartStore.addOverlays(r,a);return Rt(e)?o:o[0]},i.prototype.getOverlays=function(e){return this._chartStore.getOverlaysByFilter(e??{})},i.prototype.overrideOverlay=function(e){return this._chartStore.overrideOverlay(e)},i.prototype.removeOverlay=function(e){return this._chartStore.removeOverlay(e??{})},i.prototype.setPaneOptions=function(e){var t,r,a=this,n,o=!1,s=!1,l=S(e.id),u=function(g){var p=g.getId();if(l&&e.id===p||!l){if(p!==O.X_AXIS){if(F(e.height)&&e.height>0){var m=Math.max((n=e.minHeight)!==null&&n!==void 0?n:g.getOptions().minHeight,0),_=Math.max(m,e.height);s=!0,o=!0,g.setOriginalBounding({height:_}),h._recalculatePaneHeight(g,_,-_)}if(S(e.state)&&g.getOptions().state!==e.state){o=!0,s=!0;var y=e.state;switch(y){case"maximize":{var b=h._drawPanes.find(function(I){var P=I.getId();return I.getOptions().state==="maximize"&&P!==O.X_AXIS});if(!S(b)){g.getOptions().state==="normal"&&g.setOriginalBounding({height:g.getBounding().height}),g.setOptions({state:y});var x=h._chartBounding.height;g.setBounding({height:x-h._xAxisPane.getBounding().height}),h._drawPanes.forEach(function(I){var P;I.getId()!==O.X_AXIS&&I.getId()!==p&&(I.setBounding({height:I.getOriginalBounding().height}),I.setVisible(!1),(P=a._separatorPanes.get(I))===null||P===void 0||P.setVisible(!1))})}break}case"minimize":{var _=g.getBounding().height,C=g.getOptions().state,w=_-Ee;C==="maximize"&&(w=g.getOriginalBounding().height-Ee),h._recalculatePaneHeight(g,Ee,w)&&(C==="normal"&&g.setOriginalBounding({height:_}),g.setOptions({state:y})),h._drawPanes.forEach(function(P){var T;P.getId()!==O.X_AXIS&&(P.setVisible(!0),(T=a._separatorPanes.get(P))===null||T===void 0||T.setVisible(!0))});break}default:{var _=g.getOriginalBounding().height;h._recalculatePaneHeight(g,_,g.getBounding().height-_)&&g.setOptions({state:y}),h._drawPanes.forEach(function(P){var T;P.getId()!==O.X_AXIS&&(P.setVisible(!0),(T=a._separatorPanes.get(P))===null||T===void 0||T.setVisible(!0))});break}}}}S(e.axis)&&(s=!0);var E=k({},e);if(delete E.state,g.setOptions(E),p===e.id)return"break"}},h=this;try{for(var c=lt(this._drawPanes),v=c.next();!v.done;v=c.next()){var d=v.value,f=u(d);if(f==="break")break}}catch(g){t={error:g}}finally{try{v&&!v.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}s&&this.layout({measureHeight:o,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},i.prototype.getPaneOptions=function(e){var t;if(S(e)){var r=this.getDrawPaneById(e);return(t=r==null?void 0:r.getOptions())!==null&&t!==void 0?t:null}return this._drawPanes.map(function(a){return a.getOptions()})},i.prototype.setZoomEnabled=function(e){this._chartStore.setZoomEnabled(e)},i.prototype.isZoomEnabled=function(){return this._chartStore.isZoomEnabled()},i.prototype.setScrollEnabled=function(e){this._chartStore.setScrollEnabled(e)},i.prototype.isScrollEnabled=function(){return this._chartStore.isScrollEnabled()},i.prototype.scrollByDistance=function(e,t){var r=this,a=F(t)&&t>0?t:0;if(this._chartStore.startScroll(),a>0){var n=new qe({duration:a});n.doFrame(function(o){var s=e*(o/a);r._chartStore.scroll(s)}),n.start()}else this._chartStore.scroll(e)},i.prototype.scrollToRealTime=function(e){var t=this._chartStore.getBarSpace().bar,r=this._chartStore.getLastBarRightSideDiffBarCount()-this._chartStore.getInitialOffsetRightDistance()/t,a=r*t;this.scrollByDistance(a,e)},i.prototype.scrollToDataIndex=function(e,t){var r=(this._chartStore.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-e))*this._chartStore.getBarSpace().bar;this.scrollByDistance(r,t)},i.prototype.scrollToTimestamp=function(e,t){var r=Ke(this.getDataList(),"timestamp",e);this.scrollToDataIndex(r,t)},i.prototype.zoomAtCoordinate=function(e,t,r){var a=this,n=F(r)&&r>0?r:0,o=this._chartStore.getBarSpace().bar,s=o*e,l=s-o;if(n>0){var u=0,h=new qe({duration:n});h.doFrame(function(c){var v=l*(c/n),d=(v-u)/a._chartStore.getBarSpace().bar*Je;a._chartStore.zoom(d,t),u=v}),h.start()}else this._chartStore.zoom(l/o*Je,t)},i.prototype.zoomAtDataIndex=function(e,t,r){var a=this._chartStore.dataIndexToCoordinate(t);this.zoomAtCoordinate(e,{x:a,y:0},r)},i.prototype.zoomAtTimestamp=function(e,t,r){var a=Ke(this.getDataList(),"timestamp",t);this.zoomAtDataIndex(e,a,r)},i.prototype.convertToPixel=function(e,t){var r=this,a,n=t??{},o=n.paneId,s=o===void 0?O.CANDLE:o,l=n.absolute,u=l===void 0?!1:l,h=[];if(s!==O.X_AXIS){var c=this.getDrawPaneById(s);if(c!==null){var v=c.getBounding(),d=new Array().concat(e),f=this._xAxisPane.getAxisComponent(),g=c.getAxisComponent();h=d.map(function(p){var m={},_=p.dataIndex;if(F(p.timestamp)&&(_=r._chartStore.timestampToDataIndex(p.timestamp)),F(_)&&(m.x=f.convertToPixel(_)),F(p.value)){var y=g.convertToPixel(p.value);m.y=u?v.top+y:y}return m})}}return Rt(e)?h:(a=h[0])!==null&&a!==void 0?a:{}},i.prototype.convertFromPixel=function(e,t){var r=this,a,n=t??{},o=n.paneId,s=o===void 0?O.CANDLE:o,l=n.absolute,u=l===void 0?!1:l,h=[];if(s!==O.X_AXIS){var c=this.getDrawPaneById(s);if(c!==null){var v=c.getBounding(),d=new Array().concat(e),f=this._xAxisPane.getAxisComponent(),g=c.getAxisComponent();h=d.map(function(p){var m,_={};if(F(p.x)){var y=f.convertFromPixel(p.x);_.dataIndex=y,_.timestamp=(m=r._chartStore.dataIndexToTimestamp(y))!==null&&m!==void 0?m:void 0}if(F(p.y)){var b=u?p.y-v.top:p.y;_.value=g.convertFromPixel(b)}return _})}}return Rt(e)?h:(a=h[0])!==null&&a!==void 0?a:{}},i.prototype.executeAction=function(e,t){var r;switch(e){case bt.OnCrosshairChange:{var a=k({},t);a.paneId=(r=a.paneId)!==null&&r!==void 0?r:O.CANDLE,this._chartStore.setCrosshair(a);break}}},i.prototype.subscribeAction=function(e,t){this._chartStore.subscribeAction(e,t)},i.prototype.unsubscribeAction=function(e,t){this._chartStore.unsubscribeAction(e,t)},i.prototype.getConvertPictureUrl=function(e,t,r){var a=this,n=this._chartBounding,o=n.width,s=n.height,l=Ot("canvas",{width:"".concat(o,"px"),height:"".concat(s,"px"),boxSizing:"border-box"}),u=l.getContext("2d"),h=zt(l);l.width=o*h,l.height=s*h,u.scale(h,h),u.fillStyle=r??"#FFFFFF",u.fillRect(0,0,o,s);var c=e??!1;return this._drawPanes.forEach(function(v){var d=a._separatorPanes.get(v);if(S(d)){var f=d.getBounding();u.drawImage(d.getImage(c),f.left,f.top,f.width,f.height)}var g=v.getBounding();u.drawImage(v.getImage(c),0,g.top,o,g.height)}),l.toDataURL("image/".concat(t??"jpeg"))},i.prototype.resize=function(){this._cacheChartBounding(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},i.prototype.destroy=function(){var e=this;this._chartEvent.destroy(),this._drawPanes.forEach(function(t){var r;t.destroy(),(r=e._separatorPanes.get(t))===null||r===void 0||r.destroy()}),this._drawPanes=[],this._separatorPanes.clear(),this._container.removeChild(this._chartContainer)},i}(),Le=new Map,_o=1;function yo(i,e){var t=null;if(G(i)?t=document.getElementById(i):t=i,t===null)return null;var r=Le.get(t.id);if(S(r))return r;var a="k_line_chart_".concat(_o++);return r=new oi(t,e),r.id=a,t.setAttribute("k-line-chart-id",a),Le.set(a,r),r}function Pr(i){var e,t,r=null;if(i instanceof oi)r=i.id;else{var a=null;G(i)?a=document.getElementById(i):a=i,r=(e=a==null?void 0:a.getAttribute("k-line-chart-id"))!==null&&e!==void 0?e:null}r!==null&&((t=Le.get(r))===null||t===void 0||t.destroy(),Le.delete(r))}const bo={class:"flex-auto flex flex-col"},xo={class:"type-ul"},Co=["onClick"],wo={id:"k-line-chart",style:{width:"100%","min-height":"780px"},class:"overflow-auto flex-auto"},So={__name:"Chart",props:{setSub:{type:Function,required:!0},symbolInfo:{type:Object,default:()=>{}},unsubscribeChannel:{type:Function,required:!1},isSpot:{type:Boolean,default:!1},useEuropeanFormat:{type:Boolean,default:!0}},setup(i){const e=i,t=mt("1m"),r=async p=>{t.value=p.id,c()},a=mt([{id:"1m",name:"1m"},{id:"5m",name:"5m"},{id:"15m",name:"15m"},{id:"30m",name:"30m"},{id:"1d",name:"1d"},{id:"1w",name:"1w"},{id:"1M",name:"1M"}]),n=mt([{id:"MA",name:"MA"},{id:"RSI",name:"RSI"},{id:"MACD",name:"MACD"},{id:"BOLL",name:"BOLL"},{id:"KDJ",name:"KDJ"},{id:"OBV",name:"OBV"},{id:"SAR",name:"SAR"}]);let o=mt(!1);const s=["open","high","low","close","volume"],l=mt(null);let u=null;const h=p=>{if(o.value)return;const m=p.data;if(m.interval===t.value){if(m.symbol=="ulxusdc"&&m.interval=="1M"&&m.time_line=="1756684800000"&&(m.open=.361,m.low=.361),m.timestamp=Number(m.time_line),s.forEach(_=>{m[_]=Number(m[_])}),m.open!==u){const _=m.open,y=m.high,b=m.low;m.open=u,y!==_?m.high=Math.max(m.open,m.close,y):m.high=Math.max(m.open,m.close),b!==_?m.low=Math.min(m.open,m.close,b):m.low=Math.min(m.open,m.close)}m.full_kline&&(u=m.close),l.value.updateData(m)}};function c(){if(e.symbolInfo.id)return o.value=!0,pi({symbol_id:e.symbolInfo.id,interval:t.value,symbol_type:e.isSpot?"spot":"futures"}).then(p=>{let m=Number.MIN_SAFE_INTEGER;p=p&&p.map(_=>(s.forEach(y=>{_[y]=Number(_[y])}),_.timestamp=+_.tl,_.open=+_.o,_.close=+_.c,_.high=+_.h,_.low=+_.l,_.volume=+_.v,m=Math.max(m,+_.c),_)),m<.009?l.value.setPrecision({price:8,volume:2}):l.value.setPrecision({price:4,volume:2}),p&&p.length>0&&(u=p[p.length-1].close),l.value.applyNewData(p)}).finally(()=>{o.value=!1})}Pe(()=>e.symbolInfo.symbol,(p,m)=>{m&&e.unsubscribeChannel(`public:kline_${m}`),p&&e.setSub(`public:kline_${p}`,h),p&&c()},{immediate:!0}),kr(()=>{v()});const v=()=>{const p=yo("k-line-chart",{decimalFold:{threshold:1e3},locale:"en-US",thousandsSeparator:e.useEuropeanFormat?{sign:".",format:m=>{const _=parseFloat(m);if(isNaN(_))return m;const y=_.toString().split(".");return y[0]=y[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),y.join(",")}}:void 0,formatter:e.useEuropeanFormat?{formatBigNumber:m=>{const _=parseFloat(m);if(isNaN(_))return m;const y=_.toString().split(".");return y[0]=y[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),y.join(",")}}:void 0});p.setStyles({candle:{type:"candle_solid",bar:{upColor:"#F92855",downColor:"#2DC08E",noChangeColor:"#888888",upBorderColor:"#F92855",downBorderColor:"#2DC08E",noChangeBorderColor:"#888888",upWickColor:"#F92855",downWickColor:"#2DC08E",noChangeWickColor:"#888888"}},grid:{show:!0,horizontal:{show:!0,size:1,color:"#333",style:"dashed",dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#333",style:"dashed",dashedValue:[2,2]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#000",size:1},tickText:{show:!0,color:"#D9D9D9",family:"Helvetica Neue",weight:"normal",size:12,marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#000"}},yAxis:{show:!0,size:"auto",reverse:!1,axisLine:{show:!0,color:"#000",size:1},tickText:{show:!0,color:"#D9D9D9",family:"PingFang SC",weight:"normal",size:12,marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#000"}},separator:{size:1,color:"#333",fill:!0,activeBackgroundColor:"rgba(230, 230, 230, .15)"},candle:{tooltip:{showType:"rect",showRule:"follow_cross"}},indicator:{tooltip:{showRule:"follow_cross"}}}),p.createIndicator({name:"VOL",styles:{"font-size":"12px",color:"red",lines:[{size:1,style:"solid",dashedValue:[2,2],color:"rgba(0, 0, 0, 0)"}]}},!0,{gap:{top:.02,bottom:.01}}),l.value=p,g(["MA","MACD"])},d=[],f=["MACD","OBV","RSI","KDJ"],g=p=>{p.forEach(m=>{d.includes(m)||(d.push(m),f.includes(m)?l.value.createIndicator(m,!1,{id:m}):l.value.createIndicator({name:m,styles:{"font-size":"12px",color:"red"}},!0,{id:"candle_pane",gap:{top:.02,bottom:.01}}))}),d.forEach(m=>{p.includes(m)||(l.value.removeIndicator({name:m}),d.splice(d.indexOf(m),1))}),l.value.resize()};return Pe(()=>e.useEuropeanFormat,p=>{l.value&&(Pr("k-line-chart"),Dr(()=>{v()}))}),Ti(()=>{Pr("k-line-chart")}),(p,m)=>{const _=fi,y=di;return $(),j("div",bo,[W("div",xo,[($(!0),j(Me,null,Ae(V(a),b=>($(),j("div",{class:Ut(["type-li",{active:b.id===V(t)}]),key:b.id,onClick:x=>r(b)},H(b.name),11,Co))),128))]),Qt(_,{style:{"flex-shrink":"0","margin-left":"0","padding-bottom":"16px",width:"100%","justify-content":"flex-start"},tabList:V(n),isMultiple:"",isSelect:"",isSmall:"",onTabChange:g,tabActive:["MA","MACD"]},null,8,["tabList"]),Pi(W("div",wo,null,512),[[y,V(o)]])])}}},ys=Qe(So,[["__scopeId","data-v-af50956a"]]),Mr="data:image/svg+xml,%3csvg%20width='16'%20height='9'%20viewBox='0%200%2016%209'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.73597%206.17366L8.6773%207.11499L14.3213%201.47099L15.264%202.41366L8.6773%209.00033L4.43464%204.75766L5.3773%203.81499L6.79397%205.23166L7.73597%206.17299V6.17366ZM7.7373%204.28833L11.0386%200.986328L11.9786%201.92633L8.6773%205.22833L7.7373%204.28833ZM5.85264%208.05833L4.91064%209.00033L0.667969%204.75766L1.61064%203.81499L2.55264%204.75699L2.55197%204.75766L5.85264%208.05833V8.05833Z'%20fill='%23A4A8AB'/%3e%3c/svg%3e",Io="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3853_2060)'%3e%3cpath%20d='M7.9987%201.33398C11.6787%201.33398%2014.6654%204.32065%2014.6654%208.00065C14.6654%2011.6807%2011.6787%2014.6673%207.9987%2014.6673C4.3187%2014.6673%201.33203%2011.6807%201.33203%208.00065C1.33203%204.32065%204.3187%201.33398%207.9987%201.33398ZM7.9987%2013.334C10.9454%2013.334%2013.332%2010.9473%2013.332%208.00065C13.332%205.05398%2010.9454%202.66732%207.9987%202.66732C5.05203%202.66732%202.66536%205.05398%202.66536%208.00065C2.66536%2010.9473%205.05203%2013.334%207.9987%2013.334ZM8.66536%208.00065V10.6673H7.33203V8.00065H5.33203L7.9987%205.33398L10.6654%208.00065H8.66536Z'%20fill='%23A4A8AB'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3853_2060'%3e%3crect%20width='16'%20height='16'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",Eo="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3853_2054)'%3e%3cpath%20d='M7.9987%201.33398C11.6787%201.33398%2014.6654%204.32065%2014.6654%208.00065C14.6654%2011.6807%2011.6787%2014.6673%207.9987%2014.6673C4.3187%2014.6673%201.33203%2011.6807%201.33203%208.00065C1.33203%204.32065%204.3187%201.33398%207.9987%201.33398ZM7.9987%2013.334C10.9454%2013.334%2013.332%2010.9473%2013.332%208.00065C13.332%205.05398%2010.9454%202.66732%207.9987%202.66732C5.05203%202.66732%202.66536%205.05398%202.66536%208.00065C2.66536%2010.9473%205.05203%2013.334%207.9987%2013.334ZM8.66536%208.00065H10.6654L7.9987%2010.6673L5.33203%208.00065H7.33203V5.33398H8.66536V8.00065Z'%20fill='%23A4A8AB'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3853_2054'%3e%3crect%20width='16'%20height='16'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",To={class:"top-header"},Po={class:"item-box flex items-center",style:{"margin-left":"0"}},Mo={class:"cur-currency"},Ao=["src"],ko={class:"dropList"},Do={class:"table-header"},Ro={class:"flex-auto"},Fo={style:{width:"140px","text-align":"right"}},Bo={style:{width:"140px","text-align":"right"}},Oo={class:"table-body"},Lo=["onClick"],Vo={class:"flex flex-auto"},No=["src"],Wo={class:"item-box"},zo={class:"item-box"},Xo={key:0,class:"sub-number fs-18 font-DIN"},Ho={class:"number color-grey fs-12 mt-1 flex items-center"},Yo={class:"item-box ml-70"},Go={class:"sub-number fs-18 font-DIN"},Uo={class:"number color-grey fs-12 mt-1 flex items-center"},Zo={class:"item-box"},$o={key:0,class:"sub-number fs-18 font-DIN"},jo={class:"number color-grey fs-12 mt-1 flex items-center"},qo={class:"item-box"},Ko={key:0,class:"sub-number fs-18 font-DIN"},Jo={class:"number color-grey fs-12 mt-1 flex items-center"},Qo={__name:"TopHeader",props:{isSpot:{type:Boolean,default:!1},setSub:{type:Function,default:()=>{}},unsubscribeChannel:{type:Function,default:()=>{}},symbolInfo:{type:Object,default:()=>{}}},emits:["changeData","changeCoin","getRecordMap"],setup(i,{emit:e}){const{t}=Mi(),r=Ai(),a=i,n=mt([]),o=async()=>{(a.isSpot?gi:mi)({page:0,page_size:999}).then(m=>{n.value=m.items||[]})},s=mt({}),l=p=>{s.value[p.data.symbol]=p.data,c("getRecordMap",s.value)};Dr(()=>{a.isSpot,a.setSub&&a.setSub("public:allticker",l)});function u(p,m){let _=s.value[p.symbol]||{};return p[m]=+_[m]||"-",+_[m]||"-"}const h=mt({}),c=e,v=p=>{h.value=p.data||{},c("changeData",h.value)};Pe(()=>a.symbolInfo.symbol,(p,m)=>{console.log("oldValue",m),m&&a.unsubscribeChannel(`public:ticker_${m}`),console.log("newValue",p),p&&a.setSub(`public:ticker_${p}`,v)},{immediate:!0});const d=mt(),f=p=>{var m;p.id!==a.symbolInfo.id&&(c("changeCoin",p),(m=d.value)==null||m.hide())};kr(()=>{o()});const g=()=>{r.go(-1)};return(p,m)=>{var b,x,C,w,E,I,P;const _=Di,y=Yi;return $(),j("div",To,[W("div",Po,[Qt(_,{class:"el-icon--right mr-4 cursor-pointer",size:"16",onClick:g},{default:te(()=>[Qt(V(ki))]),_:1}),Qt(y,{placement:"bottom",trigger:"click",ref_key:"popoverRef",ref:d},{reference:te(()=>[W("div",Mo,[i.symbolInfo.logo?($(),j("img",{key:0,src:V(cr)(i.symbolInfo.logo),class:"b-img-large"},null,8,Ao)):Wt("",!0),Nt(" "+H(i.symbolInfo.name)+" ",1),Qt(_,{class:"el-icon--right",size:"12"},{default:te(()=>[Qt(V(Ri))]),_:1})])]),default:te(()=>[W("div",ko,[W("div",Do,[W("div",Ro,H(V(t)("tradingCommon.text19")),1),W("div",Fo,H(V(t)("tradingCommon.text20")),1),W("div",Bo,H(V(t)("tradingCommon.text9")),1)]),W("div",Oo,[($(!0),j(Me,null,Ae(n.value,(T,D)=>($(),j("div",{class:"body-row",key:D,onClick:A=>f(T)},[W("div",Vo,[W("img",{src:V(cr)(T.logo),class:"b-img",alt:""},null,8,No),Nt(" "+H(T.name),1)]),W("div",{style:{width:"140px","text-align":"right"},class:Ut([u(T,"price_latest_change")>=0?"green-color":"red-color "])},H(V(rt)(u(T,"price"))),3),W("div",{style:{width:"140px","text-align":"right"},class:Ut([u(T,"price_change_percent")>0?"green-color":"red-color"])},H(V(rt)(u(T,"price_change_percent")))+"% ",3)],8,Lo))),128))])])]),_:1},512)]),W("div",Wo,[h.value.price?($(),j("div",{key:0,class:Ut(["number color-red fs-24 fs-bold font-DIN flex items-center",[h.value.price_latest_change>=0?"green-color":"red-color"]])},[Nt(H(V(rt)((b=h.value)==null?void 0:b.price))+" ",1),h.value.price_change_percent?($(),j("div",{key:0,class:Ut(["is-small ml-2",["sub-number","color-red",h.value.price_change_percent>0?"c-num-status":"c-num-status is-red"]])},H(((x=h.value)==null?void 0:x.price_change_percent)>0?`${V(rt)((C=h.value)==null?void 0:C.price_change_percent,!1)}`:V(rt)((w=h.value)==null?void 0:w.price_change_percent,!1))+"% ",3)):Wt("",!0)],2)):Wt("",!0)]),W("div",zo,[h.value.volume?($(),j("div",Xo,H(V(rt)((E=h.value)==null?void 0:E.volume)),1)):Wt("",!0),W("div",Ho,[m[0]||(m[0]=W("img",{src:Mr,alt:"",class:"mr-1"},null,-1)),Nt(" 24h "+H(V(t)("tradingCommon.text12")),1)])]),W("div",Yo,[W("div",Go,H(V(rt)(h.value.trade_volume)),1),W("div",Uo,[m[1]||(m[1]=W("img",{src:Mr,alt:"",class:"mr-1"},null,-1)),Nt(" 24h "+H(V(t)("tradingCommon.text13")),1)])]),W("div",Zo,[h.value.high_price_24h?($(),j("div",$o,H(V(rt)((I=h.value)==null?void 0:I.high_price_24h)),1)):Wt("",!0),W("div",jo,[m[2]||(m[2]=W("img",{src:Io,alt:"",class:"mr-1"},null,-1)),Nt(" 24h "+H(V(t)("tradingCommon.text10")),1)])]),W("div",qo,[h.value.low_price_24h?($(),j("div",Ko,H(V(rt)((P=h.value)==null?void 0:P.low_price_24h)),1)):Wt("",!0),W("div",Jo,[m[3]||(m[3]=W("img",{src:Eo,alt:"",class:"mr-1"},null,-1)),Nt(" 24h "+H(V(t)("tradingCommon.text11")),1)])])])}}},bs=Qe(Qo,[["__scopeId","data-v-d26085e2"]]),ts={class:"price-ul"},es={class:"flex-auto"},rs={class:"info-box info-box-top"},is={class:"info-title"},as={class:"info-title"},ns={class:"green-color"},os={class:"c-is-num"},ss={class:"red-color"},ls={class:"c-is-num"},us={__name:"RightTable",props:{setSub:{type:Function,required:!0},symbolInfo:{type:Object,default:()=>{}},unsubscribeChannel:{type:Function,required:!1},isSpots:{type:Boolean,default:!1},symbolData:{type:Object,default:()=>{}}},setup(i){const e=i,t=mt([]),r=mt([]);function a(s){const l=s.data;t.value=l.bids||[],r.value=l.asks||[]}Pe(()=>e.symbolInfo.symbol,(s,l)=>{e.setSub&&(l&&e.unsubscribeChannel(`public:book_${l}`),s&&e.setSub(`public:book_${s}`,a))},{immediate:!0});const n=Yt(()=>{var s,l;return(l=(s=e.symbolInfo)==null?void 0:s.base_asset)==null?void 0:l.toUpperCase()}),o=Yt(()=>{var s,l;return(l=(s=e.symbolInfo)==null?void 0:s.quote_asset)==null?void 0:l.toUpperCase()});return(s,l)=>($(),j("div",ts,[W("div",es,[W("div",rs,[W("span",is,H(s.$t("tradingCommon.table.colum6.field1"))+"("+H(V(o))+")",1),W("span",as,H(s.$t("tradingCommon.table.colum6.field2"))+"("+H(V(n))+")",1)]),($(!0),j(Me,null,Ae(t.value,(u,h)=>($(),j("div",{class:"info-box",key:h},[W("span",ns,H(V(rt)(u[0])),1),W("span",os,H(V(rt)(u[1])),1)]))),128)),W("div",{class:Ut(["now-price",{"red-color":V(rt)(+i.symbolData.price_latest_change)<0}])},H(V(rt)(i.symbolData.price)||0),3),($(!0),j(Me,null,Ae(r.value,(u,h)=>($(),j("div",{class:"info-box",key:h},[W("span",ss,H(V(rt)(u[0])),1),W("span",ls,H(V(rt)(u[1])),1)]))),128))])]))}},xs=Qe(us,[["__scopeId","data-v-d58831b9"]]);export{ys as C,xs as R,bs as T};
